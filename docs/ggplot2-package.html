<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.4 ggplot2 | 통계 프로그래밍 언어</title>
  <meta name="description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="5.4 ggplot2 | 통계 프로그래밍 언어" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="github-repo" content="zorba78/cnu-r-programming-lecture-note" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.4 ggplot2 | 통계 프로그래밍 언어" />
  
  <meta name="twitter:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  

<meta name="author" content="한국한의학연구원, 구본초" />


<meta name="date" content="2020-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="low-level-graphic.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">통계 프로그래밍 언어</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Overview</a></li>
<li class="part"><span><b>I Get Started</b></span></li>
<li class="chapter" data-level="1" data-path="intro-chap.html"><a href="intro-chap.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1.1</b> R 설치하기</a></li>
<li class="chapter" data-level="1.2" data-path="r-check.html"><a href="r-check.html"><i class="fa fa-check"></i><b>1.2</b> R 시작 및 작동 체크</a></li>
<li class="chapter" data-level="1.3" data-path="rconsle-script.html"><a href="rconsle-script.html"><i class="fa fa-check"></i><b>1.3</b> R script 편집기 사용</a></li>
<li class="chapter" data-level="1.4" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>1.4</b> RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-studio.html"><a href="r-studio.html#rstudio-install"><i class="fa fa-check"></i><b>1.4.1</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-studio.html"><a href="r-studio.html#rstudio-component"><i class="fa fa-check"></i><b>1.4.2</b> RStudio IDE 화면 구성</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-studio.html"><a href="r-studio.html#rstudio-glob-options"><i class="fa fa-check"></i><b>1.4.3</b> RStudio 환경 설정</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-studio.html"><a href="r-studio.html#rstudio-project"><i class="fa fa-check"></i><b>1.4.4</b> RStudio 프로젝트</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>1.5</b> R 패키지</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-package.html"><a href="r-package.html#r-package-path"><i class="fa fa-check"></i><b>1.5.1</b> R 패키지 경로 확인 및 변경</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-package.html"><a href="r-package.html#r-package-install"><i class="fa fa-check"></i><b>1.5.2</b> R 패키지 설치하기</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-package.html"><a href="r-package.html#r-package-load"><i class="fa fa-check"></i><b>1.5.3</b> R 패키지 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-basic.html"><a href="r-basic.html"><i class="fa fa-check"></i><b>1.6</b> R 기초 문법</a></li>
<li class="chapter" data-level="1.7" data-path="r-markdown-get-start.html"><a href="r-markdown-get-start.html"><i class="fa fa-check"></i><b>1.7</b> R Markdown (맛보기)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-type.html"><a href="data-type.html"><i class="fa fa-check"></i><b>2</b> R 객체(R object)</a><ul>
<li class="chapter" data-level="2.1" data-path="scalar.html"><a href="scalar.html"><i class="fa fa-check"></i><b>2.1</b> 스칼라(scalar)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="scalar.html"><a href="scalar.html#definition"><i class="fa fa-check"></i><b>2.1.1</b> 선언</a></li>
<li class="chapter" data-level="2.1.2" data-path="scalar.html"><a href="scalar.html#numeric"><i class="fa fa-check"></i><b>2.1.2</b> 숫자형</a></li>
<li class="chapter" data-level="2.1.3" data-path="scalar.html"><a href="scalar.html#character"><i class="fa fa-check"></i><b>2.1.3</b> 문자형</a></li>
<li class="chapter" data-level="2.1.4" data-path="scalar.html"><a href="scalar.html#logical"><i class="fa fa-check"></i><b>2.1.4</b> 논리형 스칼라</a></li>
<li class="chapter" data-level="2.1.5" data-path="scalar.html"><a href="scalar.html#missing-value"><i class="fa fa-check"></i><b>2.1.5</b> 결측값(missing value)</a></li>
<li class="chapter" data-level="2.1.6" data-path="scalar.html"><a href="scalar.html#null"><i class="fa fa-check"></i><b>2.1.6</b> NULL 값</a></li>
<li class="chapter" data-level="2.1.7" data-path="scalar.html"><a href="scalar.html#finite"><i class="fa fa-check"></i><b>2.1.7</b> 무한대/무한소/숫자아님</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>2.2</b> 벡터(vector)</a><ul>
<li class="chapter" data-level="2.2.1" data-path="vector.html"><a href="vector.html#vector-prop"><i class="fa fa-check"></i><b>2.2.1</b> 벡터의 특징</a></li>
<li class="chapter" data-level="2.2.2" data-path="vector.html"><a href="vector.html#vector-operation"><i class="fa fa-check"></i><b>2.2.2</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.2.3" data-path="vector.html"><a href="vector.html#vector-index"><i class="fa fa-check"></i><b>2.2.3</b> 벡터의 색인(indexing)</a></li>
<li class="chapter" data-level="2.2.4" data-path="vector.html"><a href="vector.html#vector-function"><i class="fa fa-check"></i><b>2.2.4</b> 벡터 관련 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>2.3</b> 리스트(list)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="list.html"><a href="list.html#make-list"><i class="fa fa-check"></i><b>2.3.1</b> 리스트 생성</a></li>
<li class="chapter" data-level="2.3.2" data-path="list.html"><a href="list.html#list-index"><i class="fa fa-check"></i><b>2.3.2</b> 리스트 색인</a></li>
<li class="chapter" data-level="2.3.3" data-path="list.html"><a href="list.html#list-add-delete"><i class="fa fa-check"></i><b>2.3.3</b> 리스트에 원소 추가/제거</a></li>
<li class="chapter" data-level="2.3.4" data-path="list.html"><a href="list.html#list-combine"><i class="fa fa-check"></i><b>2.3.4</b> 리스트의 결합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="matrix.html"><a href="matrix.html"><i class="fa fa-check"></i><b>2.4</b> 행렬(matrix)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="matrix.html"><a href="matrix.html#matrix-operation"><i class="fa fa-check"></i><b>2.4.1</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.4.2" data-path="matrix.html"><a href="matrix.html#mat-index"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 색인</a></li>
<li class="chapter" data-level="2.4.3" data-path="matrix.html"><a href="matrix.html#행과-열-추가-및-제거"><i class="fa fa-check"></i><b>2.4.3</b> 행과 열 추가 및 제거</a></li>
<li class="chapter" data-level="2.4.4" data-path="matrix.html"><a href="matrix.html#행렬-관련-함수"><i class="fa fa-check"></i><b>2.4.4</b> 행렬 관련 함수</a></li>
<li class="chapter" data-level="2.4.5" data-path="matrix.html"><a href="matrix.html#vec-mat-diff"><i class="fa fa-check"></i><b>2.4.5</b> 벡터와 행렬의 차이점</a></li>
<li class="chapter" data-level="2.4.6" data-path="matrix.html"><a href="matrix.html#mat-dim-reduc-sway"><i class="fa fa-check"></i><b>2.4.6</b> 의도치 않은 차원축소 피하기</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="array.html"><a href="array.html"><i class="fa fa-check"></i><b>2.5</b> 배열(array)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="array.html"><a href="array.html#make-array"><i class="fa fa-check"></i><b>2.5.1</b> 배열의 생성 및 색인</a></li>
<li class="chapter" data-level="2.5.2" data-path="array.html"><a href="array.html#rray-extend-example"><i class="fa fa-check"></i><b>2.5.2</b> 배열의 확장 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="factor-table.html"><a href="factor-table.html"><i class="fa fa-check"></i><b>2.6</b> 요인(factor)과 테이블(table)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="factor-table.html"><a href="factor-table.html#factor"><i class="fa fa-check"></i><b>2.6.1</b> 요인(factor)</a></li>
<li class="chapter" data-level="2.6.2" data-path="factor-table.html"><a href="factor-table.html#table"><i class="fa fa-check"></i><b>2.6.2</b> 테이블(table)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-frame.html"><a href="data-frame.html"><i class="fa fa-check"></i><b>2.7</b> 데이터 프레임(data frame)</a><ul>
<li class="chapter" data-level="2.7.1" data-path="data-frame.html"><a href="data-frame.html#create-data-frame"><i class="fa fa-check"></i><b>2.7.1</b> 데이터 프레임 생성</a></li>
<li class="chapter" data-level="2.7.2" data-path="data-frame.html"><a href="data-frame.html#data-frame-get"><i class="fa fa-check"></i><b>2.7.2</b> 데이터 프레임 접근 및 필터링</a></li>
<li class="chapter" data-level="2.7.3" data-path="data-frame.html"><a href="data-frame.html#data-frame-function"><i class="fa fa-check"></i><b>2.7.3</b> 데이터 프레임 관련 함수</a></li>
<li class="chapter" data-level="2.7.4" data-path="data-frame.html"><a href="data-frame.html#apply-related-fun"><i class="fa fa-check"></i><b>2.7.4</b> <code>*apply()</code> 계열 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="is-as-function.html"><a href="is-as-function.html"><i class="fa fa-check"></i><b>2.8</b> 객체의 유형 판별 및 변환</a></li>
<li class="chapter" data-level="2.9" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i><b>2.9</b> Homework #2</a></li>
<li class="chapter" data-level="2.10" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i><b>2.10</b> Homework #3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="string-regexp.html"><a href="string-regexp.html"><i class="fa fa-check"></i><b>3</b> 문자열 처리와 정규표현식</a><ul>
<li class="chapter" data-level="3.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html"><i class="fa fa-check"></i><b>3.1</b> 유용한 문자열 관련 함수</a><ul>
<li class="chapter" data-level="3.1.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#nchar"><i class="fa fa-check"></i><b>3.1.1</b> <strong><code>nchar()</code></strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#paste"><i class="fa fa-check"></i><b>3.1.2</b> <strong><code>paste()</code></strong>, <strong><code>paste0()</code></strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#sprintf"><i class="fa fa-check"></i><b>3.1.3</b> <strong><code>sprintf()</code></strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#substr"><i class="fa fa-check"></i><b>3.1.4</b> <strong><code>substr()</code></strong></a></li>
<li class="chapter" data-level="3.1.5" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#low-up-fun"><i class="fa fa-check"></i><b>3.1.5</b> <strong><code>tolower()</code>, <code>toupper()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html"><i class="fa fa-check"></i><b>3.2</b> 정규표현식 기본 함수</a><ul>
<li class="chapter" data-level="3.2.1" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#grep-grepl"><i class="fa fa-check"></i><b>3.2.1</b> <strong><code>grep()</code>, <code>grepl()</code></strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexpr-gregexpr"><i class="fa fa-check"></i><b>3.2.2</b> <strong><code>regexpr()</code></strong>, <strong><code>gregexpr()</code></strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#sub-gsub-fun"><i class="fa fa-check"></i><b>3.2.3</b> <strong><code>sub()</code></strong>, <strong><code>gsub()</code></strong></a></li>
<li class="chapter" data-level="3.2.4" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexec-fun"><i class="fa fa-check"></i><b>3.2.4</b> <strong><code>regexec()</code></strong></a></li>
<li class="chapter" data-level="3.2.5" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#strsplit"><i class="fa fa-check"></i><b>3.2.5</b> <strong><code>strsplit()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reg-exp.html"><a href="reg-exp.html"><i class="fa fa-check"></i><b>3.3</b> 정규 표현식(regular expression)</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reg-exp.html"><a href="reg-exp.html#basic-meta"><i class="fa fa-check"></i><b>3.3.1</b> 기본 메타 문자</a></li>
<li class="chapter" data-level="3.3.2" data-path="reg-exp.html"><a href="reg-exp.html#character-set"><i class="fa fa-check"></i><b>3.3.2</b> 문자 집합</a></li>
<li class="chapter" data-level="3.3.3" data-path="reg-exp.html"><a href="reg-exp.html#character-class"><i class="fa fa-check"></i><b>3.3.3</b> 문자 클래스</a></li>
<li class="chapter" data-level="3.3.4" data-path="reg-exp.html"><a href="reg-exp.html#regexp-ex"><i class="fa fa-check"></i><b>3.3.4</b> 정규 표현식 예시</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>4</b> 데이터 핸들링(Data handling)</a><ul>
<li class="chapter" data-level="4.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html#data-import-export"><i class="fa fa-check"></i><b>4.1.1</b> 외부데이터 불러오기 및 저장</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4.2</b> Tidyverse</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4.3</b> <code>readr</code> 패키지</a><ul>
<li class="chapter" data-level="4.3.1" data-path="readr.html"><a href="readr.html#import-export-excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel 파일 입출력</a></li>
<li class="chapter" data-level="4.3.2" data-path="readr.html"><a href="readr.html#tibble"><i class="fa fa-check"></i><b>4.3.2</b> tibble 패키지</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4.4</b> <code>dplyr</code> 패키지</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dplyr.html"><a href="dplyr.html#pipe-op"><i class="fa fa-check"></i><b>4.4.1</b> 파이프 연산자: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-filter"><i class="fa fa-check"></i><b>4.4.2</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>4.4.3</b> <code id="dplyr-arrange">arrange()</code></a></li>
<li class="chapter" data-level="4.4.4" data-path="dplyr.html"><a href="dplyr.html#dplyr-select"><i class="fa fa-check"></i><b>4.4.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.4.5" data-path="dplyr.html"><a href="dplyr.html#dplyr-mutate"><i class="fa fa-check"></i><b>4.4.5</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="dplyr.html"><a href="dplyr.html#dplyr-transmute"><i class="fa fa-check"></i><b>4.4.6</b> <code>transmute()</code></a></li>
<li class="chapter" data-level="4.4.7" data-path="dplyr.html"><a href="dplyr.html#dplyr-summarise"><i class="fa fa-check"></i><b>4.4.7</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="4.4.8" data-path="dplyr.html"><a href="dplyr.html#dplyr-group_by"><i class="fa fa-check"></i><b>4.4.8</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="4.4.9" data-path="dplyr.html"><a href="dplyr.html#dplyr-application"><i class="fa fa-check"></i><b>4.4.9</b> dplyr 관련 유용한 함수</a></li>
<li class="chapter" data-level="4.4.10" data-path="dplyr.html"><a href="dplyr.html#dplyr-verb-variant-adverb"><i class="fa fa-check"></i><b>4.4.10</b> 부가 기능</a></li>
<li class="chapter" data-level="4.4.11" data-path="dplyr.html"><a href="dplyr.html#dplyr-join"><i class="fa fa-check"></i><b>4.4.11</b> 데이터 연결</a></li>
<li class="chapter" data-level="4.4.12" data-path="dplyr.html"><a href="dplyr.html#ex-gapminder"><i class="fa fa-check"></i><b>4.4.12</b> 확장 예제: Gapminder</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4.5</b> 데이터 변환</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-transformation.html"><a href="data-transformation.html#tidy-data"><i class="fa fa-check"></i><b>4.5.1</b> Tidy data</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-transformation.html"><a href="data-transformation.html#long-format"><i class="fa fa-check"></i><b>4.5.2</b> Long format</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-transformation.html"><a href="data-transformation.html#wider-format"><i class="fa fa-check"></i><b>4.5.3</b> Wide format</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-transformation.html"><a href="data-transformation.html#separate-unite"><i class="fa fa-check"></i><b>4.5.4</b> Separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="homework-04.html"><a href="homework-04.html"><i class="fa fa-check"></i><b>4.6</b> Homework #4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-data-visualization.html"><a href="ch-data-visualization.html"><i class="fa fa-check"></i><b>5</b> 데이터 시각화</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basic-graphics.html"><a href="r-basic-graphics.html"><i class="fa fa-check"></i><b>5.1</b> R 기본 그래프 함수</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-graph.html"><a href="high-level-graph.html"><i class="fa fa-check"></i><b>5.2</b> 고수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.2.1" data-path="high-level-graph.html"><a href="high-level-graph.html#plot-fun"><i class="fa fa-check"></i><b>5.2.1</b> <strong><code>plot()</code> 함수</strong></a></li>
<li class="chapter" data-level="5.2.2" data-path="high-level-graph.html"><a href="high-level-graph.html#main-high-level-graph"><i class="fa fa-check"></i><b>5.2.2</b> 주요 고수준 그래픽 함수</a></li>
<li class="chapter" data-level="5.2.3" data-path="high-level-graph.html"><a href="high-level-graph.html#scatter-plot"><i class="fa fa-check"></i><b>5.2.3</b> 산점도</a></li>
<li class="chapter" data-level="5.2.4" data-path="high-level-graph.html"><a href="high-level-graph.html#mat-plot"><i class="fa fa-check"></i><b>5.2.4</b> 행렬 그래프</a></li>
<li class="chapter" data-level="5.2.5" data-path="high-level-graph.html"><a href="high-level-graph.html#histogram"><i class="fa fa-check"></i><b>5.2.5</b> 히스토그램</a></li>
<li class="chapter" data-level="5.2.6" data-path="high-level-graph.html"><a href="high-level-graph.html#bar-plot"><i class="fa fa-check"></i><b>5.2.6</b> 막대 그래프</a></li>
<li class="chapter" data-level="5.2.7" data-path="high-level-graph.html"><a href="high-level-graph.html#boxplot"><i class="fa fa-check"></i><b>5.2.7</b> 상자 그림</a></li>
<li class="chapter" data-level="5.2.8" data-path="high-level-graph.html"><a href="high-level-graph.html#violin-plot"><i class="fa fa-check"></i><b>5.2.8</b> 바이올린 도표</a></li>
<li class="chapter" data-level="5.2.9" data-path="high-level-graph.html"><a href="high-level-graph.html#mosaicplot"><i class="fa fa-check"></i><b>5.2.9</b> 모자이크 도표</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html"><i class="fa fa-check"></i><b>5.3</b> 저수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.3.1" data-path="low-level-graphic.html"><a href="low-level-graphic.html#par"><i class="fa fa-check"></i><b>5.3.1</b> par()</a></li>
<li class="chapter" data-level="5.3.2" data-path="low-level-graphic.html"><a href="low-level-graphic.html#points"><i class="fa fa-check"></i><b>5.3.2</b> points()</a></li>
<li class="chapter" data-level="5.3.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html#lines"><i class="fa fa-check"></i><b>5.3.3</b> lines()</a></li>
<li class="chapter" data-level="5.3.4" data-path="low-level-graphic.html"><a href="low-level-graphic.html#ablines"><i class="fa fa-check"></i><b>5.3.4</b> ablines()</a></li>
<li class="chapter" data-level="5.3.5" data-path="low-level-graphic.html"><a href="low-level-graphic.html#arrows"><i class="fa fa-check"></i><b>5.3.5</b> arrows()</a></li>
<li class="chapter" data-level="5.3.6" data-path="low-level-graphic.html"><a href="low-level-graphic.html#rect"><i class="fa fa-check"></i><b>5.3.6</b> rect()</a></li>
<li class="chapter" data-level="5.3.7" data-path="low-level-graphic.html"><a href="low-level-graphic.html#polygon"><i class="fa fa-check"></i><b>5.3.7</b> polygon()</a></li>
<li class="chapter" data-level="5.3.8" data-path="low-level-graphic.html"><a href="low-level-graphic.html#text"><i class="fa fa-check"></i><b>5.3.8</b> text(), mtext()</a></li>
<li class="chapter" data-level="5.3.9" data-path="low-level-graphic.html"><a href="low-level-graphic.html#legend"><i class="fa fa-check"></i><b>5.3.9</b> legend()</a></li>
<li class="chapter" data-level="5.3.10" data-path="low-level-graphic.html"><a href="low-level-graphic.html#math-expression"><i class="fa fa-check"></i><b>5.3.10</b> 수식 표현</a></li>
<li class="chapter" data-level="5.3.11" data-path="low-level-graphic.html"><a href="low-level-graphic.html#r-기본-그래프-이미지-파일로-저장"><i class="fa fa-check"></i><b>5.3.11</b> R 기본 그래프 이미지 파일로 저장</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>5.4</b> ggplot2</a><ul>
<li class="chapter" data-level="5.4.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#basic-grammar"><i class="fa fa-check"></i><b>5.4.1</b> 기본 문법</a></li>
<li class="chapter" data-level="5.4.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-lines"><i class="fa fa-check"></i><b>5.4.2</b> Geoms: 선 관련 geometric</a></li>
<li class="chapter" data-level="5.4.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-points"><i class="fa fa-check"></i><b>5.4.3</b> Geoms: 점 geometrics</a></li>
<li class="chapter" data-level="5.4.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-bars"><i class="fa fa-check"></i><b>5.4.4</b> Geoms: 막대 geometrics</a></li>
<li class="chapter" data-level="5.4.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-intervals"><i class="fa fa-check"></i><b>5.4.5</b> Geom: 수직 범위선 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-texts"><i class="fa fa-check"></i><b>5.4.6</b> Geoms: 텍스트 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-areas"><i class="fa fa-check"></i><b>5.4.7</b> Geoms: 면적 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-statistics"><i class="fa fa-check"></i><b>5.4.8</b> Geoms: 통계 그래프 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-x-y"><i class="fa fa-check"></i><b>5.4.9</b> Scales: x-y 축 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-colors-fill"><i class="fa fa-check"></i><b>5.4.10</b> Scales: 색상 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-size-line-shape"><i class="fa fa-check"></i><b>5.4.11</b> Scales: 크기, 선 종류, 점 모양 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.12" data-path="ggplot2-package.html"><a href="ggplot2-package.html#coordinate-systems"><i class="fa fa-check"></i><b>5.4.12</b> Coordinate systems</a></li>
<li class="chapter" data-level="5.4.13" data-path="ggplot2-package.html"><a href="ggplot2-package.html#guides-x-y-축-및-그래프-제목-관련"><i class="fa fa-check"></i><b>5.4.13</b> Guides: x-y 축 및 그래프 제목 관련</a></li>
<li class="chapter" data-level="5.4.14" data-path="ggplot2-package.html"><a href="ggplot2-package.html#facets-국소-시각화-기법"><i class="fa fa-check"></i><b>5.4.14</b> Facets: 국소 시각화 기법</a></li>
<li class="chapter" data-level="5.4.15" data-path="ggplot2-package.html"><a href="ggplot2-package.html#themes"><i class="fa fa-check"></i><b>5.4.15</b> Themes</a></li>
<li class="chapter" data-level="5.4.16" data-path="ggplot2-package.html"><a href="ggplot2-package.html#ggplot-application"><i class="fa fa-check"></i><b>5.4.16</b> 확장 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">통계 프로그래밍 언어</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2-package" class="section level2">
<h2><span class="header-section-number">5.4</span> ggplot2</h2>


<div class="rmdwarning">
<strong>Prerequisites</strong>: tidyverse 패키지 또는 ggplot2 패키지 읽어오기: <code>require(tidyverse)</code> 또는 <code>require(ggplot2)</code> 실행
</div>


<ul>
<li>데이터에 대한 그래프는 데이터의 속성(수치형, 범주형)과 시각적 속성(점, x-y 좌표 위치, 선, 색상, 막대의 높이) 간에 대응 또는 매핑(mapping) 으로 이루어짐</li>
<li>R 에서 가장 유명한 데이터 시각화 패키지 중 하나로 2005년 Hadley Wickham이 개발 및 배포</li>
<li>Leland Wilkinson 의 <strong>grammar of graphics</strong> <span class="citation">(Wilkinson <a href="#ref-wilkinson2012grammar" role="doc-biblioref">2012</a>)</span> 를 구현</li>
</ul>


<div class="rmdnote">
<strong>Grammar of graphics</strong>: 그래프를 구현하기 위한 일관적인 체계로 그래프를 데이터, 스케일, 레이어, 좌표 등과 같은 의미론적 요소(sementic components) 로 나눔
</div>


<ul>
<li>ggplot의 grammar of graphics</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-59"></span>
<img src="figures/grammar-graphics-intro.png" alt="ggplot의 grammar of graphics 주요 구성 요소" width="90%" />
<p class="caption">
Figure 5.19: ggplot의 grammar of graphics 주요 구성 요소
</p>
</div>

<ul>
<li>R 기본 graphics 패키지의 경우 데이터 속성을 시각적 속성으로 매핑 시 매 경우가 고유한 작업이고, 매핑이 변경될 경우 데이터를 재구성하거나 완전히 다른 plotting 함수를 적용해야 함.</li>
<li>R base graphics와 ggplot의 비교</li>
</ul>

<div class="sourceCode" id="cb1586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1586-1" title="1"><span class="co"># R 기본 데이터셋: ToothGrowth</span></a>
<a class="sourceLine" id="cb1586-2" title="2">ToothGrowth <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1586-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(supp, dose) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1586-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(len)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1586-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dose =</span> <span class="kw">factor</span>(dose, </a>
<a class="sourceLine" id="cb1586-6" title="6">                       <span class="dt">ordered =</span> <span class="ot">TRUE</span>))-&gt;<span class="st"> </span>tg_long</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;supp&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb1588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1588-1" title="1">tg_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1588-2" title="2"><span class="st">  </span><span class="kw">spread</span>(supp, mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1588-3" title="3"><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="st">&quot;dose&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 열 값을 열이름으로 변환(in tibble 패키지)</span></a>
<a class="sourceLine" id="cb1588-4" title="4"><span class="st">  </span>as.matrix -&gt;<span class="st"> </span>tg_mat</a>
<a class="sourceLine" id="cb1588-5" title="5"></a>
<a class="sourceLine" id="cb1588-6" title="6"><span class="co"># R graphics: barplot() 사용</span></a>
<a class="sourceLine" id="cb1588-7" title="7"><span class="kw">barplot</span>(tg_mat, <span class="dt">beside =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure"><span id="fig:base-barplot-a"></span>
<img src="05-data-visualization_files/figure-html/base-barplot-a-1.svg" alt="R 기본 barplot() 생성 그래프" width="672" />
<p class="caption">
Figure 5.20: R 기본 barplot() 생성 그래프
</p>
</div>

<ul>
<li><code>dose</code> 별 OJ와 VC 막대도표: <code>dose</code>로 그룹화를 하기 위해 데이터 구조 변경(전치) 필요</li>
</ul>

<div class="sourceCode" id="cb1589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1589-1" title="1"><span class="co"># tg_mat 행렬 전치</span></a>
<a class="sourceLine" id="cb1589-2" title="2"><span class="kw">barplot</span>(<span class="kw">t</span>(tg_mat), <span class="dt">beside =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure"><span id="fig:base-barplot-b"></span>
<img src="05-data-visualization_files/figure-html/base-barplot-b-1.svg" alt="R 기본 barplot() 생성 그래프: 데이터 전치" width="672" />
<p class="caption">
Figure 5.21: R 기본 barplot() 생성 그래프: 데이터 전치
</p>
</div>

<ul>
<li>막대 대신 선(line)으로 표현</li>
</ul>

<div class="sourceCode" id="cb1590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1590-1" title="1"><span class="kw">plot</span>(tg_mat[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb1590-2" title="2"><span class="kw">lines</span>(tg_mat[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:base-lineplot"></span>
<img src="05-data-visualization_files/figure-html/base-lineplot-1.svg" alt="R 기본 선 그래프: plot(), lines() 함수 사용" width="672" />
<p class="caption">
Figure 5.22: R 기본 선 그래프: plot(), lines() 함수 사용
</p>
</div>

<ul>
<li><code>plot()</code> 함수 호출 시 y 축 범위가 첫 번째 선에 대해서만 설정</li>
<li>x 축이 범주 대신 번호가 사용</li>
<li>ggplot 사용: 데이터 프레임에만 적용 가능(데이터 구조는 long-format)</li>
</ul>

<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1591-1" title="1"><span class="co"># require(ggplot2)</span></a>
<a class="sourceLine" id="cb1591-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> tg_long, </a>
<a class="sourceLine" id="cb1591-3" title="3">       <span class="kw">aes</span>(<span class="dt">y =</span> mean)) -&gt;<span class="st"> </span>gmap <span class="co"># 기본 mapping 유지를 위해 </span></a>
<a class="sourceLine" id="cb1591-4" title="4">                              <span class="co"># ggplot 클래스 객체 저장</span></a>
<a class="sourceLine" id="cb1591-5" title="5">gmap <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1591-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> supp, <span class="dt">fill =</span> dose), </a>
<a class="sourceLine" id="cb1591-7" title="7">           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="co"># 데이터 고유값을 막대 높이로 사용</span></a>
<a class="sourceLine" id="cb1591-8" title="8">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="co"># 막대 위치 조정(beside 조건과 유사)</span></a></code></pre></div>
<div class="figure"><span id="fig:ggplot-bar-intro-a"></span>
<img src="05-data-visualization_files/figure-html/ggplot-bar-intro-a-1.svg" alt="ggplot()과 geom_bar()을 이용한 막대 도표" width="672" />
<p class="caption">
Figure 5.23: ggplot()과 geom_bar()을 이용한 막대 도표
</p>
</div>

<ul>
<li>데이터 구조를 변경하지 않고 ggplot의 매핑 변수 변경</li>
</ul>

<div class="sourceCode" id="cb1592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1592-1" title="1">gmap <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1592-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dose, <span class="dt">fill =</span> supp), </a>
<a class="sourceLine" id="cb1592-3" title="3">           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, </a>
<a class="sourceLine" id="cb1592-4" title="4">           <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:ggplot-bar-intro-b"></span>
<img src="05-data-visualization_files/figure-html/ggplot-bar-intro-b-1.svg" alt="x와 fill의 mapping 변경" width="672" />
<p class="caption">
Figure 5.24: x와 fill의 mapping 변경
</p>
</div>

<ul>
<li>ggplot을 이용한 선 도표 생성</li>
</ul>

<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1593-1" title="1">gmap <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1593-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dose, </a>
<a class="sourceLine" id="cb1593-3" title="3">                <span class="dt">group =</span> supp, </a>
<a class="sourceLine" id="cb1593-4" title="4">                <span class="dt">color =</span> supp), </a>
<a class="sourceLine" id="cb1593-5" title="5">            <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure"><span id="fig:ggplot-line-intro"></span>
<img src="05-data-visualization_files/figure-html/ggplot-line-intro-1.svg" alt="geom_line()을 이용한 선 그래프 생성" width="672" />
<p class="caption">
Figure 5.25: geom_line()을 이용한 선 그래프 생성
</p>
</div>

<blockquote>
<ul>
<li>기본 그래프 함수를 이용해 막대도표 대신 선 도표 생성 시 완전히 다른 명령 사용</li>
<li>선 그래프 생성 시 기본 그래프는 하나씩 도표를 추가한 반면, geom_line()의 경우 모든 선이 한번에 그려짐</li>
</ul>
</blockquote>
<div id="basic-grammar" class="section level3">
<h3><span class="header-section-number">5.4.1</span> 기본 문법</h3>

<div class="sourceCode" id="cb1594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1594-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-2" title="2"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-3" title="3"><span class="st">  </span><span class="er">&lt;</span>SCALE_FUNCTION<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-4" title="4"><span class="st">  </span><span class="er">&lt;</span>LABEL or GUIDES<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-5" title="5"><span class="st">  </span><span class="er">&lt;</span>ANNOTATION<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-6" title="6"><span class="st">  </span><span class="er">&lt;</span>THEME<span class="op">&gt;</span></a></code></pre></div>

<p><strong>용어(terminology)</strong></p>
<ul>
<li><em><strong>data</strong></em>: 시각화의 대상으로 관측값과 변수(열)로 이루어짐</li>
<li><em><strong>geom</strong></em>: 데이터의 값을 시각적으로 보여주기 위한 레이어로 막대, 선, 점과 같은 기하학적 객체</li>
<li><em><strong>aesthetic</strong></em>: geom의 시각적 속성을 정의하며, x, y 위치, 선 색상, 점 모양 등을 정의</li>
<li><em><strong>mapping</strong></em>: 데이터 값을 asthetic에 매핑</li>
<li><em><strong>scale</strong></em>: asthetic에 매핑 시 세부 값들을 제어</li>
<li><em><strong>guide</strong></em>: 그래프 해석에 도움을 주는 속성으로 x-y 축의 눈금, 레이블, 범례(legend)를 포함</li>
<li><em><strong>annotation</strong></em>: 생성한 그래프 위에 추가적인 정보(선, 화살표, 텍스트, 도형 등) 추가</li>
<li><em><strong>theme</strong></em>: 그래프의 비데이터적 요소(제목, 레이블, 글꼴, 배경색, 격자, 범례 등) 제어를 통해 그래프의 미적 효과 극대화</li>
</ul>


<div class="rmdnote">
<p>ggplot 계열 함수에서 범주형 변수(categorical variable)은 이산형(<strong>discrete</strong>), 수치형 변수(numeric variable)을 연속형(<strong>continuous</strong>)이라고 명칭함.</p>
</div>


<p>ggplot 그래프 생성 기본 단계(각 단계(layer)는 <code>+</code> 연산자로 덧붙혀짐)</p>
<ol style="list-style-type: decimal">
<li><code>ggplot()</code>으로 ggplot 객체 초기화</li>
<li><code>aes()</code> 함수로 x-y 축 지정</li>
<li>geom 계열 함수로 데이터를 시각적 요소로 매핑. 이때 aes() 함수와 같이 색상, 크기 등 지정</li>
<li>scale 계열 함수를 이용해 asthetic의 세부 값을 조정</li>
<li>축 제목, 레이블, 범례 설정 조정</li>
<li>필요 시 theme 조정을 통해 시각적 요소 가미</li>
</ol>
<ul>
<li><code>ggplot()</code>: ggplot 객체를 생성하는 함수로 시각화할 데이터가 무엇인지, 그리고 데이터에 포함된 변수들이 어떤 asthetic에 매핑되는지를 선언</li>
<li><code>aes()</code>: 데이터 내 변수들이 어떤 geoms 레이어에서 어떤 시각적 속성을 갖는지를 지정해주는 함수로 ggplot() 함수 내, 혹은 독립적인 레이어로 추가 가능
<ul>
<li>ggplot에서 지정한 데이터 내에서 평가되기 때문에 변수명 지정 시 원래 데이터셋 참조할 필요 없음(예: <code>ggplot(data = car, aes(x = speed))</code>)</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1595"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1595-1" title="1"><span class="co"># ggplot()을 이용한 ggplot 생성</span></a>
<a class="sourceLine" id="cb1595-2" title="2"><span class="co"># 표현식 1</span></a>
<a class="sourceLine" id="cb1595-3" title="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>, <span class="co"># 데이터 프레임, 티블 객체</span></a>
<a class="sourceLine" id="cb1595-4" title="4">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">&lt;</span>X<span class="op">-</span>axis<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb1595-5" title="5">                     <span class="dt">y =</span> <span class="op">&lt;</span>Y<span class="op">-</span>axis<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb1595-6" title="6">                     <span class="dt">color =</span> <span class="op">&lt;</span>색 속성을 부여할 변수 이름<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb1595-7" title="7">                     <span class="dt">fill =</span> <span class="op">&lt;</span>면의 색 속성을 부여할 변수 이름<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb1595-8" title="8">                     <span class="dt">group =</span> <span class="op">&lt;</span>group 변수 지정<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1595-9" title="9"><span class="st">                             </span><span class="co"># 보통 선 그래프 작성 시 이을 선에 대한 </span></a>
<a class="sourceLine" id="cb1595-10" title="10"><span class="st">                             </span><span class="co"># 그룹을 지정하기 위해 사용</span></a>
<a class="sourceLine" id="cb1595-11" title="11"><span class="st">                     </span>group</a>
<a class="sourceLine" id="cb1595-12" title="12">                     ...)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1595-13" title="13"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1595-14" title="14"><span class="co"># 표현식 2</span></a>
<a class="sourceLine" id="cb1595-15" title="15"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1595-16" title="16"><span class="st">  </span><span class="kw">aes</span>(...) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1595-17" title="17"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(...))</a>
<a class="sourceLine" id="cb1595-18" title="18"></a>
<a class="sourceLine" id="cb1595-19" title="19"><span class="co"># 표현식 3</span></a>
<a class="sourceLine" id="cb1595-20" title="20"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1595-21" title="21"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(x, y, ...))</a>
<a class="sourceLine" id="cb1595-22" title="22"></a>
<a class="sourceLine" id="cb1595-23" title="23"></a>
<a class="sourceLine" id="cb1595-24" title="24"><span class="co"># 표현식 4</span></a>
<a class="sourceLine" id="cb1595-25" title="25"><span class="op">&lt;</span>GGPLOT_OBJECT<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span><span class="op">-</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb1595-26" title="26"><span class="op">&lt;</span>GGPLOT_OBJECT<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1595-27" title="27"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(...))</a></code></pre></div>


<div class="sourceCode" id="cb1596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1596-1" title="1"><span class="co"># cars 데이터셋</span></a>
<a class="sourceLine" id="cb1596-2" title="2"><span class="co">## ggplot() 내에 aes() 지정 </span></a>
<a class="sourceLine" id="cb1596-3" title="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> cars, </a>
<a class="sourceLine" id="cb1596-4" title="4">       <span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb1596-6" title="6"></a>
<a class="sourceLine" id="cb1596-7" title="7"><span class="co">## aesthetic을 ggplot() 함수 밖에서 지정</span></a>
<a class="sourceLine" id="cb1596-8" title="8"><span class="kw">ggplot</span>(<span class="dt">data =</span> cars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-9" title="9"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb1596-11" title="11"></a>
<a class="sourceLine" id="cb1596-12" title="12"><span class="co">## geom 계열 함수 내에서 asthetic 지정</span></a>
<a class="sourceLine" id="cb1596-13" title="13"><span class="kw">ggplot</span>(<span class="dt">data =</span> cars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-14" title="14"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist))</a>
<a class="sourceLine" id="cb1596-15" title="15"></a>
<a class="sourceLine" id="cb1596-16" title="16"><span class="co">## ggplot 객체 생성 </span></a>
<a class="sourceLine" id="cb1596-17" title="17">gp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> cars); gp</a>
<a class="sourceLine" id="cb1596-18" title="18"></a>
<a class="sourceLine" id="cb1596-19" title="19">gp &lt;-<span class="st"> </span>gp <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-20" title="20"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist); gp</a>
<a class="sourceLine" id="cb1596-21" title="21"></a>
<a class="sourceLine" id="cb1596-22" title="22">gp <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb1596-23" title="23"></a>
<a class="sourceLine" id="cb1596-24" title="24"><span class="co">## 참고: R 기본 plot()의 결과는 객체로 저장되지 않음</span></a>
<a class="sourceLine" id="cb1596-25" title="25">grph &lt;-<span class="st"> </span><span class="kw">plot</span>(cars); grph</a></code></pre></div>

<ul>
<li>주요 aesthetics
<ul>
<li><strong><code>x</code></strong>, <strong><code>y</code></strong>: x-y 축에 해당하는 변수명. <code>x</code>와 <code>y</code>의 이름은 생략 가능(예: <code>ggplot(data = car, aes(speed, dist)</code>로도 사용 가능))</li>
<li><strong><code>color</code></strong>: 점, 선, 텍스트 색상</li>
<li><strong><code>fill</code></strong>: 면(막대, 상자, 도형 등) 색상</li>
<li><strong><code>alpha</code></strong>: 색상의 투명도</li>
<li><strong><code>group</code></strong>: 시각화에 사용할 데이터의 그룹</li>
<li><strong><code>size</code></strong>: 점, 선, 텍스트의 크기 또는 굵기</li>
<li><strong><code>shape</code></strong>: 점의 모양(그림 <a href="high-level-graph.html#fig:plot-symbol">5.3</a> 참고). R 기본 그래픽 파라미터 <code>pch</code>와 호환</li>
<li><strong><code>linetype</code></strong>: 선의 형태 지정하며 그림 <a href="high-level-graph.html#fig:plot-symbol">5.3</a> 의 선 형태 지정 방법 준용(숫자, 문자열 모두 사용 가능)</li>
</ul></li>
<li>색상 관련 aesthetics: <strong><code>color</code></strong>, <strong><code>fill</code></strong>, <strong><code>alpha</code></strong>
<ul>
<li><code>aes()</code> 함수 내부 또는 외부에서 인수 조정 가능(함수 내부: 변수명으로 지정, 함수 외부: 특정 값으로 지정)</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1597"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1597-1" title="1"><span class="co"># 막대도표 예시</span></a>
<a class="sourceLine" id="cb1597-2" title="2"><span class="co"># `aes()` 함수 외부에서 사용 시 단일 값을 입력</span></a>
<a class="sourceLine" id="cb1597-3" title="3">gpcol &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class))</a>
<a class="sourceLine" id="cb1597-4" title="4">gpcol <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1597-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Default geom_bar()&quot;</span>) <span class="co"># 그래프 제목 지정</span></a>
<a class="sourceLine" id="cb1597-6" title="6"></a>
<a class="sourceLine" id="cb1597-7" title="7">gpcol <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;navy&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1597-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;fill = &#39;navy&#39;&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-63-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-63-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1598-1" title="1"><span class="co"># 막대도표 예시</span></a>
<a class="sourceLine" id="cb1598-2" title="2">gpcol <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1598-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;color = &#39;red&#39;&quot;</span>)</a>
<a class="sourceLine" id="cb1598-4" title="4"></a>
<a class="sourceLine" id="cb1598-5" title="5">gpcol <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1598-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;color = &#39;red&#39;, fill = &#39;white&#39;&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-64-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-64-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1599"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1599-1" title="1"><span class="co"># 연료 타입에 따라 면 색 지정</span></a>
<a class="sourceLine" id="cb1599-2" title="2">gpcol <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1599-3" title="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fl)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1599-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Filled by fuel types (fl)&quot;</span>)</a>
<a class="sourceLine" id="cb1599-5" title="5"></a>
<a class="sourceLine" id="cb1599-6" title="6"><span class="co"># 연료 타입에 따라 막대 선 색 지정</span></a>
<a class="sourceLine" id="cb1599-7" title="7">gpcol <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1599-8" title="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">color =</span> fl)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1599-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Colored by fuel types (fl)&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-65-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-65-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1600-1" title="1"><span class="co"># alpha: 0-1 사이 값을 갖고 투명도 지정</span></a>
<a class="sourceLine" id="cb1600-2" title="2"><span class="co"># 주로 aes() 함수 밖에서 사용됨</span></a>
<a class="sourceLine" id="cb1600-3" title="3"><span class="kw">set.seed</span>(<span class="dv">20200605</span>)</a>
<a class="sourceLine" id="cb1600-4" title="4">df1 &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb1600-5" title="5">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">5000</span>), </a>
<a class="sourceLine" id="cb1600-6" title="6">  <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">5000</span>)</a>
<a class="sourceLine" id="cb1600-7" title="7">)</a>
<a class="sourceLine" id="cb1600-8" title="8"></a>
<a class="sourceLine" id="cb1600-9" title="9">gpalpha &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(x, y))</a>
<a class="sourceLine" id="cb1600-10" title="10">gpalpha <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1600-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;alpha = 1&quot;</span>) </a>
<a class="sourceLine" id="cb1600-12" title="12">gpalpha <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1600-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;alpha = 0.1&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-66-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-66-2.svg" width="50%" /></p>

<ul>
<li>그룹(group) aesthetic
<ul>
<li>기본적으로 <code>aes()</code> 내부에서 aesthetic에 대응하는 변수가 이산형(범주형) 변수로 정해짐</li>
<li>보통은 color, shape, linetype 으로 그룹 지정이 가능하지만 충분하지 않은 경우 <code>group</code> 인수 값 지정</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1601"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1601-1" title="1"><span class="co"># 다중 집단에 하나의 aesthetic만 적용한 경우</span></a>
<a class="sourceLine" id="cb1601-2" title="2"><span class="co">## gapminder 데이터셋</span></a>
<a class="sourceLine" id="cb1601-3" title="3">gapm &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dataset/gapminder/gapminder_filter.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1601-4" title="4">gapm_filter &lt;-<span class="st"> </span>gapm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1601-5" title="5"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&quot;Asia&quot;</span>, region))</a>
<a class="sourceLine" id="cb1601-6" title="6">gpgroup &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapm_filter, </a>
<a class="sourceLine" id="cb1601-7" title="7">                  <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> life_expectancy))</a>
<a class="sourceLine" id="cb1601-8" title="8"></a>
<a class="sourceLine" id="cb1601-9" title="9">gpgroup <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) </a>
<a class="sourceLine" id="cb1601-10" title="10">gpgroup_l &lt;-<span class="st"> </span>gpgroup <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country), </a>
<a class="sourceLine" id="cb1601-11" title="11">                                 <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb1601-12" title="12">gpgroup_l</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-67-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-67-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1602-1" title="1"><span class="co"># 전체 아시아 국가의 평균 추세선 </span></a>
<a class="sourceLine" id="cb1602-2" title="2"><span class="co">## geom_line과 geom_smooth 모두 group을 country로 지정</span></a>
<a class="sourceLine" id="cb1602-3" title="3">gpgroup_l <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1602-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country), </a>
<a class="sourceLine" id="cb1602-5" title="5">              <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, </a>
<a class="sourceLine" id="cb1602-6" title="6">              <span class="dt">size =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb1602-7" title="7">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb1602-8" title="8">              <span class="dt">se =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1602-9" title="9"></a>
<a class="sourceLine" id="cb1602-10" title="10"><span class="co">## 모든 국가에 가장 적합한 하나의 곡선으로 fitting</span></a>
<a class="sourceLine" id="cb1602-11" title="11">gpgroup_l <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1602-12" title="12"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb1602-13" title="13">              <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, </a>
<a class="sourceLine" id="cb1602-14" title="14">              <span class="dt">size =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1602-15" title="15">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb1602-16" title="16">              <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-68-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-68-2.svg" width="50%" /></p>

<ul>
<li>크기(size), 점 모양(shape), 선모양(linetype) aesthetic</li>
</ul>

<div class="sourceCode" id="cb1603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1603-1" title="1"><span class="co"># size 지정</span></a>
<a class="sourceLine" id="cb1603-2" title="2">gpsize &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars, </a>
<a class="sourceLine" id="cb1603-3" title="3">                 <span class="kw">aes</span>(disp, mpg))</a>
<a class="sourceLine" id="cb1603-4" title="4"></a>
<a class="sourceLine" id="cb1603-5" title="5">gpsize <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1603-6" title="6"></a>
<a class="sourceLine" id="cb1603-7" title="7">gpsize <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> hp), </a>
<a class="sourceLine" id="cb1603-8" title="8">                    <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-69-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-69-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1604-1" title="1">gpshape &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars, </a>
<a class="sourceLine" id="cb1604-2" title="2">                  <span class="kw">aes</span>(hp, mpg))</a>
<a class="sourceLine" id="cb1604-3" title="3">gpshape <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1604-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">5</span>) <span class="co"># </span></a>
<a class="sourceLine" id="cb1604-5" title="5"></a>
<a class="sourceLine" id="cb1604-6" title="6"><span class="co"># 실린더 개수에 따라 점 모양 지정</span></a>
<a class="sourceLine" id="cb1604-7" title="7">gpshape <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1604-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> <span class="kw">factor</span>(cyl)), </a>
<a class="sourceLine" id="cb1604-9" title="9">             <span class="dt">size =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1604-10" title="10"><span class="co">## pch를 인수로 사용해도 동일한 그래프 출력</span></a>
<a class="sourceLine" id="cb1604-11" title="11"><span class="co"># gpshape + </span></a>
<a class="sourceLine" id="cb1604-12" title="12"><span class="co">#   geom_point(aes(pch = factor(cyl)), </span></a>
<a class="sourceLine" id="cb1604-13" title="13"><span class="co">#              size = 4)</span></a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-70-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-70-2.svg" width="50%" /></p>


<div class="sourceCode" id="cb1605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1605-1" title="1"><span class="co"># linetype 지정</span></a>
<a class="sourceLine" id="cb1605-2" title="2"><span class="co">## economics_long 데이터셋</span></a>
<a class="sourceLine" id="cb1605-3" title="3">gplty &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> economics_long, </a>
<a class="sourceLine" id="cb1605-4" title="4">                <span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> value01))</a>
<a class="sourceLine" id="cb1605-5" title="5"></a>
<a class="sourceLine" id="cb1605-6" title="6">gplty <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1605-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> variable, <span class="dt">color =</span> variable), </a>
<a class="sourceLine" id="cb1605-8" title="8">            <span class="dt">size =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb1605-9" title="9">            <span class="dt">linetype =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1605-10" title="10"></a>
<a class="sourceLine" id="cb1605-11" title="11"><span class="co"># 실린더 개수에 따라 점 모양 지정</span></a>
<a class="sourceLine" id="cb1605-12" title="12">gplty <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1605-13" title="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> variable, </a>
<a class="sourceLine" id="cb1605-14" title="14">                <span class="dt">color =</span> variable), </a>
<a class="sourceLine" id="cb1605-15" title="15">            <span class="dt">size =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-71-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-71-2.svg" width="50%" /></p>

</div>
<div id="geom-lines" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Geoms: 선 관련 geometric</h3>
<ul>
<li><code>geom_line()</code>: x축에 대응한 변수의 순서대로 관측값을 선으로 연결</li>
<li><code>geom_path()</code>: 관측치가 데이터셋에 나타난 순서대로 선으로 연결</li>
<li><code>geom_abline(slope, intercept)</code>: 기울기(<code>slope</code>) 절편(<code>intercept</code>)에 대한 직선 <span class="math inline">\(\rightarrow\)</span> R 기본 그래픽 함수 <code>abline(a=value, b=value)</code>와 유사</li>
<li><code>geom_vline(xintercept)</code>: x축에 수직(y 축에 수평)인 직선 생성</li>
<li><code>geom_hline(yintecept)</code>: x축에 수평(y 축에 수직)인 직선 생성</li>
</ul>

<div class="sourceCode" id="cb1606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1606-1" title="1"><span class="co"># gap-minder 데이터</span></a>
<a class="sourceLine" id="cb1606-2" title="2">gpline &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapm_filter, </a>
<a class="sourceLine" id="cb1606-3" title="3">                  <span class="kw">aes</span>(<span class="dt">y =</span> gdp_cap)) </a>
<a class="sourceLine" id="cb1606-4" title="4"><span class="co"># geom_line</span></a>
<a class="sourceLine" id="cb1606-5" title="5">gpline <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1606-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, </a>
<a class="sourceLine" id="cb1606-7" title="7">                <span class="dt">group =</span> country), </a>
<a class="sourceLine" id="cb1606-8" title="8">            <span class="dt">size =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb1606-9" title="9">            <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb1606-10" title="10">            <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>) -&gt;<span class="st"> </span>gpline</a>
<a class="sourceLine" id="cb1606-11" title="11">gpline</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-72-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1607-1" title="1"><span class="co"># geom_path</span></a>
<a class="sourceLine" id="cb1607-2" title="2">highlight_country &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;Japan&quot;</span>, </a>
<a class="sourceLine" id="cb1607-3" title="3">                       <span class="st">&quot;India&quot;</span>, <span class="st">&quot;Taiwan&quot;</span>, <span class="st">&quot;Singapore&quot;</span>)</a>
<a class="sourceLine" id="cb1607-4" title="4"></a>
<a class="sourceLine" id="cb1607-5" title="5"><span class="co"># dplyr 패키지 체인과 ggplot 함수 연결 가능</span></a>
<a class="sourceLine" id="cb1607-6" title="6">gppath &lt;-<span class="st"> </span>gapm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1607-7" title="7"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span>, </a>
<a class="sourceLine" id="cb1607-8" title="8">         country <span class="op">%in%</span><span class="st"> </span>highlight_country) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1607-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gdp_cap, </a>
<a class="sourceLine" id="cb1607-10" title="10">             <span class="dt">y =</span> life_expectancy))</a>
<a class="sourceLine" id="cb1607-11" title="11"></a>
<a class="sourceLine" id="cb1607-12" title="12">gppath <span class="op">+</span><span class="st"> </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country))</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-73-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1608-1" title="1"><span class="co"># 선 굵기 및 색상 조정</span></a>
<a class="sourceLine" id="cb1608-2" title="2">gppath <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1608-3" title="3"><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">color =</span> country), </a>
<a class="sourceLine" id="cb1608-4" title="4">            <span class="dt">size =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb1608-5" title="5">            <span class="dt">alpha =</span> <span class="fl">0.5</span>) -&gt;<span class="st"> </span>gppath</a>
<a class="sourceLine" id="cb1608-6" title="6"></a>
<a class="sourceLine" id="cb1608-7" title="7"><span class="co"># 선과 점 동시에 출력</span></a>
<a class="sourceLine" id="cb1608-8" title="8">gppath <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1608-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> country), </a>
<a class="sourceLine" id="cb1608-10" title="10">             <span class="dt">size =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-74-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1609-1" title="1"><span class="co"># geom_abline, geom_hline, geom_vline</span></a>
<a class="sourceLine" id="cb1609-2" title="2"><span class="co">## abline</span></a>
<a class="sourceLine" id="cb1609-3" title="3">m &lt;-<span class="st"> </span><span class="kw">lm</span>(gdp_cap <span class="op">~</span><span class="st"> </span>year, <span class="dt">data =</span> gapm_filter)</a>
<a class="sourceLine" id="cb1609-4" title="4">gpline <span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb1609-5" title="5"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="kw">coef</span>(m)[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb1609-6" title="6">              <span class="dt">intercept =</span> <span class="kw">coef</span>(m)[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb1609-7" title="7">              <span class="dt">size =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb1609-8" title="8">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) -&gt;<span class="st"> </span>gplines</a>
<a class="sourceLine" id="cb1609-9" title="9">gplines</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-75-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1610-1" title="1"><span class="co">## hline</span></a>
<a class="sourceLine" id="cb1610-2" title="2">gplines <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1610-3" title="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(gapm_filter<span class="op">$</span>gdp_cap, </a>
<a class="sourceLine" id="cb1610-4" title="4">                               <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb1610-5" title="5">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb1610-6" title="6">             <span class="dt">size =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>gplines</a>
<a class="sourceLine" id="cb1610-7" title="7">gplines <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Addling a horizontal line: mean of gdp_cap&quot;</span>)</a>
<a class="sourceLine" id="cb1610-8" title="8"></a>
<a class="sourceLine" id="cb1610-9" title="9"><span class="co">## vline  </span></a>
<a class="sourceLine" id="cb1610-10" title="10">gplines <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1610-11" title="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(gapm_filter<span class="op">$</span>year, </a>
<a class="sourceLine" id="cb1610-12" title="12">                               <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb1610-13" title="13">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb1610-14" title="14">             <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1610-15" title="15"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Adding a vertical line: mean of year&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-76-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-76-2.svg" width="50%" /></p>

</div>
<div id="geom-points" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Geoms: 점 geometrics</h3>
<ul>
<li><code>geom_point()</code>: ggplot 객체에 지정된 aesthetic (x-y에 대응하는 변수)에 대한 산점도를 생성</li>
<li><code>geom_jitter()</code>: 각 점의 위치에 random noise를 추가해 overplotting 처리 <span class="math inline">\(\rightarrow\)</span> <code>geom_point(position = "jitter")</code>의 축약 버전</li>
</ul>

<div class="sourceCode" id="cb1611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1611-1" title="1"><span class="co"># geom_point</span></a>
<a class="sourceLine" id="cb1611-2" title="2"><span class="co">## 갭마인더 데이터: 2015년 기대수명 vs. 일인당 국민소득 산점도</span></a>
<a class="sourceLine" id="cb1611-3" title="3">gppoint &lt;-<span class="st"> </span>gapm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">gsub</span>(<span class="st">&quot;(.+</span><span class="ch">\\</span><span class="st">s)&quot;</span>, <span class="st">&quot;&quot;</span>, region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-5" title="5"><span class="st">  </span><span class="co"># region 변수에서 공백 앞 문자 모두 제거</span></a>
<a class="sourceLine" id="cb1611-6" title="6"><span class="st">           </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-7" title="7"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> life_expectancy, <span class="dt">y =</span> gdp_cap))</a>
<a class="sourceLine" id="cb1611-9" title="9"></a>
<a class="sourceLine" id="cb1611-10" title="10">gppoint <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-11" title="11"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-77-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1612-1" title="1"><span class="co">## 점의 크기는 해당 국가 인구수(log10 변환) 에 비례</span></a>
<a class="sourceLine" id="cb1612-2" title="2"><span class="co">## 각 대륙에 따라 색 구분</span></a>
<a class="sourceLine" id="cb1612-3" title="3"><span class="co">## 투명도는 0.3</span></a>
<a class="sourceLine" id="cb1612-4" title="4"><span class="co">## --&gt; Bubble plot</span></a>
<a class="sourceLine" id="cb1612-5" title="5">gppoint <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1612-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> <span class="kw">log</span>(population, <span class="dt">base=</span><span class="dv">10</span>), </a>
<a class="sourceLine" id="cb1612-7" title="7">                 <span class="dt">color =</span> continent), </a>
<a class="sourceLine" id="cb1612-8" title="8">             <span class="dt">alpha =</span> <span class="fl">0.3</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-78-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1613-1" title="1"><span class="co">## mpg 데이터 셋</span></a>
<a class="sourceLine" id="cb1613-2" title="2"><span class="co">## cylinder 개수에 따른 시내 연비</span></a>
<a class="sourceLine" id="cb1613-3" title="3">gppoint2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, </a>
<a class="sourceLine" id="cb1613-4" title="4">                   <span class="kw">aes</span>(<span class="dt">x =</span> cyl, <span class="dt">y =</span> cty))</a>
<a class="sourceLine" id="cb1613-5" title="5">gppoint2 <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-79-1.svg" width="672" /></p>


<div class="sourceCode" id="cb1614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1614-1" title="1"><span class="co"># geom_jitter</span></a>
<a class="sourceLine" id="cb1614-2" title="2"><span class="co">## geom_point에서 position 인수 조정</span></a>
<a class="sourceLine" id="cb1614-3" title="3">gppoint2 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1614-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1614-5" title="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;geom_point() with position = &#39;jitter&#39;&quot;</span>)</a>
<a class="sourceLine" id="cb1614-6" title="6"></a>
<a class="sourceLine" id="cb1614-7" title="7"><span class="co">## geom_jitter: jittering 크기는 0.3</span></a>
<a class="sourceLine" id="cb1614-8" title="8"><span class="co">## class로 색 조정</span></a>
<a class="sourceLine" id="cb1614-9" title="9">gppoint2 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1614-10" title="10"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> class), </a>
<a class="sourceLine" id="cb1614-11" title="11">              <span class="dt">width =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1614-12" title="12"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Jittering using geom_jitter()&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-80-1.svg" width="50%" /><img src="05-data-visualization_files/figure-html/unnamed-chunk-80-2.svg" width="50%" /></p>

</div>
<div id="geom-bars" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Geoms: 막대 geometrics</h3>
<ul>
<li><code>geom_bar()</code>: 범주형(factor 또는 문자열) 변수에 대응하는 케이스의 수를 막대의 높이로 나타냄.
<ul>
<li>기본적으로 <code>stat_count()</code>를 통해 각 집단 별 케이스 수가 그래프에 표현</li>
<li>함수 내 <code>stat</code> 인수 값을 “identity”로 설정 시 데이터 값 표현 가능</li>
</ul></li>
<li><code>geom_col()</code>: 데이터 값 자체를 높이로 표현
<ul>
<li><code>stat_identity()</code>를 사용</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1615-1" title="1"><span class="co"># geom_bar(), geom_col() 주요 함수 인수</span></a>
<a class="sourceLine" id="cb1615-2" title="2"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="st"> </span><span class="er">=</span><span class="st"> </span><span class="kw">aes</span>() 함수를 통해 수행</a>
<a class="sourceLine" id="cb1615-3" title="3">            <span class="kw">geom_bar</span>()의 경우 <span class="kw">aes</span>() 내 x 위치에 대응하는</a>
<a class="sourceLine" id="cb1615-4" title="4">            변수명만 입력해도 되지만, <span class="kw">geom_col</span>()의 경우, </a>
<a class="sourceLine" id="cb1615-5" title="5">            x, y 에 대응하는 변수 모두 입력</a>
<a class="sourceLine" id="cb1615-6" title="6"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1615-7" title="7"><span class="st">  </span><span class="op">-</span><span class="st"> </span>width<span class="op">:</span><span class="st"> </span>상자의 너비 조정</a>
<a class="sourceLine" id="cb1615-8" title="8">  <span class="op">-</span><span class="st"> </span>positon<span class="op">:</span><span class="st"> </span>문자열 또는 위치 조정 관련 함수 호출 가능</a>
<a class="sourceLine" id="cb1615-9" title="9">    두 개 이상의 범주가 한 그래프에 표현된 경우, </a>
<a class="sourceLine" id="cb1615-10" title="10">    디폴트 값은 <span class="st">&quot;stack&quot;</span> (<span class="kw">position_stack</span>() 호출). </a>
<a class="sourceLine" id="cb1615-11" title="11">    두 번째 범주에 해당하는 막대를 나란히 배열하고자 할 때, </a>
<a class="sourceLine" id="cb1615-12" title="12">    positon =<span class="st"> &quot;dodge&quot;</span>, <span class="st">&quot;dodge2&quot;</span>, 또는 <span class="kw">position_dodge</span>(값) 사용</a></code></pre></div>

<div id="geom-bars-example" class="section level4 unnumbered">
<h4><strong>Examples</strong></h4>

<div class="sourceCode" id="cb1616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1616-1" title="1"><span class="co"># geom_bar()와 geom_col() 예시</span></a>
<a class="sourceLine" id="cb1616-2" title="2">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, </a>
<a class="sourceLine" id="cb1616-3" title="3">       <span class="kw">aes</span>(<span class="dt">x =</span> class)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-4" title="4"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: Barplot via geom_bar()&quot;</span>, </a>
<a class="sourceLine" id="cb1616-6" title="6">       <span class="dt">caption =</span> <span class="st">&quot;The y-axis indicates the number of cases in each class&quot;</span>)</a>
<a class="sourceLine" id="cb1616-7" title="7"></a>
<a class="sourceLine" id="cb1616-8" title="8">p2 &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-9" title="9"><span class="st">  </span><span class="kw">group_by</span>(class) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-10" title="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(cty)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-11" title="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> mean)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1616-12" title="12"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1616-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: Barplot via geom_col()&quot;</span>, </a>
<a class="sourceLine" id="cb1616-14" title="14">       <span class="dt">caption =</span> <span class="st">&quot;The y axis indicates the identical values of means&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/bar-plots-ex-1.svg" width="960" /></p>


<div class="sourceCode" id="cb1617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1617-1" title="1"><span class="co"># geom_bar(stat = &quot;identity&quot;) 인 경우 geom_col()과 동일한 결과 도출</span></a>
<a class="sourceLine" id="cb1617-2" title="2">p1 &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1617-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(class) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1617-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(cty)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1617-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> mean)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1617-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1617-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: Barplot via geom_bar(stat = &#39;identity&#39;)&quot;</span>)</a></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1619-1" title="1"><span class="co"># 막대도표 x-y 축 변환</span></a>
<a class="sourceLine" id="cb1619-2" title="2"><span class="co"># 이 경우 geom_bar()에 aesthetic 추가</span></a>
<a class="sourceLine" id="cb1619-3" title="3">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1619-4" title="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> class)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1619-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: Map &#39;class&#39; variable to y&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/bar-plots-ex2-1.svg" width="960" /></p>


<div class="sourceCode" id="cb1620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1620-1" title="1"><span class="co"># diamonds dataset</span></a>
<a class="sourceLine" id="cb1620-2" title="2"><span class="co"># 2개의 범주형 변수가 aesthetic에 mapping된 경우</span></a>
<a class="sourceLine" id="cb1620-3" title="3"><span class="co"># stacked barplot</span></a>
<a class="sourceLine" id="cb1620-4" title="4">gbar_init &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1620-5" title="5"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">fill =</span> cut)</a>
<a class="sourceLine" id="cb1620-6" title="6">p1 &lt;-<span class="st"> </span>gbar_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1620-7" title="7"><span class="st">  </span><span class="kw">geom_bar</span>()</a>
<a class="sourceLine" id="cb1620-8" title="8">  </a>
<a class="sourceLine" id="cb1620-9" title="9"><span class="co"># fill에 해당하는 범주에 대해 나란히 배열</span></a>
<a class="sourceLine" id="cb1620-10" title="10">p2 &lt;-<span class="st"> </span>gbar_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1620-11" title="11"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge2&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/bar-plots-ex3-1.svg" width="1056" /></p>

<ul>
<li>막대도표 값 순으로 정렬하기</li>
</ul>

<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1621-1" title="1"><span class="co"># gapminder region 별 중위수 계산</span></a>
<a class="sourceLine" id="cb1621-2" title="2">gapm_median &lt;-<span class="st"> </span>gapm <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1621-3" title="3"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1621-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1621-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">median =</span> <span class="kw">median</span>(gdp_cap, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb1623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1623-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapm_median) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1623-2" title="2"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> region, <span class="dt">y =</span> median) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1623-3" title="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1623-4" title="4"><span class="st">  </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb1623-5" title="5"></a>
<a class="sourceLine" id="cb1623-6" title="6">p2 &lt;-<span class="st"> </span>gapm_median <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1623-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">region =</span> <span class="kw">reorder</span>(region, median)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1623-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> region, <span class="dt">y =</span> median)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1623-9" title="9"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1623-10" title="10"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="co"># x-y 축 뒤집기</span></a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-86-1.svg" width="1152" /></p>

</div>
</div>
<div id="geom-intervals" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Geom: 수직 범위선 관련 geometrics</h3>
<p>오차 막대, 신뢰구간 등을 도식화 할 때 많이 활용되며 데이터의 변수를 mapping 시 위치 관련 aesthetic에 <code>x</code>, <code>y</code> 외에 <code>ymin</code>(또는 <code>xmin</code>), <code>ymax</code>(또는 <code>xmax</code>)가 사용</p>
<ul>
<li><code>geom_errorbar()</code>: 주어진 범위(구간) 내 오차막대(errorbar) 생성 <span class="math inline">\(\rightarrow\)</span> 오차막대는 선 끝에 범위 선과 수직인 선이 생성</li>
<li><code>geom_linerange()</code>: 주어진 범위(구간) 내 선 생성</li>
</ul>

<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1624-1" title="1"><span class="co"># geom_errorbar(), geom_linerange() 주요 함수 인수</span></a>
<a class="sourceLine" id="cb1624-2" title="2"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="st"> </span><span class="er">=</span><span class="st"> </span>기본 x, y에 대한 aesthetic 기본 mapping 이외</a>
<a class="sourceLine" id="cb1624-3" title="3">            범위를 지정하는 <span class="kw">ymin</span> (ymax), <span class="kw">xmin</span> (ymax) 지정 필수</a>
<a class="sourceLine" id="cb1624-4" title="4"></a>
<a class="sourceLine" id="cb1624-5" title="5"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1624-6" title="6"><span class="st">  </span><span class="op">-</span><span class="st"> </span>width<span class="op">:</span><span class="st"> </span><span class="kw">geom_errorbar</span>()에서 범위선에 수직인 선의 너비 짖어</a>
<a class="sourceLine" id="cb1624-7" title="7">  <span class="op">-</span><span class="st"> </span>positon<span class="op">:</span><span class="st"> </span>문자열 또는 위치 조정 관련 함수 호출 가능</a>
<a class="sourceLine" id="cb1624-8" title="8">    positon =<span class="st"> &quot;dodge&quot;</span>, <span class="st">&quot;dodge2&quot;</span>, 또는 <span class="kw">position_dodge</span>(값) 사용</a></code></pre></div>


<div class="sourceCode" id="cb1625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1625-1" title="1"><span class="co"># geom_errorbar() 예시</span></a>
<a class="sourceLine" id="cb1625-2" title="2"><span class="co"># diamonds cut, color에 따른 carat의 평균, 표준편차,  95% 신뢰구간 계산</span></a>
<a class="sourceLine" id="cb1625-3" title="3"><span class="co"># dplyr + pipe operator를 이용한 통계량 계산</span></a>
<a class="sourceLine" id="cb1625-4" title="4">carat_summ &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1625-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(cut, color) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1625-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">N =</span> <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb1625-7" title="7">            <span class="dt">mean =</span> <span class="kw">mean</span>(carat), </a>
<a class="sourceLine" id="cb1625-8" title="8">            <span class="dt">sd =</span> <span class="kw">sd</span>(carat)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1625-9" title="9"><span class="st">  </span><span class="co"># 95 % 신뢰구간(모분산 모른다고 가정)</span></a>
<a class="sourceLine" id="cb1625-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lcl =</span> mean <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, N<span class="dv">-1</span>)<span class="op">*</span>sd<span class="op">/</span><span class="kw">sqrt</span>(N), </a>
<a class="sourceLine" id="cb1625-11" title="11">         <span class="dt">ucl =</span> mean <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, N<span class="dv">-1</span>)<span class="op">*</span>sd<span class="op">/</span><span class="kw">sqrt</span>(N))</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;cut&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb1627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1627-1" title="1">gerror_init &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> carat_summ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1627-2" title="2"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> mean, <span class="dt">color =</span> color) </a>
<a class="sourceLine" id="cb1627-3" title="3"></a>
<a class="sourceLine" id="cb1627-4" title="4"><span class="co"># 오차 막대 도표 (디폴트) 오차 범위는 95 % 신뢰구간</span></a>
<a class="sourceLine" id="cb1627-5" title="5">gerror_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1627-6" title="6"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lcl, </a>
<a class="sourceLine" id="cb1627-7" title="7">                    <span class="dt">ymax =</span> ucl))</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/errorbar-ex1-1.svg" width="960" /></p>


<div class="sourceCode" id="cb1628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1628-1" title="1"><span class="co"># 오차 막대 도표2</span></a>
<a class="sourceLine" id="cb1628-2" title="2"><span class="co"># 선과 점 추가</span></a>
<a class="sourceLine" id="cb1628-3" title="3"><span class="co"># 집단 별 위치 및 막대 조정</span></a>
<a class="sourceLine" id="cb1628-4" title="4">gerror_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1628-5" title="5"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lcl, </a>
<a class="sourceLine" id="cb1628-6" title="6">                    <span class="dt">ymax =</span> ucl), </a>
<a class="sourceLine" id="cb1628-7" title="7">                <span class="dt">width =</span> <span class="fl">0.1</span>,  <span class="co"># 선 너비 지정</span></a>
<a class="sourceLine" id="cb1628-8" title="8">                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.8</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1628-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> color)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1628-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/errobar-ex2-1.svg" width="960" /></p>

<ul>
<li>평균-95 % 신뢰구간 오차 막대 도표 예시</li>
</ul>

<div class="sourceCode" id="cb1629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1629-1" title="1"><span class="co"># 점과 선에 대해서도 동일하게 position 조정 필요</span></a>
<a class="sourceLine" id="cb1629-2" title="2"><span class="co"># position은 수동으로 조정(&quot;dodge&quot; 등 대신 position_dodge(value) 입력)</span></a>
<a class="sourceLine" id="cb1629-3" title="3">gerror_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1629-4" title="4"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lcl, </a>
<a class="sourceLine" id="cb1629-5" title="5">                    <span class="dt">ymax =</span> ucl), </a>
<a class="sourceLine" id="cb1629-6" title="6">                <span class="dt">width =</span> <span class="fl">0.1</span>,  <span class="co"># 선 너비 지정</span></a>
<a class="sourceLine" id="cb1629-7" title="7">                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.8</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1629-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> color), </a>
<a class="sourceLine" id="cb1629-9" title="9">            <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.8</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1629-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb1629-11" title="11">             <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.8</span>))</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/errobar-ex3-1.svg" width="960" /></p>

<ul>
<li>막대도표 위에 오차 막대 표시 예제</li>
</ul>

<div class="sourceCode" id="cb1630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1630-1" title="1"><span class="co"># warpbreaks 데이터</span></a>
<a class="sourceLine" id="cb1630-2" title="2"><span class="co"># R 기본 그래픽스 barplot() 예제와 동일한 그래프 생성</span></a>
<a class="sourceLine" id="cb1630-3" title="3"></a>
<a class="sourceLine" id="cb1630-4" title="4">break_summ &lt;-<span class="st"> </span>warpbreaks <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1630-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(wool, tension) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1630-6" title="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">N =</span> <span class="kw">n</span>(),  </a>
<a class="sourceLine" id="cb1630-7" title="7">            <span class="dt">mean =</span> <span class="kw">mean</span>(breaks), </a>
<a class="sourceLine" id="cb1630-8" title="8">            <span class="dt">sem =</span> <span class="kw">sd</span>(breaks)<span class="op">/</span><span class="kw">sqrt</span>(N)) </a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;wool&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb1632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1632-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> break_summ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1632-2" title="2"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> tension, <span class="dt">y =</span> mean, <span class="dt">fill =</span> wool) <span class="op">+</span><span class="st"> </span><span class="co"># aesthetic 지정</span></a>
<a class="sourceLine" id="cb1632-3" title="3"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>), </a>
<a class="sourceLine" id="cb1632-4" title="4">           <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># 테두리 선 색상 지정(검정)</span></a>
<a class="sourceLine" id="cb1632-5" title="5"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean <span class="op">-</span><span class="st"> </span>sem, </a>
<a class="sourceLine" id="cb1632-6" title="6">                    <span class="dt">ymax =</span> mean <span class="op">+</span><span class="st"> </span>sem), </a>
<a class="sourceLine" id="cb1632-7" title="7">                <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>), </a>
<a class="sourceLine" id="cb1632-8" title="8">                <span class="dt">width =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/errobar-ex4-1.svg" width="960" /></p>

<ul>
<li>95 % 신뢰구간 시뮬레이션 예제</li>
</ul>

<div class="sourceCode" id="cb1633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1633-1" title="1"><span class="co"># geom_linerange 예시</span></a>
<a class="sourceLine" id="cb1633-2" title="2"><span class="co"># 정규 난수 생성</span></a>
<a class="sourceLine" id="cb1633-3" title="3"><span class="co"># 표본 크기 n = 30, 반복 N = 200</span></a>
<a class="sourceLine" id="cb1633-4" title="4"><span class="co"># 평균 mu = 20, 표준편차 sx = 10</span></a>
<a class="sourceLine" id="cb1633-5" title="5"><span class="co"># 각 표본에 대한 95 % 신뢰구간 계산(모분산은 안다고 가정)</span></a>
<a class="sourceLine" id="cb1633-6" title="6"><span class="kw">set.seed</span>(<span class="dv">20200609</span>)</a>
<a class="sourceLine" id="cb1633-7" title="7">n &lt;-<span class="st"> </span><span class="dv">30</span>; N =<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb1633-8" title="8">mu &lt;-<span class="st"> </span><span class="dv">20</span>; sx &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1633-9" title="9">X &lt;-<span class="st"> </span><span class="kw">mapply</span>(rnorm, </a>
<a class="sourceLine" id="cb1633-10" title="10">            <span class="kw">rep</span>(n, N), </a>
<a class="sourceLine" id="cb1633-11" title="11">            <span class="kw">rep</span>(mu, N), </a>
<a class="sourceLine" id="cb1633-12" title="12">            <span class="kw">rep</span>(sx, N))</a>
<a class="sourceLine" id="cb1633-13" title="13">mi &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, mean) <span class="co"># 각 반복에 대한 표본 평균 계산</span></a>
<a class="sourceLine" id="cb1633-14" title="14">si &lt;-<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, sd) <span class="co"># 각 반복에 대한 표준편차 계산</span></a>
<a class="sourceLine" id="cb1633-15" title="15">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># 유의수준</span></a>
<a class="sourceLine" id="cb1633-16" title="16">lower_ci &lt;-<span class="st"> </span>mi <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>si<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co"># 신뢰구간 하한</span></a>
<a class="sourceLine" id="cb1633-17" title="17">upper_ci &lt;-<span class="st"> </span>mi <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>si<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="co"># 신뢰구간 상한</span></a>
<a class="sourceLine" id="cb1633-18" title="18">df_ci &lt;-<span class="st"> </span><span class="kw">tibble</span>(lower_ci, upper_ci) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1633-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nsim =</span> <span class="kw">seq_len</span>(N), </a>
<a class="sourceLine" id="cb1633-20" title="20">         <span class="dt">mu_contain =</span> lower_ci <span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1633-21" title="21"><span class="st">           </span>mu <span class="op">&lt;=</span><span class="st"> </span>upper_ci)</a>
<a class="sourceLine" id="cb1633-22" title="22"></a>
<a class="sourceLine" id="cb1633-23" title="23">ggci_init &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_ci) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-24" title="24"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> nsim) <span class="co"># simulation 횟수 정보</span></a>
<a class="sourceLine" id="cb1633-25" title="25"></a>
<a class="sourceLine" id="cb1633-26" title="26">ggci_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1633-27" title="27"><span class="st">  </span><span class="kw">geom_linerange</span>(</a>
<a class="sourceLine" id="cb1633-28" title="28">    <span class="kw">aes</span>(<span class="dt">ymin =</span> lower_ci, <span class="co"># 하한</span></a>
<a class="sourceLine" id="cb1633-29" title="29">        <span class="dt">ymax =</span>upper_ci,  <span class="co"># 상한</span></a>
<a class="sourceLine" id="cb1633-30" title="30">        <span class="dt">color =</span> mu_contain), <span class="co"># 색 지정</span></a>
<a class="sourceLine" id="cb1633-31" title="31">    <span class="dt">size =</span> <span class="fl">1.2</span>, </a>
<a class="sourceLine" id="cb1633-32" title="32">    <span class="dt">alpha =</span> <span class="fl">0.3</span></a>
<a class="sourceLine" id="cb1633-33" title="33">  ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1633-34" title="34"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> mu,</a>
<a class="sourceLine" id="cb1633-35" title="35">             <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>, </a>
<a class="sourceLine" id="cb1633-36" title="36">             <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-88-1.svg" width="1056" /></p>

</div>
<div id="geom-texts" class="section level3">
<h3><span class="header-section-number">5.4.6</span> Geoms: 텍스트 관련 geometrics</h3>
<p>x-y 좌표축에 텍스트를 추가하기 위한 함수. 여기서 미리 지정된 x-y aesthetic에 대한 매핑은 사용할 수 있으며, 별도의 aesthetic 정의를 통해 새로운 좌표점에 텍스트 추가 가능</p>
<ul>
<li><code>geom_text()</code></li>
<li><code>geom_label()</code>: 추가한 텍스트 뒤에 사각형을 동시에 출력</li>
</ul>

<div class="sourceCode" id="cb1634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1634-1" title="1"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="er">:</span><span class="st"> </span>필수 aesthetic은 x, y, label 임</a>
<a class="sourceLine" id="cb1634-2" title="2"></a>
<a class="sourceLine" id="cb1634-3" title="3">다음 aesthetic 속성들은 <span class="kw">geom_text</span>() 또는 <span class="kw">geom_label</span>() </a>
<a class="sourceLine" id="cb1634-4" title="4">함수에서 인수(<span class="kw">aes</span>() 함수 외부)로 사용 가능</a>
<a class="sourceLine" id="cb1634-5" title="5"></a>
<a class="sourceLine" id="cb1634-6" title="6"><span class="op">-</span><span class="st"> </span>angle<span class="op">:</span><span class="st"> </span>텍스트 각도 조정</a>
<a class="sourceLine" id="cb1634-7" title="7"><span class="op">-</span><span class="st"> </span>family<span class="op">:</span><span class="st"> </span>텍스트 폰트 페미리</a>
<a class="sourceLine" id="cb1634-8" title="8"><span class="op">-</span><span class="st"> </span>fontface<span class="op">:</span><span class="st"> </span>텍스트 형태(<span class="st">&quot;bold&quot;</span>, <span class="st">&quot;italic&quot;</span>, <span class="st">&quot;bold.italic&quot;</span>, <span class="st">&quot;plain&quot;</span> 가능)</a>
<a class="sourceLine" id="cb1634-9" title="9"><span class="op">-</span><span class="st"> </span>hjust<span class="op">:</span><span class="st"> </span>텍스트 수평 위치 조정</a>
<a class="sourceLine" id="cb1634-10" title="10"><span class="op">-</span><span class="st"> </span>vjust<span class="op">:</span><span class="st"> </span>텍스트 수직 위지 초정</a>
<a class="sourceLine" id="cb1634-11" title="11"></a>
<a class="sourceLine" id="cb1634-12" title="12"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span><span class="st"> </span>(중요 인수)</a>
<a class="sourceLine" id="cb1634-13" title="13">  <span class="op">-</span><span class="st"> </span>parse<span class="op">:</span><span class="st"> </span>논리값, 문자열을 parsing 하여 <span class="kw">expression</span>() 함수로 표현</a>
<a class="sourceLine" id="cb1634-14" title="14">  <span class="op">-</span><span class="st"> </span>check_overlap<span class="op">:</span><span class="st"> </span>이전에 생성된 텍스트 위에 새로운 텍스트가 중첩(overlapping)될 경우</a>
<a class="sourceLine" id="cb1634-15" title="15">                   인수값이 <span class="ot">TRUE</span> 이면 출력하지 않음. (<span class="kw">geom_text</span>()에서만 사용 가능)</a></code></pre></div>

<ul>
<li><code>geom_text() 예시</code></li>
</ul>

<div class="sourceCode" id="cb1635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1635-1" title="1">gtext_init &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-2" title="2"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;model&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) </a>
<a class="sourceLine" id="cb1635-4" title="4"></a>
<a class="sourceLine" id="cb1635-5" title="5">gtext1 &lt;-<span class="st"> </span>gtext_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-6" title="6"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> model), </a>
<a class="sourceLine" id="cb1635-7" title="7">            <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st">  </span><span class="co"># x-y aesthetic 사용</span></a>
<a class="sourceLine" id="cb1635-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;geom_text() with size = 4&quot;</span>)</a>
<a class="sourceLine" id="cb1635-9" title="9">  </a>
<a class="sourceLine" id="cb1635-10" title="10"><span class="co"># 중첩되는 텍스트 제거</span></a>
<a class="sourceLine" id="cb1635-11" title="11">gtext2 &lt;-<span class="st"> </span>gtext_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-12" title="12"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> model), </a>
<a class="sourceLine" id="cb1635-13" title="13">            <span class="dt">size =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb1635-14" title="14">            <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-15" title="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Remove overlapped text with check_overlap = TRUE&quot;</span>)</a>
<a class="sourceLine" id="cb1635-16" title="16"></a>
<a class="sourceLine" id="cb1635-17" title="17"><span class="co"># geom_label() </span></a>
<a class="sourceLine" id="cb1635-18" title="18"><span class="co"># check_overlap 옵션 사용할 수 없음</span></a>
<a class="sourceLine" id="cb1635-19" title="19">gtext3 &lt;-<span class="st"> </span>gtext_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-20" title="20"><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> model), </a>
<a class="sourceLine" id="cb1635-21" title="21">             <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-22" title="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;geom_label()&quot;</span>)</a>
<a class="sourceLine" id="cb1635-23" title="23"></a>
<a class="sourceLine" id="cb1635-24" title="24">gtext4 &lt;-<span class="st"> </span>gtext_init <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-25" title="25"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-26" title="26"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> model, </a>
<a class="sourceLine" id="cb1635-27" title="27">                <span class="dt">color =</span> <span class="kw">factor</span>(cyl)), </a>
<a class="sourceLine" id="cb1635-28" title="28">            <span class="dt">size =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb1635-29" title="29">            <span class="dt">fontface =</span> <span class="st">&quot;italic&quot;</span>, </a>
<a class="sourceLine" id="cb1635-30" title="30">            <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-31" title="31"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Both points and texts: using italic fontface&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-91-1.svg" width="1056" /></p>

<div id="text-adjustment" class="section level4 unnumbered">
<h4>ggplot 텍스트 위치 조정</h4>
<p>R 기본 그래픽 함수 <code>text()</code> 함수의 <code>adj</code> 인수와 유사</p>
<ul>
<li>vjust: (-) 방향 <span class="math inline">\(\uparrow\)</span>; middle = 0.5; (+) 방향 <span class="math inline">\(\downarrow\)</span></li>
<li>hjust: (-) 방향 <span class="math inline">\(\rightarrow\)</span>; middle = 0.5; (+) 방향 <span class="math inline">\(\leftarrow\)</span></li>
</ul>


<div class="rmdwarning">
<p><code>vjust</code>, <code>hjust</code> 모두 (0, 1) 밖의 값을 갖을 수 있으나, 이러한 위치 조정은 그래프의 크기에 상대적이기 때문에 해당 값들을 이용해 텍스트 위치를 과도하게 조정하는 것이 바람직한 방법은 아님.</p>
</div>



<div class="sourceCode" id="cb1636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1636-1" title="1"><span class="co"># hjust, vjust 별 문자 위치 표시</span></a>
<a class="sourceLine" id="cb1636-2" title="2">adj_val &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1636-3" title="3">df_adjust &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">hjust =</span> adj_val, </a>
<a class="sourceLine" id="cb1636-4" title="4">                         <span class="dt">vjust =</span> adj_val)</a>
<a class="sourceLine" id="cb1636-5" title="5">df_adjust &lt;-<span class="st"> </span>df_adjust <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1636-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">just_label =</span> <span class="kw">sprintf</span>(<span class="st">&quot;(h=%.1f, v=%.1f)&quot;</span>, </a>
<a class="sourceLine" id="cb1636-7" title="7">                              hjust, vjust))</a>
<a class="sourceLine" id="cb1636-8" title="8"><span class="kw">ggplot</span>(<span class="dt">data =</span> df_adjust) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1636-9" title="9"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> hjust, <span class="dt">y =</span> vjust) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1636-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>, </a>
<a class="sourceLine" id="cb1636-11" title="11">             <span class="dt">alpha =</span> <span class="fl">0.8</span>, </a>
<a class="sourceLine" id="cb1636-12" title="12">             <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1636-13" title="13"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> just_label, </a>
<a class="sourceLine" id="cb1636-14" title="14">                <span class="dt">hjust =</span> hjust, </a>
<a class="sourceLine" id="cb1636-15" title="15">                <span class="dt">vjust =</span> vjust))</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-93"></span>
<img src="05-data-visualization_files/figure-html/unnamed-chunk-93-1.svg" alt="hjust와 vjust 값에 따른 텍스트 위치. https://ggplot2.tidyverse.org/articles/ggplot2-specs.html 인용" width="768" />
<p class="caption">
Figure 5.26: hjust와 vjust 값에 따른 텍스트 위치. <a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html" class="uri">https://ggplot2.tidyverse.org/articles/ggplot2-specs.html</a> 인용
</p>
</div>

</div>
<div id="geomtext-math-expression" class="section level4 unnumbered">
<h4>geom_text() 수식(math) 표기</h4>
<ul>
<li>R 기본 그래픽 함수에서 적용한 <code>expression()</code>, <code>bquote()</code> 함수를 이용해 수식 표현 가능.</li>
<li><code>bquote()</code>를 이용 시 생성한 표현을 다시 parsing (문자열을 expression 구문으로 해석) 하기 위해 <code>deparse()</code> 함수를 통해 문자열로 변환해줘야 함. 이 때 텍스트가 <code>label</code>의 값으로 입력이 되기 때문에 텍스트를 expression() 형태로 바꿔주기 위해 <code>parse = TRUE</code> 로 설정해야 수식 표현 가능</li>
</ul>

<div class="sourceCode" id="cb1637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1637-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb1637-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1637-3" title="3">df_dummy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1637-4" title="4"><span class="co"># 정규분포 pdf </span></a>
<a class="sourceLine" id="cb1637-5" title="5">expr1 &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="kw">paste</span>(f, </a>
<a class="sourceLine" id="cb1637-6" title="6">                          <span class="st">&quot;(&quot;</span>, x, <span class="st">&quot;;&quot;</span>, <span class="kw">list</span>(mu, sigma), <span class="st">&quot;)&quot;</span></a>
<a class="sourceLine" id="cb1637-7" title="7">                          <span class="op">==</span><span class="st"> </span><span class="kw">frac</span>(<span class="dv">1</span>, sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="er">~~</span>exp <span class="op">*</span></a>
<a class="sourceLine" id="cb1637-8" title="8"><span class="st">                            </span><span class="kw">bgroup</span>(<span class="st">&#39;(&#39;</span>, </a>
<a class="sourceLine" id="cb1637-9" title="9">                                   <span class="op">-</span><span class="kw">frac</span>((x<span class="op">-</span>mu)<span class="op">^</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb1637-10" title="10">                                         <span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>), <span class="st">&#39;)&#39;</span>)))</a>
<a class="sourceLine" id="cb1637-11" title="11"><span class="co"># 회귀계수 추정 공식</span></a>
<a class="sourceLine" id="cb1637-12" title="12">expr2 &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="kw">hat</span>(<span class="kw">bold</span>(beta)) <span class="op">==</span></a>
<a class="sourceLine" id="cb1637-13" title="13"><span class="st">                    </span><span class="kw">bgroup</span>(<span class="st">&quot;(&quot;</span>, <span class="kw">bold</span>(X)<span class="op">^</span>T<span class="op">*</span><span class="kw">bold</span>(X), </a>
<a class="sourceLine" id="cb1637-14" title="14">                     <span class="st">&quot;)&quot;</span>)<span class="op">^-</span><span class="dv">1</span><span class="op">*</span><span class="kw">bold</span>(X)<span class="op">^</span>T<span class="op">*</span><span class="kw">bold</span>(y))</a>
<a class="sourceLine" id="cb1637-15" title="15"><span class="co"># 그리스 문자</span></a>
<a class="sourceLine" id="cb1637-16" title="16">expr3 &lt;-<span class="st"> </span><span class="kw">expression</span>(alpha[<span class="dv">1</span>]<span class="op">~</span><span class="er">~</span>beta[<span class="dv">2</span>]<span class="op">~</span><span class="er">~</span>gamma[<span class="dv">3</span>]<span class="op">~</span><span class="er">~</span>delta[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb1637-17" title="17">                    <span class="op">~</span><span class="er">~</span>epsilon[<span class="dv">5</span>]<span class="op">~</span><span class="er">~</span>theta[<span class="dv">6</span>]<span class="op">~</span><span class="er">~</span>pi[<span class="dv">7</span>])</a>
<a class="sourceLine" id="cb1637-18" title="18"><span class="co"># </span></a>
<a class="sourceLine" id="cb1637-19" title="19">expr4 &lt;-<span class="st"> </span><span class="kw">bquote</span>(<span class="kw">paste</span>(<span class="st">&quot;Estimated&quot;</span> <span class="op">~</span><span class="er">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-20" title="20"><span class="st">                        </span><span class="kw">hat</span>(mu) <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-21" title="21"><span class="st">                        </span>.(<span class="kw">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="kw">mean</span>(x)))))</a>
<a class="sourceLine" id="cb1637-22" title="22"></a>
<a class="sourceLine" id="cb1637-23" title="23"><span class="kw">ggplot</span>(<span class="dt">data =</span> df_dummy) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-24" title="24"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-25" title="25"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-26" title="26"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">label =</span> expr1, </a>
<a class="sourceLine" id="cb1637-27" title="27">            <span class="dt">size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-28" title="28"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">-0.025</span>, <span class="dt">label =</span> expr2, </a>
<a class="sourceLine" id="cb1637-29" title="29">            <span class="dt">size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-30" title="30"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">-0.04</span>, </a>
<a class="sourceLine" id="cb1637-31" title="31">            <span class="dt">label =</span> <span class="st">&quot;y[i] == beta[0] + beta[1]~x + epsilon[i]&quot;</span>, </a>
<a class="sourceLine" id="cb1637-32" title="32">            <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="co"># 수식 내용이 문자열로 label 값으로 사용</span></a>
<a class="sourceLine" id="cb1637-33" title="33">            <span class="dt">size =</span> <span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1637-34" title="34"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">0.025</span>, <span class="dt">label =</span> expr3, </a>
<a class="sourceLine" id="cb1637-35" title="35">            <span class="dt">size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-36" title="36"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">0.04</span>, <span class="dt">label =</span> <span class="kw">deparse</span>(expr4), </a>
<a class="sourceLine" id="cb1637-37" title="37">            <span class="dt">parse =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb1637-38" title="38">            <span class="dt">size =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1637-39" title="39"></a>
<a class="sourceLine" id="cb1637-40" title="40"><span class="co">## ggplot 객체 저장</span></a>
<a class="sourceLine" id="cb1637-41" title="41"><span class="co"># ggsave(&quot;figures/ggplot-text-math.png&quot;, plot = last_plot())</span></a></code></pre></div>


<p><img src="figures/ggplot-text-math.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
<div id="geom-areas" class="section level3">
<h3><span class="header-section-number">5.4.7</span> Geoms: 면적 관련 geometrics</h3>
<ul>
<li><code>geom_ribbon()</code>: 각 <code>x</code> 값에 대해 <code>ymin</code>과 <code>ymax</code>로 정의된 간격을 면적으로 표시</li>
<li><code>geom_area()</code>: <code>geom_ribbon()</code>의 special csae 로 <code>ymin = 0</code>이고 <code>ymax</code> 대신 <code>y</code> 를 사용하여 면적 영역 표시</li>
</ul>

<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1638-1" title="1"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="st"> </span><span class="er">=</span><span class="st"> </span>기본 x, y에 대한 aesthetic 기본 mapping 이외</a>
<a class="sourceLine" id="cb1638-2" title="2">            범위를 지정하는 <span class="kw">ymin</span> (ymax), <span class="kw">xmin</span> (xmax) 지정 필수</a></code></pre></div>

<div id="geom-areas-example" class="section level4 unnumbered">
<h4>Examples</h4>
<ul>
<li><code>geom_ribbon()</code> 예시</li>
</ul>

<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1639-1" title="1"><span class="co"># gapminder 데이터셋</span></a>
<a class="sourceLine" id="cb1639-2" title="2">gapm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-3" title="3"><span class="st">  </span><span class="kw">filter</span>(iso <span class="op">==</span><span class="st"> &quot;KOR&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-4" title="4"><span class="st">  </span><span class="kw">select</span>(year, gdp_cap) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gdp_cap)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-6" title="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> gdp_cap <span class="op">-</span><span class="st"> </span><span class="dv">5000</span>, </a>
<a class="sourceLine" id="cb1639-7" title="7">                  <span class="dt">ymax =</span> gdp_cap <span class="op">+</span><span class="st"> </span><span class="dv">5000</span>), </a>
<a class="sourceLine" id="cb1639-8" title="8">              <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>, </a>
<a class="sourceLine" id="cb1639-9" title="9">              <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb1639-11" title="11">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-97-1.svg" width="768" /></p>

<ul>
<li>표준정규분포 밀도함수 곡선 아래 면적 표시(그림 <a href="low-level-graphic.html#fig:polygon-example">5.12</a> 참고)</li>
<li><span class="math inline">\(Z ~ \stackrel{i.i.d}{\sim} N(0, 1)\)</span> 라고 할 때 <span class="math inline">\(P(-1.2 &lt; Z &lt; 0.7)\)</span> 에 해당하는 영역과 확률값 표시</li>
</ul>

<div class="sourceCode" id="cb1640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1640-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb1640-2" title="2">z &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x)</a>
<a class="sourceLine" id="cb1640-3" title="3">df_norm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, z)</a>
<a class="sourceLine" id="cb1640-4" title="4">idx &lt;-<span class="st"> </span><span class="fl">-1.2</span> <span class="op">&lt;</span><span class="st"> </span>x  <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.7</span> <span class="co"># 해당 구간 index 설정</span></a>
<a class="sourceLine" id="cb1640-5" title="5">df_area &lt;-<span class="st"> </span>df_norm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-6" title="6"><span class="st">  </span><span class="kw">filter</span>(idx)</a>
<a class="sourceLine" id="cb1640-7" title="7">expr &lt;-<span class="st"> </span><span class="kw">bquote</span>(<span class="kw">P</span>({<span class="op">-</span><span class="fl">1.2</span> <span class="op">&lt;</span><span class="st"> </span>Z} <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.7</span> ) <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-8" title="8"><span class="st">                 </span>.(<span class="kw">sprintf</span>(<span class="st">&quot;%.3f&quot;</span>, <span class="kw">pnorm</span>(<span class="fl">0.7</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">1.2</span>))))</a>
<a class="sourceLine" id="cb1640-9" title="9"></a>
<a class="sourceLine" id="cb1640-10" title="10"><span class="co"># 각 geom 별로 다른 데이터 적용</span></a>
<a class="sourceLine" id="cb1640-11" title="11"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df_norm, </a>
<a class="sourceLine" id="cb1640-13" title="13">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> z), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-14" title="14"><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data =</span> df_area, </a>
<a class="sourceLine" id="cb1640-15" title="15">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> z), </a>
<a class="sourceLine" id="cb1640-16" title="16">            <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-17" title="17"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">-1</span>, <span class="dt">y =</span> <span class="fl">0.2</span>, </a>
<a class="sourceLine" id="cb1640-18" title="18">                <span class="co"># expr 이 3 행으로 구성되었기 때문에 paste로 collapse</span></a>
<a class="sourceLine" id="cb1640-19" title="19">                <span class="dt">label =</span> <span class="kw">paste</span>(<span class="kw">deparse</span>(expr), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)),</a>
<a class="sourceLine" id="cb1640-20" title="20">            <span class="dt">parse =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb1640-21" title="21">            <span class="dt">hjust =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-98-1.svg" width="768" /></p>

</div>
</div>
<div id="geom-statistics" class="section level3">
<h3><span class="header-section-number">5.4.8</span> Geoms: 통계 그래프 관련 geometrics</h3>
<p>다음 소개하는 그래프 함수는 기본적으로 <code>stat_*</code> 함수로 도출한 통계량을 바탕으로 그래프 생성</p>
<p>-<code>geom_histogram()</code>: <code>stat_bin()</code> (연속형 변수)를 사용한 히스토그램 생성</p>

<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1641-1" title="1"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="er">:</span><span class="st"> </span>하나의 변수를 x 또는 y에 대응</a>
<a class="sourceLine" id="cb1641-2" title="2"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1641-3" title="3"><span class="st">  </span><span class="op">-</span><span class="st"> </span>binwidth<span class="op">:</span><span class="st"> </span>히스토그램의 너비 조정. 결국 범주의 개수 조정</a>
<a class="sourceLine" id="cb1641-4" title="4">  <span class="op">-</span><span class="st"> </span>bins<span class="op">:</span><span class="st"> </span>히스토그램 생성 시 범주화 개수(기본값 =<span class="st"> </span><span class="dv">30</span>)</a></code></pre></div>

<div id="geom-hist-example" class="section level4 unnumbered">
<h4>geom_histogram 예시</h4>
<ul>
<li>히스토그램 인수 조정</li>
</ul>

<div class="sourceCode" id="cb1642"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1642-1" title="1"><span class="co"># diamonds 데이터셋</span></a>
<a class="sourceLine" id="cb1642-2" title="2">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> carat))</a>
<a class="sourceLine" id="cb1642-3" title="3">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1642-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;bins, binwidth = default&quot;</span>)</a>
<a class="sourceLine" id="cb1642-5" title="5">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1642-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;binwidth = 0.05&quot;</span>)</a>
<a class="sourceLine" id="cb1642-7" title="7">p3 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">150</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1642-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;bins = 150&quot;</span>)</a>
<a class="sourceLine" id="cb1642-9" title="9">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, <span class="kw">aes</span>(<span class="dt">y =</span> carat)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1642-10" title="10"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="co"># y 축 기준으로 히스토그램 생성</span></a>
<a class="sourceLine" id="cb1642-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Map to y (flipped)&quot;</span>)</a></code></pre></div>


<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-101-1.svg" width="864" /></p>

<ul>
<li>다중 집단 히스토그램</li>
</ul>

<div class="sourceCode" id="cb1644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1644-1" title="1"><span class="co"># iris 데이터셋. 변수: Sepal Length</span></a>
<a class="sourceLine" id="cb1644-2" title="2">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Petal.Length))</a>
<a class="sourceLine" id="cb1644-3" title="3">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Species), </a>
<a class="sourceLine" id="cb1644-5" title="5">                 <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb1644-6" title="6">                 <span class="dt">bins =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb1644-7" title="7">                 <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: Histograms of petal length: frequency&quot;</span>)</a>
<a class="sourceLine" id="cb1644-9" title="9"></a>
<a class="sourceLine" id="cb1644-10" title="10">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-11" title="11"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Species, </a>
<a class="sourceLine" id="cb1644-12" title="12">                     <span class="dt">y =</span> ..density..), <span class="co"># y축을 밀도로 변경</span></a>
<a class="sourceLine" id="cb1644-13" title="13">                 <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="co"># 막대 테두리선 지정</span></a>
<a class="sourceLine" id="cb1644-14" title="14">                 <span class="dt">alpha =</span> <span class="fl">0.2</span>, </a>
<a class="sourceLine" id="cb1644-15" title="15">                 <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb1644-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: Histograms of petal length: density&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-103-1.svg" width="960" /></p>

<p>-<code>geom_density()</code>: 막대 형태의 히스토그램을 부드러운(smoothed) 선(여기서 y 값은 밀도임)으로 나타낸 곡선으로, 커널 밀도 추정(kernel density estimate)을 통해 밀도 곡선 추정</p>

<div class="sourceCode" id="cb1645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1645-1" title="1"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span><span class="er">:</span><span class="st"> </span>커널 밀도를 추정할 변수 (x 또는 y)</a>
<a class="sourceLine" id="cb1645-2" title="2"></a>
<a class="sourceLine" id="cb1645-3" title="3"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1645-4" title="4"><span class="st">   </span><span class="op">-</span><span class="st"> </span>adjust<span class="op">:</span><span class="st"> </span>커널 함수의 복잡도 조정(수치형 값 입력)</a></code></pre></div>


<div class="sourceCode" id="cb1646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1646-1" title="1"><span class="co"># geom_histogram() 예시 이어서</span></a>
<a class="sourceLine" id="cb1646-2" title="2"><span class="co"># dataset: iris</span></a>
<a class="sourceLine" id="cb1646-3" title="3"></a>
<a class="sourceLine" id="cb1646-4" title="4">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-5" title="5"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: Basic geom_density()&quot;</span>)</a>
<a class="sourceLine" id="cb1646-7" title="7"></a>
<a class="sourceLine" id="cb1646-8" title="8">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-9" title="9"><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: geom_density(aes(color = Species))&quot;</span>)</a>
<a class="sourceLine" id="cb1646-11" title="11"></a>
<a class="sourceLine" id="cb1646-12" title="12">p3 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-13" title="13"><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Species, </a>
<a class="sourceLine" id="cb1646-14" title="14">                   <span class="dt">color =</span> Species), </a>
<a class="sourceLine" id="cb1646-15" title="15">               <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p3: geom_density(aes(color = Species))&quot;</span>)</a>
<a class="sourceLine" id="cb1646-17" title="17">p4 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-18" title="18"><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Species, </a>
<a class="sourceLine" id="cb1646-19" title="19">                   <span class="dt">color =</span> Species), </a>
<a class="sourceLine" id="cb1646-20" title="20">               <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-21" title="21"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density.., <span class="co"># 밀도로 변환 필요</span></a>
<a class="sourceLine" id="cb1646-22" title="22">                     <span class="dt">fill =</span> Species), </a>
<a class="sourceLine" id="cb1646-23" title="23">                 <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb1646-24" title="24">                 <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb1646-25" title="25">                 <span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1646-26" title="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p4: Overlaying multiple histograms with multiple densities&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-106-1.svg" width="1152" /></p>

<p>-<code>geom_boxplot()</code>: R 기본 그래픽스 함수 <code>boxplot()</code>과 유사. <code>stat_boxplot()</code> 함수의 결과값을 기반으로 그래프 도출</p>

<div class="sourceCode" id="cb1647"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1647-1" title="1"><span class="op">&lt;</span>MAPPING<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1647-2" title="2"><span class="st">  </span><span class="op">-</span><span class="st"> </span>x<span class="op">:</span><span class="st"> </span>이산형(discrete) 변수를 x에 대한 aesthetic으로 mapping</a>
<a class="sourceLine" id="cb1647-3" title="3">  <span class="op">-</span><span class="st"> </span>y<span class="op">:</span><span class="st"> </span>상자그림으로 표현할 변수</a>
<a class="sourceLine" id="cb1647-4" title="4"></a>
<a class="sourceLine" id="cb1647-5" title="5"><span class="op">&lt;</span>ARGUMENTS<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1647-6" title="6"><span class="st">  </span><span class="op">-</span><span class="st"> </span>outlier.<span class="op">*</span><span class="er">:</span><span class="st"> </span>outlier의 aesthetic 조정 (<span class="op">*</span><span class="er">=</span>color, fill, shape, size, ...)</a>
<a class="sourceLine" id="cb1647-7" title="7">  <span class="op">-</span><span class="st"> </span>width<span class="op">:</span><span class="st"> </span>상자의 너비 조정</a>
<a class="sourceLine" id="cb1647-8" title="8">  <span class="op">-</span><span class="st"> </span>varwidth<span class="op">:</span><span class="st"> </span>논리값. 상자의 크기를 <span class="kw">sqrt</span>(n)에 비례하여 조정</a></code></pre></div>


<div class="sourceCode" id="cb1648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1648-1" title="1"><span class="co"># diamond 데이터 셋</span></a>
<a class="sourceLine" id="cb1648-2" title="2"><span class="co">## cut 범주에 따른 carat의 분포</span></a>
<a class="sourceLine" id="cb1648-3" title="3"></a>
<a class="sourceLine" id="cb1648-4" title="4">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, </a>
<a class="sourceLine" id="cb1648-5" title="5">             <span class="kw">aes</span>(<span class="dt">y =</span> carat))</a>
<a class="sourceLine" id="cb1648-6" title="6">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1648-7" title="7"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="co"># 디폴트 상자 그림</span></a>
<a class="sourceLine" id="cb1648-8" title="8"></a>
<a class="sourceLine" id="cb1648-9" title="9">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1648-10" title="10"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, </a>
<a class="sourceLine" id="cb1648-11" title="11">                   <span class="dt">fill =</span> cut))</a>
<a class="sourceLine" id="cb1648-12" title="12"></a>
<a class="sourceLine" id="cb1648-13" title="13">p3 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1648-14" title="14"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, </a>
<a class="sourceLine" id="cb1648-15" title="15">                   <span class="dt">fill =</span> cut), </a>
<a class="sourceLine" id="cb1648-16" title="16">               <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="co"># 상자 크기 조정</span></a>
<a class="sourceLine" id="cb1648-17" title="17"></a>
<a class="sourceLine" id="cb1648-18" title="18">p4 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1648-19" title="19"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, </a>
<a class="sourceLine" id="cb1648-20" title="20"><span class="co"># aesthetic에 x 이외의 factor가 추가된 경우 자동으로 dodge                   </span></a>
<a class="sourceLine" id="cb1648-21" title="21">                   <span class="dt">fill =</span> color), </a>
<a class="sourceLine" id="cb1648-22" title="22">               <span class="co"># outlier 표시 모양 및 색상 지정</span></a>
<a class="sourceLine" id="cb1648-23" title="23">               <span class="dt">outlier.shape =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb1648-24" title="24">               <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-109-1.svg" width="1344" /></p>

<ul>
<li><code>geom_boxplot()</code> + <code>geom_jitter()</code> 콜라보레이션</li>
</ul>

<div class="sourceCode" id="cb1649"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1649-1" title="1"><span class="co"># mpg 데이터셋</span></a>
<a class="sourceLine" id="cb1649-2" title="2">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> cty)</a>
<a class="sourceLine" id="cb1649-4" title="4"></a>
<a class="sourceLine" id="cb1649-5" title="5">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> class), </a>
<a class="sourceLine" id="cb1649-7" title="7">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb1649-8" title="8">               <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># 이상치 표시하지 않음</span></a>
<a class="sourceLine" id="cb1649-9" title="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> class), </a>
<a class="sourceLine" id="cb1649-10" title="10">              <span class="dt">alpha =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb1649-11" title="11">              <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: boxplot with jittered data points per each class (unordered)&quot;</span>)</a>
<a class="sourceLine" id="cb1649-13" title="13"></a>
<a class="sourceLine" id="cb1649-14" title="14">p2 &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-15" title="15"><span class="st">  </span><span class="co"># stats::reorder() 함수를 이용해 특정 통계량 기준으로 데이터 정렬 가능</span></a>
<a class="sourceLine" id="cb1649-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">class =</span> <span class="kw">reorder</span>(class, cty, median)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-17" title="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">y =</span> cty)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-18" title="18"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> class), </a>
<a class="sourceLine" id="cb1649-19" title="19">               <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb1649-20" title="20">               <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-21" title="21"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> class), </a>
<a class="sourceLine" id="cb1649-22" title="22">              <span class="dt">alpha =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb1649-23" title="23">              <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1649-24" title="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: ordered by median of cty for each car class&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-111-1.svg" width="1152" /></p>

<p>-<code>geom_smooth()</code>: x-y 관계에 대한 패턴을 도식화하기 위한 그래프로 아래와 같은 방법(<code>method</code>)을 이용해 추세선과 추정 직선의 오차 그래프 출력</p>
<ul>
<li>선형 회귀 곡선(linear model, <code>lm</code>)
<ul>
<li>일반화 선형 모형(generalized linear model, <code>glm</code>)</li>
<li>국소 다항 회귀 곡선(locally estimated scatterplot smoothing, <code>loess</code>)</li>
<li>generalized addictive model (GAM, <code>gam</code>)</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1650-1" title="1">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-2" title="2"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)</a>
<a class="sourceLine" id="cb1650-3" title="3"></a>
<a class="sourceLine" id="cb1650-4" title="4">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p1: geom_smooth() default&quot;</span>)</a>
<a class="sourceLine" id="cb1650-8" title="8"></a>
<a class="sourceLine" id="cb1650-9" title="9">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color), </a>
<a class="sourceLine" id="cb1650-11" title="11">             <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-12" title="12"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p2: geom_smooth() for different color groups&quot;</span>)</a>
<a class="sourceLine" id="cb1650-14" title="14"></a>
<a class="sourceLine" id="cb1650-15" title="15">p3 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-16" title="16"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color), </a>
<a class="sourceLine" id="cb1650-17" title="17">             <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-18" title="18"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color), </a>
<a class="sourceLine" id="cb1650-19" title="19">              <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="co"># 표준오차 영역 삭제</span></a>
<a class="sourceLine" id="cb1650-20" title="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p3: geom_smooth() without the SE region&quot;</span>)</a>
<a class="sourceLine" id="cb1650-21" title="21"></a>
<a class="sourceLine" id="cb1650-22" title="22">p4 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-23" title="23"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color), </a>
<a class="sourceLine" id="cb1650-24" title="24">             <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-25" title="25"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> color), </a>
<a class="sourceLine" id="cb1650-26" title="26">              <span class="dt">se =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb1650-27" title="27"><span class="co"># 선형 회귀 곡선을 추세선으로 사용</span></a>
<a class="sourceLine" id="cb1650-28" title="28">              <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-29" title="29"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;p4: geom_smooth() using the linear regression curve&quot;</span>)  </a></code></pre></div>


<pre><code>`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;
`geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-113-1.svg" width="1152" /></p>

</div>
</div>
<div id="scale-x-y" class="section level3">
<h3><span class="header-section-number">5.4.9</span> Scales: x-y 축 관련 aesthetic 조정</h3>
<ul>
<li><code>scale_x_*</code>, <code>scale_y_*</code>: x-y 축의 범위, plot 상 눈금선, 축 제목 등을 조정
<ul>
<li><code>xlim()</code>, <code>ylim()</code>: <code>scale_x_*</code>, <code>scale_y_*</code>의 특별한 케이스로 x-y 축의 범위 조정</li>
</ul></li>
</ul>
</div>
<div id="scale-colors-fill" class="section level3">
<h3><span class="header-section-number">5.4.10</span> Scales: 색상 관련 aesthetic 조정</h3>
<ul>
<li><code>scale_color_*</code>, <code>scale_fill_*</code>: <code>aes()</code>에 color 또는 fill이 정의된 경우, 기본 색상 변경 가능</li>
<li>색상 조정은 palette를 통해 가능하며, 색상 파레트를 사용할 경우 <code>scale_*_brewer()</code>를 통해 palette 설정 가능</li>
<li>RColorBrewer 패키지 설치 시 보다 다양한 palette 사용 가능</li>
</ul>
</div>
<div id="scale-size-line-shape" class="section level3">
<h3><span class="header-section-number">5.4.11</span> Scales: 크기, 선 종류, 점 모양 aesthetic 조정</h3>
<ul>
<li><code>scale_size_*</code>: size에 대한 세부적인 값 지정 가능</li>
<li><code>scale_shape_*</code>: shape가 aes() 함수에 사용된 경우, shape에 대한 세부 값(점 모양, 크기, 색 등 지정 가능)</li>
<li><code>scale_linetype_*</code>: linetype이 aes() 함수에 사용된 경우, linetype에 대한 세부 값(선 종류, 굵기 등 조정 가능)</li>
</ul>
<div id="scale_size_-예시" class="section level4">
<h4><span class="header-section-number">5.4.11.1</span> scale_size_* 예시</h4>

<div class="sourceCode" id="cb1653"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1653-1" title="1">gppoint <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1653-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> population, </a>
<a class="sourceLine" id="cb1653-3" title="3">                 <span class="dt">color =</span> continent), </a>
<a class="sourceLine" id="cb1653-4" title="4">             <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1653-5" title="5"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>))</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-114-1.svg" width="672" /></p>

</div>
</div>
<div id="coordinate-systems" class="section level3">
<h3><span class="header-section-number">5.4.12</span> Coordinate systems</h3>
<ul>
<li><code>coord_flip()</code>: x-y 축 뒤집기</li>
</ul>

<div class="sourceCode" id="cb1654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1654-1" title="1">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, </a>
<a class="sourceLine" id="cb1654-2" title="2">             <span class="kw">aes</span>(<span class="dt">y =</span> carat))</a>
<a class="sourceLine" id="cb1654-3" title="3">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> color, </a>
<a class="sourceLine" id="cb1654-4" title="4">                   <span class="dt">fill =</span> color), </a>
<a class="sourceLine" id="cb1654-5" title="5">               <span class="dt">width =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb1654-6" title="6">p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1654-7" title="7"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>


<div class="sourceCode" id="cb1655"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1655-1" title="1"><span class="kw">ggarrange</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-116-1.svg" width="1056" /></p>

</div>
<div id="guides-x-y-축-및-그래프-제목-관련" class="section level3">
<h3><span class="header-section-number">5.4.13</span> Guides: x-y 축 및 그래프 제목 관련</h3>
<ul>
<li><code>labs()</code>: x-y 축 제목, 부제목, 캡션 조정
<ul>
<li><code>xlab()</code>, <code>ylab()</code>, <code>ggtitle()</code>: <code>labs()</code>의 조정 인수를 개별 함수로 구현</li>
</ul></li>
<li><code>guide_legend()</code>: <code>guides()</code> 함수 내부에서 사용되며, 범례 영역 조정하기 위한 함수
<ul>
<li>이미 정의한 aesthetic에 대한 범례 영역의 세부 속성을 변경하고 싶은 경우 <code>overrride.aes</code> 인수 조정(입력값은 리스트)</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1656-1" title="1"><span class="co"># gap-minder 데이터 </span></a>
<a class="sourceLine" id="cb1656-2" title="2">gapm &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dataset/gapminder/gapminder_filter.csv&quot;</span>)</a></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  iso = col_character(),
  country = col_character(),
  region = col_character(),
  year = col_double(),
  population = col_double(),
  life_expectancy = col_double(),
  gdp_cap = col_double()
)</code></pre>
<div class="sourceCode" id="cb1658"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1658-1" title="1">gapm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">gsub</span>(<span class="st">&quot;(.+</span><span class="ch">\\</span><span class="st">s)&quot;</span>, <span class="st">&quot;&quot;</span>, region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-3" title="3"><span class="st">           </span>factor) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-4" title="4"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> life_expectancy, <span class="dt">y =</span> gdp_cap)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> population, </a>
<a class="sourceLine" id="cb1658-7" title="7">                 <span class="dt">color =</span> continent), </a>
<a class="sourceLine" id="cb1658-8" title="8">             <span class="dt">alpha =</span> <span class="fl">0.3</span>) -&gt;<span class="st"> </span>p1</a>
<a class="sourceLine" id="cb1658-9" title="9"></a>
<a class="sourceLine" id="cb1658-10" title="10">p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-11" title="11"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">size =</span> <span class="ot">FALSE</span>, <span class="co"># size 관련 guide(범례는 출력하지 않음)</span></a>
<a class="sourceLine" id="cb1658-12" title="12">         <span class="dt">color =</span> <span class="kw">guide_legend</span>(</a>
<a class="sourceLine" id="cb1658-13" title="13">           <span class="dt">title =</span> <span class="st">&quot;Contient&quot;</span>, <span class="co"># 범례 제목 변경</span></a>
<a class="sourceLine" id="cb1658-14" title="14">           <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="co"># 범례 제목 폰트 굵은체</span></a>
<a class="sourceLine" id="cb1658-15" title="15">           <span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">5</span>) <span class="co"># 범례 표시 점의 크기를 5로</span></a>
<a class="sourceLine" id="cb1658-16" title="16">         )) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1658-17" title="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="co"># 범례 위치를 맨 위로 조정</span></a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-118-1.svg" width="1152" /></p>

</div>
<div id="facets-국소-시각화-기법" class="section level3">
<h3><span class="header-section-number">5.4.14</span> Facets: 국소 시각화 기법</h3>
<ul>
<li><code>facet_grid()</code>: 행과 열에 대한 facet (면 또는 패널)을 정의한 변수에 의해 패널 행렬을 구성한 그래프로 두 개 이상의 범주형(이산) 변수가 있고 변수의 모든 조합이 데이터에 존제하는 경우 유용</li>
</ul>

<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1659-1" title="1"><span class="kw">facet_grid</span>(<span class="op">&lt;</span>ROW VARIABLE<span class="op">&gt;</span><span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="er">&lt;</span>COLUMN VARIABLE<span class="op">&gt;</span>, ...)</a></code></pre></div>

<ul>
<li><code>facet_wrap()</code>: 1차원 패널을 2차원으로 변환. 일반적으로 <code>facet_grid()</code> 보다 화면 분할이 효율적이고, 서로 다른 단위로 측정된 변수를 패널 형태로 출력하고자 할 때 데이터를 long format으로 변환 후 적용</li>
</ul>

<div class="sourceCode" id="cb1660"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1660-1" title="1"><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span><span class="er">&lt;</span>DISCRETE VARIABLE<span class="op">&gt;</span>, </a>
<a class="sourceLine" id="cb1660-2" title="2">           <span class="dt">ncol =</span> n,  <span class="co"># 열 개수</span></a>
<a class="sourceLine" id="cb1660-3" title="3">           <span class="dt">nrow =</span> m,  <span class="co"># 행 개수</span></a>
<a class="sourceLine" id="cb1660-4" title="4">           scale<span class="op">:</span><span class="st"> </span>x, y 스케일</a>
<a class="sourceLine" id="cb1660-5" title="5">                  <span class="st">&quot;fixed&quot;</span><span class="op">:</span><span class="st"> </span>x<span class="op">-</span>y 스케일을 모든 패널에 동일하게 고정</a>
<a class="sourceLine" id="cb1660-6" title="6">                  <span class="st">&quot;free&quot;</span><span class="op">:</span><span class="st"> </span>x<span class="op">-</span>y 모두 각 panel에 맞게 조정</a>
<a class="sourceLine" id="cb1660-7" title="7">                  <span class="st">&quot;free_x&quot;</span><span class="op">:</span><span class="st"> </span>y의 스케일은 모든 고정하고 x 만 각 페널에 맞게 조정</a>
<a class="sourceLine" id="cb1660-8" title="8">                  <span class="st">&quot;free_y&quot;</span><span class="op">:</span><span class="st"> </span>x의 스케일은 모든 고정하고 y 만 각 페널에 맞게 조정</a>
<a class="sourceLine" id="cb1660-9" title="9">           )</a></code></pre></div>


<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1661-1" title="1"><span class="co"># mpg 데이터 셋</span></a>
<a class="sourceLine" id="cb1661-2" title="2">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1661-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)</a>
<a class="sourceLine" id="cb1661-4" title="4"></a>
<a class="sourceLine" id="cb1661-5" title="5"><span class="co"># class 별 displ vs. hwy 산점도</span></a>
<a class="sourceLine" id="cb1661-6" title="6">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1661-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1661-8" title="8"><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>class)</a>
<a class="sourceLine" id="cb1661-9" title="9">p1</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-121-1.svg" width="1152" /></p>

<ul>
<li><code>cyl</code>을 행, <code>class</code>를 열로 사용하여 <code>cyl</code>과 <code>class</code>의 수준 조합 별 산점도 출력</li>
</ul>

<div class="sourceCode" id="cb1662"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1662-1" title="1">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1662-2" title="2"><span class="st">  </span><span class="co"># 모든 facet에 동일한 데이터를 표현하려면 </span></a>
<a class="sourceLine" id="cb1662-3" title="3"><span class="st">  </span><span class="co">#  geom 내부에서 데이터를 재정의</span></a>
<a class="sourceLine" id="cb1662-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>class, <span class="op">-</span>cyl), </a>
<a class="sourceLine" id="cb1662-5" title="5">             <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1662-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1662-7" title="7"><span class="st">  </span><span class="kw">facet_grid</span>(cyl <span class="op">~</span><span class="st"> </span>class)</a>
<a class="sourceLine" id="cb1662-8" title="8">p2</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-122-1.svg" width="1152" /></p>

<ul>
<li><code>facet_wrap()</code>을 이용한 다변수 패널 도표</li>
</ul>

<div class="sourceCode" id="cb1663"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1663-1" title="1"><span class="co"># economics_long 데이터셋</span></a>
<a class="sourceLine" id="cb1663-2" title="2"><span class="kw">glimpse</span>(economics_long)</a></code></pre></div>
<pre><code>Rows: 2,870
Columns: 4
$ date     &lt;date&gt; 1967-07-01, 1967-08-01, 1967-09-01, 1967-10-01, 1967-11-0...
$ variable &lt;chr&gt; &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;pce&quot;, &quot;p...
$ value    &lt;dbl&gt; 506.7, 509.8, 515.6, 512.2, 517.4, 525.1, 530.9, 533.6, 54...
$ value01  &lt;dbl&gt; 0.0000000000, 0.0002652497, 0.0007615234, 0.0004706043, 0....</code></pre>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1665-1" title="1">economics_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">factor</span>(variable, </a>
<a class="sourceLine" id="cb1665-3" title="3">                           <span class="dt">levels =</span> <span class="kw">unique</span>(variable), </a>
<a class="sourceLine" id="cb1665-4" title="4">                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Personal consumption expenditures&quot;</span>, </a>
<a class="sourceLine" id="cb1665-5" title="5">                                      <span class="st">&quot;Total population&quot;</span>, </a>
<a class="sourceLine" id="cb1665-6" title="6">                                      <span class="st">&quot;Personal saving rates&quot;</span>, </a>
<a class="sourceLine" id="cb1665-7" title="7">                                      <span class="st">&quot;Median duration of unemployment&quot;</span>, </a>
<a class="sourceLine" id="cb1665-8" title="8">                                      <span class="st">&quot;# of unemployed in thausand&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-11" title="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">nrow =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb1665-12" title="12">             <span class="dt">scale =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-13" title="13"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb1665-14" title="14">    <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb1665-15" title="15">    <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1665-16" title="16">                              <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)</a>
<a class="sourceLine" id="cb1665-17" title="17">  )</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-123-1.svg" width="1152" /></p>



<div class="rmdtip">
<p>두 개 이상의 ggplot 객체를 한 화면에 출력하고자 할 때(R 기본 그래픽스에서 <code>par(mfrow = c(n, m))</code>와 유사하게), 별도의 패키지(예: gridExtra, ggpubr, cowplot 패키지 등)가 요구됨. 이 중 가장 사용하기 용이한 패키지와 함수는 <code>ggubr::ggarrange()</code> 임.</p>
</div>


</div>
<div id="themes" class="section level3">
<h3><span class="header-section-number">5.4.15</span> Themes</h3>
<ul>
<li><code>theme()</code>: ggplot의 결과에서 비데이터(non-data)적 요소(예: 제목, 레이블, 글꼴, 배경, 눈금선, 범례)를 조정하기 위한 함수로 출력 그래프의 전반적인 형태를 정의함.</li>
<li><code>theme()</code>을 이용한 비데이터적 요소는 다음의 4 가지 속성을 가짐
<ul>
<li><strong>line</strong>: 모든 선 구성 요소(x-y 축선, 눈금선, 보조선 등) <span class="math inline">\(\rightarrow\)</span> <code>element_line()</code></li>
<li><strong>rect</strong>: 모든 사각형 구성 요소(facet strips, 범례, 배경 등) <span class="math inline">\(\rightarrow\)</span> <code>element_rect()</code></li>
<li><strong>text</strong>: 모든 텍스트 구성 요소(눈금선 레이블, 범례 표시 텍스트, …) <span class="math inline">\(\rightarrow\)</span> <code>element_text()</code></li>
<li><strong>title</strong>: 모든 제목 요소(plot, 축, 범례 등) <span class="math inline">\(\rightarrow\)</span> <code>element_text()</code></li>
</ul></li>
<li><strong><code>element_blank()</code></strong>: 특정 요소를 없앨 때 사용</li>
</ul>
<p><strong>&lt;<code>element_text()</code>&gt;</strong></p>
<ul>
<li><strong>axis.title</strong>: ggplot에 표현된 모든 축의 제목 조정(크기, 폰트 등)
<ul>
<li><strong>axis.title.x</strong>, <strong>axis.title.y</strong>: x, y 축 각각의 제목 조정</li>
</ul></li>
<li><strong>axis.text</strong>: 모든 축의 눈금 레이블 크기 폰트 등 조정
<ul>
<li><strong>axis.text.x</strong>, <strong>axis.text.y</strong>: x, y 축 각각의 눈금선 레이블 조정</li>
</ul></li>
<li>legend.text: 범례표시의 텍스트 조정</li>
<li>legend.title: 범례 제목 조정</li>
<li><strong>plot.title</strong>, plot.subtitle, plot.caption: ggplot 제목, 부제목, 캡션 텍스트 조정</li>
<li><strong>strip.text</strong>: facet 레이블 텍스트 조정
<ul>
<li><strong>strip.text.x</strong>, <strong>strip.text.y</strong></li>
</ul></li>
</ul>
<p><strong>&lt;<code>element_line()</code>&gt;</strong>: 선과 관련된 모든 요소 조정</p>
<ul>
<li><strong>axis.ticks</strong>: 모든 눈금선 조정
<ul>
<li><strong>axis.ticks.x</strong>, <strong>axis.ticks.y</strong>: x, y 축 각각의 눈금선 조정</li>
</ul></li>
<li><strong>axis.line</strong>: 모든 axis 선 설정 조정
<ul>
<li><strong>axis.line.x</strong>, <strong>axis.line.y</strong>:</li>
</ul></li>
<li><strong>panel.grid</strong>: plot 내 주(major) 또는 보조(minor) 격자선 조정
<ul>
<li><strong>panel.grid.minor</strong>, <strong>panel.grid.minor.x</strong>, <strong>panel.grid.minor.y</strong></li>
<li><strong>panel.grid.major</strong>, <strong>panel.grid.major.x</strong>, <strong>panel.grid.major.y</strong></li>
</ul></li>
</ul>
<p><strong>&lt;<code>element_rect()</code>&gt;</strong>: plot 배경 및 범례 배경 및 표시 상자 설정</p>
<p><strong>기타</strong></p>
<ul>
<li><strong>legend.position</strong>: 범례 위치 조정
<ul>
<li>“none”, “left”, “right”, “bottom”, “top” 과 같은 문자열 값 또는 좌표의 상대적 위치(0에서 1사이 값)을 나타내는 2차원 벡터 값을 가짐</li>
</ul></li>
<li><strong>legend.direction</strong>: 범례 표시 방향 설정
<ul>
<li>“horizontal” (수평) 또는 “vertical” (수직)</li>
</ul></li>
</ul>


<div class="rmdnote">
<p><strong><code>theme()</code></strong> 함수를 이용한 그래프 조정 옵션은 <code>help(theme)</code> 또는 <a href="https://ggplot2.tidyverse.org/reference/theme.html">ggplot2 공식 메뉴얼</a> 또는 <a href="http://www.sthda.com/english/wiki/ggplot2-themes-and-background-colors-the-3-elements">Statistical tools for high-throughput data analysis</a>를 참고</p>
</div>


<div id="theme-complete" class="section level4 unnumbered">
<h4>가능한 완성 theme</h4>
<ul>
<li>ggplot2 패키지 제공 theme
<ul>
<li><code>theme_grey()</code></li>
<li><code>theme_bw()</code></li>
<li><code>theme_light()</code></li>
<li><code>theme_minimal()</code></li>
<li><code>theme_classic()</code></li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1666"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1666-1" title="1">p0 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, mpg)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1666-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() </a>
<a class="sourceLine" id="cb1666-3" title="3"></a>
<a class="sourceLine" id="cb1666-4" title="4">p1 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_grey</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_grey() (default)&quot;</span>)</a>
<a class="sourceLine" id="cb1666-6" title="6"></a>
<a class="sourceLine" id="cb1666-7" title="7">p2 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_bw()&quot;</span>)</a>
<a class="sourceLine" id="cb1666-9" title="9"></a>
<a class="sourceLine" id="cb1666-10" title="10">p3 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_light()&quot;</span>)</a>
<a class="sourceLine" id="cb1666-12" title="12"></a>
<a class="sourceLine" id="cb1666-13" title="13">p4 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_minimal()&quot;</span>)</a>
<a class="sourceLine" id="cb1666-15" title="15"></a>
<a class="sourceLine" id="cb1666-16" title="16">p5 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_classic()&quot;</span>)</a>
<a class="sourceLine" id="cb1666-18" title="18"></a>
<a class="sourceLine" id="cb1666-19" title="19">p6 &lt;-<span class="st"> </span>p0 <span class="op">+</span><span class="st"> </span><span class="kw">theme_linedraw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1666-20" title="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Basic theme: theme_linedraw()&quot;</span>)</a></code></pre></div>


<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-127-1.svg" width="960" /></p>



<div class="rmdtip">
<p>**ggplot 관련 알아두면 유용한 팁</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html">ggplot2</a>는 ggplot2에 포함된 모든 함수에 대한 메뉴얼을 제공</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">r-statistics.co</a>에서 ggplot 예시 확인 가능</li>
<li>ggplot2 패키지에서 제공하는 기본 theme 외에 ggtheme, ggpubr 과 같은 패키지를 통해 보다 다양한 theme을 적용할 수 있음</li>
</ul>
</div>


</div>
</div>
<div id="ggplot-application" class="section level3">
<h3><span class="header-section-number">5.4.16</span> 확장 예제</h3>
<ul>
<li><a href="https://ourworldindata.org/">Our World in Data</a>에서 각 국가별 코로나 19 바이러스 통계 데이터 제공</li>
<li>감염자 및 사망자 수 통계는 하루 단위로 업데이트가 되고 있고, 각 국가별 검사 수는 일주일 단위로 업데이트</li>
</ul>
<p><strong>데이터 전처리</strong></p>
<ul>
<li>데이터 불러오기: <code>covid19-cases-20200601.txt</code>, <code>country_pubhealth.csv</code>, <code>country_info.txt</code></li>
</ul>

<div class="sourceCode" id="cb1667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1667-1" title="1">covid19 &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;dataset/covid-19-dataset/covid19-cases-20200601.txt&quot;</span>, </a>
<a class="sourceLine" id="cb1667-2" title="2">                      <span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  iso_code = col_character(),
  date = col_date(format = &quot;&quot;),
  total_cases = col_double(),
  new_cases = col_double(),
  total_deaths = col_double(),
  new_deaths = col_double(),
  total_tests = col_double(),
  new_tests = col_double(),
  new_tests_smoothed = col_double()
)</code></pre>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1669-1" title="1">country &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="st">&quot;dataset/covid-19-dataset/country_info.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb1669-2" title="2">country_pubhealth &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dataset/covid-19-dataset/country_pubhealth.csv&quot;</span>)</a></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  location = col_character(),
  cvd_death_rate = col_double(),
  diabetes_prevalence = col_double(),
  female_smokers = col_double(),
  male_smokers = col_double(),
  handwashing_facilities = col_double(),
  hospital_beds_per_100k = col_double()
)</code></pre>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1671-1" title="1"><span class="co"># glimpse(covid19); glimpse(country); </span></a>
<a class="sourceLine" id="cb1671-2" title="2"><span class="co"># glimpse(country_pubhealth)</span></a></code></pre></div>

<blockquote>
<p>데이터 코드북</p>
</blockquote>

<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Dataset"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Varialbe"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"country","2":"iso_code","3":"3자리 국가코드"},{"1":"country","2":"location","3":"국가명"},{"1":"country","2":"region","3":"지역"},{"1":"country","2":"population","3":"총인구수"},{"1":"country","2":"population_density","3":"인구밀도"},{"1":"country","2":"median_age","3":"중위연령"},{"1":"country","2":"aged_65_older","3":"65세 이상 인구수"},{"1":"country","2":"aged_70_older","3":"70세 이상 인구수"},{"1":"country","2":"gdp_per_capita","3":"일인당 국민소득"},{"1":"country","2":"extreme_poverty","3":"극빈층 비율"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Dataset"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"pubhealth","2":"location","3":"국가명"},{"1":"pubhealth","2":"cvd_death_rate","3":"심혈관계 질환 사망률"},{"1":"pubhealth","2":"diabetes_prevalence","3":"당뇨병 유병률"},{"1":"pubhealth","2":"female_smokers","3":"여성 흡연율"},{"1":"pubhealth","2":"male_smokers","3":"남성흡연율"},{"1":"pubhealth","2":"handwashing_facilities","3":"구내 세수시설 설치 비율"},{"1":"pubhealth","2":"hospital_beds_per_100k","3":"1000명 당 병상 수"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Dataset"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Description"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"covid19","2":"iso_code","3":"3자리 국가코드"},{"1":"covid19","2":"date","3":"조사일자"},{"1":"covid19","2":"total_cases","3":"누적(전체) 확진자"},{"1":"covid19","2":"new_cases","3":"신규 확진자 수"},{"1":"covid19","2":"total_deaths","3":"누적(전체) 사망자 수"},{"1":"covid19","2":"new_deaths","3":"신규사망자 수"},{"1":"covid19","2":"total_tests","3":"누적(전체) 검사 수"},{"1":"covid19","2":"new_tests","3":"신규 검사수"},{"1":"covid19","2":"new_tests_smoothed","3":"신규 검사 수(7일 이동평균 값)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

<div id="ggplot-data-preprocessing" class="section level4 unnumbered">
<h4>데이터 전처리</h4>
<ol style="list-style-type: decimal">
<li><strong>Filtering</strong>
<ul>
<li><code>covid19</code> 에서 <code>iso_code</code>가 “OWID_WRL”인 케이스 제외</li>
<li>2020년 3월 1일 부터 2020년 5월 31 일 까지 데이터만 추출</li>
</ul></li>
</ol>

<div class="sourceCode" id="cb1672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1672-1" title="1">covid19_full &lt;-<span class="st"> </span>covid19 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1672-2" title="2"><span class="st">  </span><span class="kw">filter</span>(iso_code <span class="op">!=</span><span class="st"> &quot;OWID_WRL&quot;</span>, </a>
<a class="sourceLine" id="cb1672-3" title="3">         date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2020-03-01&quot;</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb1672-4" title="4"><span class="st">           </span>date <span class="op">&lt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2020-05-31&quot;</span>)) </a>
<a class="sourceLine" id="cb1672-5" title="5"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="2" style="list-style-type: decimal">
<li><strong>Join</strong>: <code>covid19</code>를 기준으로 나머지 두 데이터셋(<code>country</code>, <code>country_pubhealth</code>) 결합</li>
</ol>

<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1673-1" title="1">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1673-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(country, <span class="dt">by =</span> <span class="st">&quot;iso_code&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#country의 siso_code와 공통 변수</span></a>
<a class="sourceLine" id="cb1673-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(country_pubhealth, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;location&quot;</span>)) <span class="co"># 공통 변수: location</span></a>
<a class="sourceLine" id="cb1673-4" title="4"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="3" style="list-style-type: decimal">
<li>대륙(continent) 변수 생성(<code>region</code> 변수를 활용해서)</li>
</ol>

<div class="sourceCode" id="cb1674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1674-1" title="1">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1674-2" title="2"><span class="st">  </span><span class="co"># 하나 이상의 어떤 문자와 공백을 포함한 문자열을 그룹화</span></a>
<a class="sourceLine" id="cb1674-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">gsub</span>(<span class="st">&quot;(.+</span><span class="ch">\\</span><span class="st">s)&quot;</span>, <span class="st">&quot;&quot;</span>, region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1674-4" title="4"><span class="st">           </span>factor) </a>
<a class="sourceLine" id="cb1674-5" title="5"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="4" style="list-style-type: decimal">
<li>케이스, 사망자 수 관련 변수를 이용해 100만명 당 확진자 수 및 사망자 수 계산(변수이름은 기존 변수명 마지막에 "_per_million"을 추가)</li>
</ol>

<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1675-1" title="1">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1675-2" title="2"><span class="st">    </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">matches</span>(<span class="st">&quot;cases|deaths&quot;</span>)), </a>
<a class="sourceLine" id="cb1675-3" title="3">          <span class="kw">list</span>(<span class="dt">per_million =</span><span class="op">~</span><span class="st"> </span>.<span class="op">/</span>population <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)) </a>
<a class="sourceLine" id="cb1675-4" title="4"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="5" style="list-style-type: decimal">
<li>2020년 5월 31일 기준 총 확진자 수가 2000 명 이상인 국가만 추출</li>
</ol>

<div class="sourceCode" id="cb1676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1676-1" title="1"><span class="co"># 각 국가별로 grouping을 한 후 total_case의 최댓값이 1000 명을 초과한 경우만 추출</span></a>
<a class="sourceLine" id="cb1676-2" title="2">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1676-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(location) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb1676-4" title="4"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">max</span>(total_cases) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1676-5" title="5"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="6" style="list-style-type: decimal">
<li>각 국가별 total_test 결측값 대체
<ul>
<li>최초 시점의 total_test가 결측인 경우 0으로 대체</li>
<li>기록 중 중간에 결측이 발생한 경우 이전 시점 값으로 대체</li>
</ul></li>
</ol>

<div class="sourceCode" id="cb1677"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1677-1" title="1"><span class="co"># 위에서 location 에 대한 grouping이 유지가 되고 있음</span></a>
<a class="sourceLine" id="cb1677-2" title="2"><span class="co"># 각 국가별 첫 번째 행이고 그 첫 번째 행이 결측이면 0 값을 대체하고</span></a>
<a class="sourceLine" id="cb1677-3" title="3"><span class="co"># 아니면 원래 관측값을 반환</span></a>
<a class="sourceLine" id="cb1677-4" title="4">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1677-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_tests =</span> <span class="kw">ifelse</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1677-6" title="6"><span class="co"># 첫 번째 값을 추출하기 위해 dplyr 제공 first() 함수 사용</span></a>
<a class="sourceLine" id="cb1677-7" title="7"><span class="st">                                </span><span class="kw">is.na</span>(<span class="kw">first</span>(total_tests)), </a>
<a class="sourceLine" id="cb1677-8" title="8">                              <span class="dv">0</span>, total_tests)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1677-9" title="9"><span class="co"># help(fill) 참고  </span></a>
<a class="sourceLine" id="cb1677-10" title="10"><span class="st">  </span><span class="kw">fill</span>(total_tests, <span class="dt">.direction =</span> <span class="st">&quot;down&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1677-11" title="11"><span class="st">  </span>ungroup </a>
<a class="sourceLine" id="cb1677-12" title="12"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="7" style="list-style-type: decimal">
<li>"_tests“가 포함된 변수들에 대해 인구 천 명당 검사 수 계산(변수이름은 기존 변수명 마지막에”_per_thousand"을 추가)</li>
</ol>

<div class="sourceCode" id="cb1678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1678-1" title="1"><span class="co"># 4 번과 유사</span></a>
<a class="sourceLine" id="cb1678-2" title="2">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1678-3" title="3"><span class="st">    </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;_tests&quot;</span>)),</a>
<a class="sourceLine" id="cb1678-4" title="4">                 <span class="kw">list</span>(<span class="dt">per_thousand =</span> <span class="op">~</span><span class="st"> </span>.<span class="op">/</span>population <span class="op">*</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1678-5" title="5"><span class="co"># glimpse(covid19_full)</span></a></code></pre></div>

<ol start="8" style="list-style-type: decimal">
<li><code>iso_code</code>, <code>date</code>, <code>location</code>, <code>continent</code>, <code>population</code>, 그리고 “case”, “deaths”, “tests”가 포함된 변수 선택</li>
</ol>

<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1679-1" title="1">covid19_full &lt;-<span class="st"> </span>covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1679-2" title="2"><span class="st">  </span><span class="kw">select</span>(iso_code<span class="op">:</span>date, location, continent, population, </a>
<a class="sourceLine" id="cb1679-3" title="3">         <span class="kw">matches</span>(<span class="st">&quot;cases|deaths|tests&quot;</span>))</a>
<a class="sourceLine" id="cb1679-4" title="4"><span class="kw">glimpse</span>(covid19_full)</a></code></pre></div>
<pre><code>Rows: 9,733
Columns: 19
$ iso_code                        &lt;chr&gt; &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, &quot;AFG&quot;, ...
$ date                            &lt;date&gt; 2020-03-01, 2020-03-02, 2020-03-08...
$ location                        &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afgh...
$ continent                       &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia,...
$ population                      &lt;dbl&gt; 38928341, 38928341, 38928341, 38928...
$ total_cases                     &lt;dbl&gt; 1, 1, 4, 7, 10, 16, 21, 22, 22, 22,...
$ new_cases                       &lt;dbl&gt; 0, 0, 3, 3, 3, 6, 5, 1, 0, 0, 2, 0,...
$ total_deaths                    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ new_deaths                      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ total_tests                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ new_tests                       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...
$ new_tests_smoothed              &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...
$ total_cases_per_million         &lt;dbl&gt; 0.02568823, 0.02568823, 0.10275290,...
$ new_cases_per_million           &lt;dbl&gt; 0.00000000, 0.00000000, 0.07706468,...
$ total_deaths_per_million        &lt;dbl&gt; 0.00000000, 0.00000000, 0.00000000,...
$ new_deaths_per_million          &lt;dbl&gt; 0.00000000, 0.00000000, 0.00000000,...
$ total_tests_per_thousand        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ new_tests_per_thousand          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...
$ new_tests_smoothed_per_thousand &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...</code></pre>

</div>
<div id="covid-19-visualization" class="section level4 unnumbered">
<h4>시각화</h4>
<ol style="list-style-type: decimal">
<li>대륙별 일별 일일 확진자 수(<code>new_case</code> 기준)에 대한 시각화</li>
</ol>

<div class="sourceCode" id="cb1681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1681-1" title="1"><span class="kw">Sys.setlocale</span>(<span class="st">&quot;LC_TIME&quot;</span>, <span class="st">&quot;english&quot;</span>)</a></code></pre></div>
<pre><code>[1] &quot;English_United States.1252&quot;</code></pre>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1683-1" title="1">covid19_full <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1683-2" title="2"><span class="st">  </span>ungroup <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1683-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(continent, date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1683-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">confirm_case_date =</span> <span class="kw">sum</span>(new_cases)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1683-5" title="5"><span class="st">  </span>ungroup <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1683-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-7" title="7"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> confirm_case_date,</a>
<a class="sourceLine" id="cb1683-8" title="8">               <span class="dt">fill =</span> continent,</a>
<a class="sourceLine" id="cb1683-9" title="9">               <span class="dt">alpha =</span> continent),</a>
<a class="sourceLine" id="cb1683-10" title="10">           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb1683-11" title="11">           <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb1683-12" title="12">           <span class="co"># color = &quot;white&quot;</span></a>
<a class="sourceLine" id="cb1683-13" title="13">           <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-14" title="14"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-15" title="15"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;2 weeks&quot;</span>,</a>
<a class="sourceLine" id="cb1683-16" title="16">               <span class="dt">date_labels =</span> <span class="st">&quot;%b-%d&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-17" title="17"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">15</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb1683-19" title="19">       <span class="dt">title =</span> <span class="st">&quot;World COVID-19 cases over time&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1683-20" title="20"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb1683-21" title="21">    <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</a>
<a class="sourceLine" id="cb1683-22" title="22">    <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb1683-23" title="23">                              <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>),</a>
<a class="sourceLine" id="cb1683-24" title="24">    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1683-25" title="25">    <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb1683-26" title="26">  )</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;continent&#39; (override with `.groups` argument)</code></pre>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-139-1.svg" width="1056" /></p>

<ol start="2" style="list-style-type: decimal">
<li>대한민국 일일 검사수와 검사수와 7일 이동평균선(new_tests_smoothed) 시각화</li>
</ol>
<ul>
<li>일일 검사수는 막대도표로 표시
<ul>
<li>7일 이동 평균선은 빨강색으로 표시</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1685-1" title="1"><span class="kw">Sys.setlocale</span>(<span class="st">&quot;LC_TIME&quot;</span>, <span class="st">&quot;english&quot;</span>) <span class="co"># date 영문 표시를 위해 필요</span></a></code></pre></div>
<pre><code>[1] &quot;English_United States.1252&quot;</code></pre>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1687-1" title="1">covid19_full <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-2" title="2"><span class="st">  </span><span class="kw">filter</span>(iso_code <span class="op">==</span><span class="st"> &quot;KOR&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_tests_n =</span> <span class="kw">max</span>(total_tests)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-4" title="4"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> new_tests), </a>
<a class="sourceLine" id="cb1687-7" title="7">           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, </a>
<a class="sourceLine" id="cb1687-8" title="8">           <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, </a>
<a class="sourceLine" id="cb1687-9" title="9">           <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> new_tests_smoothed, </a>
<a class="sourceLine" id="cb1687-11" title="11">                <span class="dt">group =</span> location), </a>
<a class="sourceLine" id="cb1687-12" title="12">            <span class="dt">size =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1687-13" title="13">            <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-14" title="14"><span class="st">  </span><span class="co"># x의 데이터 유형이 date</span></a>
<a class="sourceLine" id="cb1687-15" title="15"><span class="st">  </span><span class="co"># date label에 대한 자세한 설명은 help(strptime)으로 확인</span></a>
<a class="sourceLine" id="cb1687-16" title="16"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_breaks =</span> <span class="st">&quot;2 weeks&quot;</span>, </a>
<a class="sourceLine" id="cb1687-17" title="17">               <span class="dt">date_labels =</span> <span class="st">&quot;%b-%d&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-18" title="18"><span class="st">  </span><span class="co"># y = Inf 는 텍스트의 위치를 맨 위에 위치시킬 때 유용</span></a>
<a class="sourceLine" id="cb1687-19" title="19"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="st">&#39;2020-03-01&#39;</span>), <span class="dt">y =</span> <span class="ot">Inf</span>, </a>
<a class="sourceLine" id="cb1687-20" title="20">                <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Total number of COVID-19 tests performed:&quot;</span>, </a>
<a class="sourceLine" id="cb1687-21" title="21">                              <span class="co"># 출력 숫자 자리수 콤마 표시를 위해 사</span></a>
<a class="sourceLine" id="cb1687-22" title="22">                              <span class="kw">format</span>(<span class="kw">unique</span>(total_tests_n), </a>
<a class="sourceLine" id="cb1687-23" title="23">                               <span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>))), </a>
<a class="sourceLine" id="cb1687-24" title="24">            <span class="dt">vjust =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1687-25" title="25">            <span class="dt">hjust =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1687-26" title="26">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </a>
<a class="sourceLine" id="cb1687-27" title="27">            <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb1687-28" title="28"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">15</span>) <span class="op">+</span><span class="st"> </span><span class="co"># minimal theme 사용</span></a>
<a class="sourceLine" id="cb1687-29" title="29"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb1687-30" title="30">       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb1687-31" title="31">       <span class="dt">title =</span> <span class="st">&quot;Daily COVID-19 tests in South Korea&quot;</span>, </a>
<a class="sourceLine" id="cb1687-32" title="32">       <span class="dt">subtitle =</span> <span class="st">&quot;Test unit: people tested&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1687-33" title="33"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb1687-34" title="34">    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="co"># 범례 표시 제거</span></a>
<a class="sourceLine" id="cb1687-35" title="35">    <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>), </a>
<a class="sourceLine" id="cb1687-36" title="36">    <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb1687-37" title="37">    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb1687-38" title="38">    <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb1687-39" title="39">  )</a></code></pre></div>
<pre><code>Warning: Removed 2 rows containing missing values (position_stack).</code></pre>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-140-1.svg" width="1056" /></p>

<ol start="3" style="list-style-type: decimal">
<li>2020년 5월 31일 기준 상위 24개 국가의 국가 별 확진자 대비 COVID-19 검사 수(전체, 전체 검사수/전체 확진자 수)를 도식화
<ul>
<li>막대도표 사용</li>
</ul></li>
</ol>

<div class="sourceCode" id="cb1689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1689-1" title="1"><span class="kw">require</span>(RColorBrewer)</a></code></pre></div>
<pre><code>필요한 패키지를 로딩중입니다: RColorBrewer</code></pre>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1691-1" title="1">getPalette =<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Set1&quot;</span>))</a>
<a class="sourceLine" id="cb1691-2" title="2">covid19_full <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-3" title="3"><span class="st">  </span><span class="kw">filter</span>(date <span class="op">==</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2020-05-31&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total_tests_per_cases =</span> total_tests<span class="op">/</span>total_cases) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-5" title="5"><span class="st">  </span><span class="kw">filter</span>(total_tests_per_cases <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-6" title="6"><span class="st">  </span><span class="kw">select</span>(iso_code<span class="op">:</span>continent,</a>
<a class="sourceLine" id="cb1691-7" title="7">         total_tests_per_cases) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-8" title="8"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(total_tests_per_cases)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1691-9" title="9"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1691-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">location =</span> <span class="kw">factor</span>(location,</a>
<a class="sourceLine" id="cb1691-11" title="11">                           <span class="dt">levels =</span> <span class="kw">unique</span>(location))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1691-12" title="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(location, <span class="kw">desc</span>(location)),</a>
<a class="sourceLine" id="cb1691-13" title="13">             <span class="dt">y =</span> total_tests_per_cases)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-14" title="14"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> location),</a>
<a class="sourceLine" id="cb1691-15" title="15">           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-16" title="16"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%.1f&quot;</span>, total_tests_per_cases)),</a>
<a class="sourceLine" id="cb1691-17" title="17">            <span class="dt">hjust =</span> <span class="fl">-0.5</span>,</a>
<a class="sourceLine" id="cb1691-18" title="18">            <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-19" title="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1691-20" title="20">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">300</span>),</a>
<a class="sourceLine" id="cb1691-21" title="21">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">200</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-22" title="22"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">getPalette</span>(<span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-23" title="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb1691-24" title="24">       <span class="dt">title =</span> <span class="st">&quot;Total COVID-19 tests per each confirmed case at May 31, 2020&quot;</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-25" title="25"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-26" title="26"><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">15</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1691-27" title="27"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb1691-28" title="28">    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1691-29" title="29">    <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb1691-30" title="30">                              <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>),</a>
<a class="sourceLine" id="cb1691-31" title="31">    <span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1691-32" title="32">    <span class="dt">panel.grid.minor.y =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb1691-33" title="33">  )</a></code></pre></div>
<p><img src="05-data-visualization_files/figure-html/unnamed-chunk-141-1.svg" width="1056" /></p>


</div>
</div>
</div>
<!-- </div> -->
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wilkinson2012grammar">
<p>Wilkinson, Leland. 2012. “The Grammar of Graphics.” In <em>Handbook of Computational Statistics</em>, 375–414. Springer.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="low-level-graphic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zorba78/cnu-r-programming-lecture-note/05-data-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cnu-r-programming.pdf", "cnu-r-programming.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
