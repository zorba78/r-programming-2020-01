<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.5 데이터 변환 | 통계 프로그래밍 언어</title>
  <meta name="description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4.5 데이터 변환 | 통계 프로그래밍 언어" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="github-repo" content="zorba78/cnu-r-programming-lecture-note" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.5 데이터 변환 | 통계 프로그래밍 언어" />
  
  <meta name="twitter:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  

<meta name="author" content="한국한의학연구원, 구본초" />


<meta name="date" content="2020-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr.html"/>
<link rel="next" href="homework-04.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">통계 프로그래밍 언어</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Overview</a></li>
<li class="part"><span><b>I Get Started</b></span></li>
<li class="chapter" data-level="1" data-path="intro-chap.html"><a href="intro-chap.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1.1</b> R 설치하기</a></li>
<li class="chapter" data-level="1.2" data-path="r-check.html"><a href="r-check.html"><i class="fa fa-check"></i><b>1.2</b> R 시작 및 작동 체크</a></li>
<li class="chapter" data-level="1.3" data-path="rconsle-script.html"><a href="rconsle-script.html"><i class="fa fa-check"></i><b>1.3</b> R script 편집기 사용</a></li>
<li class="chapter" data-level="1.4" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>1.4</b> RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-studio.html"><a href="r-studio.html#rstudio-install"><i class="fa fa-check"></i><b>1.4.1</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-studio.html"><a href="r-studio.html#rstudio-component"><i class="fa fa-check"></i><b>1.4.2</b> RStudio IDE 화면 구성</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-studio.html"><a href="r-studio.html#rstudio-glob-options"><i class="fa fa-check"></i><b>1.4.3</b> RStudio 환경 설정</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-studio.html"><a href="r-studio.html#rstudio-project"><i class="fa fa-check"></i><b>1.4.4</b> RStudio 프로젝트</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>1.5</b> R 패키지</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-package.html"><a href="r-package.html#r-package-path"><i class="fa fa-check"></i><b>1.5.1</b> R 패키지 경로 확인 및 변경</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-package.html"><a href="r-package.html#r-package-install"><i class="fa fa-check"></i><b>1.5.2</b> R 패키지 설치하기</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-package.html"><a href="r-package.html#r-package-load"><i class="fa fa-check"></i><b>1.5.3</b> R 패키지 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-basic.html"><a href="r-basic.html"><i class="fa fa-check"></i><b>1.6</b> R 기초 문법</a></li>
<li class="chapter" data-level="1.7" data-path="r-markdown-get-start.html"><a href="r-markdown-get-start.html"><i class="fa fa-check"></i><b>1.7</b> R Markdown (맛보기)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-type.html"><a href="data-type.html"><i class="fa fa-check"></i><b>2</b> R 객체(R object)</a><ul>
<li class="chapter" data-level="2.1" data-path="scalar.html"><a href="scalar.html"><i class="fa fa-check"></i><b>2.1</b> 스칼라(scalar)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="scalar.html"><a href="scalar.html#definition"><i class="fa fa-check"></i><b>2.1.1</b> 선언</a></li>
<li class="chapter" data-level="2.1.2" data-path="scalar.html"><a href="scalar.html#numeric"><i class="fa fa-check"></i><b>2.1.2</b> 숫자형</a></li>
<li class="chapter" data-level="2.1.3" data-path="scalar.html"><a href="scalar.html#character"><i class="fa fa-check"></i><b>2.1.3</b> 문자형</a></li>
<li class="chapter" data-level="2.1.4" data-path="scalar.html"><a href="scalar.html#logical"><i class="fa fa-check"></i><b>2.1.4</b> 논리형 스칼라</a></li>
<li class="chapter" data-level="2.1.5" data-path="scalar.html"><a href="scalar.html#missing-value"><i class="fa fa-check"></i><b>2.1.5</b> 결측값(missing value)</a></li>
<li class="chapter" data-level="2.1.6" data-path="scalar.html"><a href="scalar.html#null"><i class="fa fa-check"></i><b>2.1.6</b> NULL 값</a></li>
<li class="chapter" data-level="2.1.7" data-path="scalar.html"><a href="scalar.html#finite"><i class="fa fa-check"></i><b>2.1.7</b> 무한대/무한소/숫자아님</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>2.2</b> 벡터(vector)</a><ul>
<li class="chapter" data-level="2.2.1" data-path="vector.html"><a href="vector.html#vector-prop"><i class="fa fa-check"></i><b>2.2.1</b> 벡터의 특징</a></li>
<li class="chapter" data-level="2.2.2" data-path="vector.html"><a href="vector.html#vector-operation"><i class="fa fa-check"></i><b>2.2.2</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.2.3" data-path="vector.html"><a href="vector.html#vector-index"><i class="fa fa-check"></i><b>2.2.3</b> 벡터의 색인(indexing)</a></li>
<li class="chapter" data-level="2.2.4" data-path="vector.html"><a href="vector.html#vector-function"><i class="fa fa-check"></i><b>2.2.4</b> 벡터 관련 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>2.3</b> 리스트(list)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="list.html"><a href="list.html#make-list"><i class="fa fa-check"></i><b>2.3.1</b> 리스트 생성</a></li>
<li class="chapter" data-level="2.3.2" data-path="list.html"><a href="list.html#list-index"><i class="fa fa-check"></i><b>2.3.2</b> 리스트 색인</a></li>
<li class="chapter" data-level="2.3.3" data-path="list.html"><a href="list.html#list-add-delete"><i class="fa fa-check"></i><b>2.3.3</b> 리스트에 원소 추가/제거</a></li>
<li class="chapter" data-level="2.3.4" data-path="list.html"><a href="list.html#list-combine"><i class="fa fa-check"></i><b>2.3.4</b> 리스트의 결합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="matrix.html"><a href="matrix.html"><i class="fa fa-check"></i><b>2.4</b> 행렬(matrix)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="matrix.html"><a href="matrix.html#matrix-operation"><i class="fa fa-check"></i><b>2.4.1</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.4.2" data-path="matrix.html"><a href="matrix.html#mat-index"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 색인</a></li>
<li class="chapter" data-level="2.4.3" data-path="matrix.html"><a href="matrix.html#행과-열-추가-및-제거"><i class="fa fa-check"></i><b>2.4.3</b> 행과 열 추가 및 제거</a></li>
<li class="chapter" data-level="2.4.4" data-path="matrix.html"><a href="matrix.html#행렬-관련-함수"><i class="fa fa-check"></i><b>2.4.4</b> 행렬 관련 함수</a></li>
<li class="chapter" data-level="2.4.5" data-path="matrix.html"><a href="matrix.html#vec-mat-diff"><i class="fa fa-check"></i><b>2.4.5</b> 벡터와 행렬의 차이점</a></li>
<li class="chapter" data-level="2.4.6" data-path="matrix.html"><a href="matrix.html#mat-dim-reduc-sway"><i class="fa fa-check"></i><b>2.4.6</b> 의도치 않은 차원축소 피하기</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="array.html"><a href="array.html"><i class="fa fa-check"></i><b>2.5</b> 배열(array)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="array.html"><a href="array.html#make-array"><i class="fa fa-check"></i><b>2.5.1</b> 배열의 생성 및 색인</a></li>
<li class="chapter" data-level="2.5.2" data-path="array.html"><a href="array.html#rray-extend-example"><i class="fa fa-check"></i><b>2.5.2</b> 배열의 확장 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="factor-table.html"><a href="factor-table.html"><i class="fa fa-check"></i><b>2.6</b> 요인(factor)과 테이블(table)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="factor-table.html"><a href="factor-table.html#factor"><i class="fa fa-check"></i><b>2.6.1</b> 요인(factor)</a></li>
<li class="chapter" data-level="2.6.2" data-path="factor-table.html"><a href="factor-table.html#table"><i class="fa fa-check"></i><b>2.6.2</b> 테이블(table)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-frame.html"><a href="data-frame.html"><i class="fa fa-check"></i><b>2.7</b> 데이터 프레임(data frame)</a><ul>
<li class="chapter" data-level="2.7.1" data-path="data-frame.html"><a href="data-frame.html#create-data-frame"><i class="fa fa-check"></i><b>2.7.1</b> 데이터 프레임 생성</a></li>
<li class="chapter" data-level="2.7.2" data-path="data-frame.html"><a href="data-frame.html#data-frame-get"><i class="fa fa-check"></i><b>2.7.2</b> 데이터 프레임 접근 및 필터링</a></li>
<li class="chapter" data-level="2.7.3" data-path="data-frame.html"><a href="data-frame.html#data-frame-function"><i class="fa fa-check"></i><b>2.7.3</b> 데이터 프레임 관련 함수</a></li>
<li class="chapter" data-level="2.7.4" data-path="data-frame.html"><a href="data-frame.html#apply-related-fun"><i class="fa fa-check"></i><b>2.7.4</b> <code>*apply()</code> 계열 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="is-as-function.html"><a href="is-as-function.html"><i class="fa fa-check"></i><b>2.8</b> 객체의 유형 판별 및 변환</a></li>
<li class="chapter" data-level="2.9" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i><b>2.9</b> Homework #2</a></li>
<li class="chapter" data-level="2.10" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i><b>2.10</b> Homework #3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="string-regexp.html"><a href="string-regexp.html"><i class="fa fa-check"></i><b>3</b> 문자열 처리와 정규표현식</a><ul>
<li class="chapter" data-level="3.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html"><i class="fa fa-check"></i><b>3.1</b> 유용한 문자열 관련 함수</a><ul>
<li class="chapter" data-level="3.1.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#nchar"><i class="fa fa-check"></i><b>3.1.1</b> <strong><code>nchar()</code></strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#paste"><i class="fa fa-check"></i><b>3.1.2</b> <strong><code>paste()</code></strong>, <strong><code>paste0()</code></strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#sprintf"><i class="fa fa-check"></i><b>3.1.3</b> <strong><code>sprintf()</code></strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#substr"><i class="fa fa-check"></i><b>3.1.4</b> <strong><code>substr()</code></strong></a></li>
<li class="chapter" data-level="3.1.5" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#low-up-fun"><i class="fa fa-check"></i><b>3.1.5</b> <strong><code>tolower()</code>, <code>toupper()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html"><i class="fa fa-check"></i><b>3.2</b> 정규표현식 기본 함수</a><ul>
<li class="chapter" data-level="3.2.1" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#grep-grepl"><i class="fa fa-check"></i><b>3.2.1</b> <strong><code>grep()</code>, <code>grepl()</code></strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexpr-gregexpr"><i class="fa fa-check"></i><b>3.2.2</b> <strong><code>regexpr()</code></strong>, <strong><code>gregexpr()</code></strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#sub-gsub-fun"><i class="fa fa-check"></i><b>3.2.3</b> <strong><code>sub()</code></strong>, <strong><code>gsub()</code></strong></a></li>
<li class="chapter" data-level="3.2.4" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexec-fun"><i class="fa fa-check"></i><b>3.2.4</b> <strong><code>regexec()</code></strong></a></li>
<li class="chapter" data-level="3.2.5" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#strsplit"><i class="fa fa-check"></i><b>3.2.5</b> <strong><code>strsplit()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reg-exp.html"><a href="reg-exp.html"><i class="fa fa-check"></i><b>3.3</b> 정규 표현식(regular expression)</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reg-exp.html"><a href="reg-exp.html#basic-meta"><i class="fa fa-check"></i><b>3.3.1</b> 기본 메타 문자</a></li>
<li class="chapter" data-level="3.3.2" data-path="reg-exp.html"><a href="reg-exp.html#character-set"><i class="fa fa-check"></i><b>3.3.2</b> 문자 집합</a></li>
<li class="chapter" data-level="3.3.3" data-path="reg-exp.html"><a href="reg-exp.html#character-class"><i class="fa fa-check"></i><b>3.3.3</b> 문자 클래스</a></li>
<li class="chapter" data-level="3.3.4" data-path="reg-exp.html"><a href="reg-exp.html#regexp-ex"><i class="fa fa-check"></i><b>3.3.4</b> 정규 표현식 예시</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>4</b> 데이터 핸들링(Data handling)</a><ul>
<li class="chapter" data-level="4.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html#data-import-export"><i class="fa fa-check"></i><b>4.1.1</b> 외부데이터 불러오기 및 저장</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4.2</b> Tidyverse</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4.3</b> <code>readr</code> 패키지</a><ul>
<li class="chapter" data-level="4.3.1" data-path="readr.html"><a href="readr.html#import-export-excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel 파일 입출력</a></li>
<li class="chapter" data-level="4.3.2" data-path="readr.html"><a href="readr.html#tibble"><i class="fa fa-check"></i><b>4.3.2</b> tibble 패키지</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4.4</b> <code>dplyr</code> 패키지</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dplyr.html"><a href="dplyr.html#pipe-op"><i class="fa fa-check"></i><b>4.4.1</b> 파이프 연산자: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-filter"><i class="fa fa-check"></i><b>4.4.2</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>4.4.3</b> <code id="dplyr-arrange">arrange()</code></a></li>
<li class="chapter" data-level="4.4.4" data-path="dplyr.html"><a href="dplyr.html#dplyr-select"><i class="fa fa-check"></i><b>4.4.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.4.5" data-path="dplyr.html"><a href="dplyr.html#dplyr-mutate"><i class="fa fa-check"></i><b>4.4.5</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="dplyr.html"><a href="dplyr.html#dplyr-transmute"><i class="fa fa-check"></i><b>4.4.6</b> <code>transmute()</code></a></li>
<li class="chapter" data-level="4.4.7" data-path="dplyr.html"><a href="dplyr.html#dplyr-summarise"><i class="fa fa-check"></i><b>4.4.7</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="4.4.8" data-path="dplyr.html"><a href="dplyr.html#dplyr-group_by"><i class="fa fa-check"></i><b>4.4.8</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="4.4.9" data-path="dplyr.html"><a href="dplyr.html#dplyr-application"><i class="fa fa-check"></i><b>4.4.9</b> dplyr 관련 유용한 함수</a></li>
<li class="chapter" data-level="4.4.10" data-path="dplyr.html"><a href="dplyr.html#dplyr-verb-variant-adverb"><i class="fa fa-check"></i><b>4.4.10</b> 부가 기능</a></li>
<li class="chapter" data-level="4.4.11" data-path="dplyr.html"><a href="dplyr.html#dplyr-join"><i class="fa fa-check"></i><b>4.4.11</b> 데이터 연결</a></li>
<li class="chapter" data-level="4.4.12" data-path="dplyr.html"><a href="dplyr.html#ex-gapminder"><i class="fa fa-check"></i><b>4.4.12</b> 확장 예제: Gapminder</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4.5</b> 데이터 변환</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-transformation.html"><a href="data-transformation.html#tidy-data"><i class="fa fa-check"></i><b>4.5.1</b> Tidy data</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-transformation.html"><a href="data-transformation.html#long-format"><i class="fa fa-check"></i><b>4.5.2</b> Long format</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-transformation.html"><a href="data-transformation.html#wider-format"><i class="fa fa-check"></i><b>4.5.3</b> Wide format</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-transformation.html"><a href="data-transformation.html#separate-unite"><i class="fa fa-check"></i><b>4.5.4</b> Separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="homework-04.html"><a href="homework-04.html"><i class="fa fa-check"></i><b>4.6</b> Homework #4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-data-visualization.html"><a href="ch-data-visualization.html"><i class="fa fa-check"></i><b>5</b> 데이터 시각화</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basic-graphics.html"><a href="r-basic-graphics.html"><i class="fa fa-check"></i><b>5.1</b> R 기본 그래프 함수</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-graph.html"><a href="high-level-graph.html"><i class="fa fa-check"></i><b>5.2</b> 고수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.2.1" data-path="high-level-graph.html"><a href="high-level-graph.html#plot-fun"><i class="fa fa-check"></i><b>5.2.1</b> <strong><code>plot()</code> 함수</strong></a></li>
<li class="chapter" data-level="5.2.2" data-path="high-level-graph.html"><a href="high-level-graph.html#main-high-level-graph"><i class="fa fa-check"></i><b>5.2.2</b> 주요 고수준 그래픽 함수</a></li>
<li class="chapter" data-level="5.2.3" data-path="high-level-graph.html"><a href="high-level-graph.html#scatter-plot"><i class="fa fa-check"></i><b>5.2.3</b> 산점도</a></li>
<li class="chapter" data-level="5.2.4" data-path="high-level-graph.html"><a href="high-level-graph.html#mat-plot"><i class="fa fa-check"></i><b>5.2.4</b> 행렬 그래프</a></li>
<li class="chapter" data-level="5.2.5" data-path="high-level-graph.html"><a href="high-level-graph.html#histogram"><i class="fa fa-check"></i><b>5.2.5</b> 히스토그램</a></li>
<li class="chapter" data-level="5.2.6" data-path="high-level-graph.html"><a href="high-level-graph.html#bar-plot"><i class="fa fa-check"></i><b>5.2.6</b> 막대 그래프</a></li>
<li class="chapter" data-level="5.2.7" data-path="high-level-graph.html"><a href="high-level-graph.html#boxplot"><i class="fa fa-check"></i><b>5.2.7</b> 상자 그림</a></li>
<li class="chapter" data-level="5.2.8" data-path="high-level-graph.html"><a href="high-level-graph.html#violin-plot"><i class="fa fa-check"></i><b>5.2.8</b> 바이올린 도표</a></li>
<li class="chapter" data-level="5.2.9" data-path="high-level-graph.html"><a href="high-level-graph.html#mosaicplot"><i class="fa fa-check"></i><b>5.2.9</b> 모자이크 도표</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html"><i class="fa fa-check"></i><b>5.3</b> 저수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.3.1" data-path="low-level-graphic.html"><a href="low-level-graphic.html#par"><i class="fa fa-check"></i><b>5.3.1</b> par()</a></li>
<li class="chapter" data-level="5.3.2" data-path="low-level-graphic.html"><a href="low-level-graphic.html#points"><i class="fa fa-check"></i><b>5.3.2</b> points()</a></li>
<li class="chapter" data-level="5.3.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html#lines"><i class="fa fa-check"></i><b>5.3.3</b> lines()</a></li>
<li class="chapter" data-level="5.3.4" data-path="low-level-graphic.html"><a href="low-level-graphic.html#ablines"><i class="fa fa-check"></i><b>5.3.4</b> ablines()</a></li>
<li class="chapter" data-level="5.3.5" data-path="low-level-graphic.html"><a href="low-level-graphic.html#arrows"><i class="fa fa-check"></i><b>5.3.5</b> arrows()</a></li>
<li class="chapter" data-level="5.3.6" data-path="low-level-graphic.html"><a href="low-level-graphic.html#rect"><i class="fa fa-check"></i><b>5.3.6</b> rect()</a></li>
<li class="chapter" data-level="5.3.7" data-path="low-level-graphic.html"><a href="low-level-graphic.html#polygon"><i class="fa fa-check"></i><b>5.3.7</b> polygon()</a></li>
<li class="chapter" data-level="5.3.8" data-path="low-level-graphic.html"><a href="low-level-graphic.html#text"><i class="fa fa-check"></i><b>5.3.8</b> text(), mtext()</a></li>
<li class="chapter" data-level="5.3.9" data-path="low-level-graphic.html"><a href="low-level-graphic.html#legend"><i class="fa fa-check"></i><b>5.3.9</b> legend()</a></li>
<li class="chapter" data-level="5.3.10" data-path="low-level-graphic.html"><a href="low-level-graphic.html#math-expression"><i class="fa fa-check"></i><b>5.3.10</b> 수식 표현</a></li>
<li class="chapter" data-level="5.3.11" data-path="low-level-graphic.html"><a href="low-level-graphic.html#r-기본-그래프-이미지-파일로-저장"><i class="fa fa-check"></i><b>5.3.11</b> R 기본 그래프 이미지 파일로 저장</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>5.4</b> ggplot2</a><ul>
<li class="chapter" data-level="5.4.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#basic-grammar"><i class="fa fa-check"></i><b>5.4.1</b> 기본 문법</a></li>
<li class="chapter" data-level="5.4.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-lines"><i class="fa fa-check"></i><b>5.4.2</b> Geoms: 선 관련 geometric</a></li>
<li class="chapter" data-level="5.4.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-points"><i class="fa fa-check"></i><b>5.4.3</b> Geoms: 점 geometrics</a></li>
<li class="chapter" data-level="5.4.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-bars"><i class="fa fa-check"></i><b>5.4.4</b> Geoms: 막대 geometrics</a></li>
<li class="chapter" data-level="5.4.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-intervals"><i class="fa fa-check"></i><b>5.4.5</b> Geom: 수직 범위선 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-texts"><i class="fa fa-check"></i><b>5.4.6</b> Geoms: 텍스트 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-areas"><i class="fa fa-check"></i><b>5.4.7</b> Geoms: 면적 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-statistics"><i class="fa fa-check"></i><b>5.4.8</b> Geoms: 통계 그래프 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-x-y"><i class="fa fa-check"></i><b>5.4.9</b> Scales: x-y 축 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-colors-fill"><i class="fa fa-check"></i><b>5.4.10</b> Scales: 색상 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-size-line-shape"><i class="fa fa-check"></i><b>5.4.11</b> Scales: 크기, 선 종류, 점 모양 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.12" data-path="ggplot2-package.html"><a href="ggplot2-package.html#coordinate-systems"><i class="fa fa-check"></i><b>5.4.12</b> Coordinate systems</a></li>
<li class="chapter" data-level="5.4.13" data-path="ggplot2-package.html"><a href="ggplot2-package.html#guides-x-y-축-및-그래프-제목-관련"><i class="fa fa-check"></i><b>5.4.13</b> Guides: x-y 축 및 그래프 제목 관련</a></li>
<li class="chapter" data-level="5.4.14" data-path="ggplot2-package.html"><a href="ggplot2-package.html#facets-국소-시각화-기법"><i class="fa fa-check"></i><b>5.4.14</b> Facets: 국소 시각화 기법</a></li>
<li class="chapter" data-level="5.4.15" data-path="ggplot2-package.html"><a href="ggplot2-package.html#themes"><i class="fa fa-check"></i><b>5.4.15</b> Themes</a></li>
<li class="chapter" data-level="5.4.16" data-path="ggplot2-package.html"><a href="ggplot2-package.html#ggplot-application"><i class="fa fa-check"></i><b>5.4.16</b> 확장 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">통계 프로그래밍 언어</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level2">
<h2><span class="header-section-number">4.5</span> 데이터 변환</h2>


<div class="rmdnote">
<strong>Tidy data</strong>에 대한 개념을 알아보고, tidyr 패키지에서 제공하는 데이터 변환 함수 사용 방법에 대해 익힌다.
</div>


<ul>
<li><p>데이터 분석에서 적어도 80% 이상의 시간을 데이터 전처리에 할애</p></li>
<li><p>실제 데이터(real world data, RWD)가 우리가 지금까지 다뤄왔던 예제 데이터 처럼 깔끔하게 정리된 경우는 거의 없음.</p>
<ul>
<li>이상치(outlier)</li>
<li>결측(missing data)</li>
<li>변수 정의의 부재(예: 어러 가지 변수 값이 혼합되어 한 열로 포함된 경우)</li>
<li>비정형 문자열로 구성된 변수</li>
<li>불분명한 데이터 구조</li>
<li>…</li>
</ul></li>
<li><p>Tidyverse 세계에서 지저분한 데이터(<strong>messy data</strong>)를 분석이 용이하고(전산 처리가 쉽고) 깔끔한 데이터(tidy data)로 정제하기 위해 데이터의 구조를 변환하는 함수를 포함하고 있는 패키지가 <strong>tidyr</strong></p></li>
<li><p>여기서 “tidy”는 “organized”와 동일한 의미를 가짐</p></li>
<li><p><strong>tidyr</strong>은 Hadely Wickam 이 개발한 <strong>reshape</strong> 와 <strong>reshape2</strong> 패키지 <span class="citation">(Wickham <a href="#ref-wickham-2007p" role="doc-biblioref">2007</a>)</span>가 포함하고 있는 전반적인 데이터 변환 함수 중 tidy data를 만드는데 핵심적인 함수만으로 구성된 패키지</p></li>
</ul>
<div id="tidy-data" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Tidy data</h3>


<div class="rmdwarning">
시작 전 tidyverse 패키지를 R 작업공간으로 불러오기!!
</div>


<blockquote>
<p>아래 강의 내용은 <span class="citation">Wickham and others (<a href="#ref-wickham-2014p" role="doc-biblioref">2014</a>)</span> 의 내용을 재구성함</p>
</blockquote>
<ul>
<li>데이터셋의 구성 요소
<ol style="list-style-type: lower-alpha">
<li>데이터셋은 관측값(<strong>value</strong>)으로 구성</li>
<li>각 관찰값은 변수(<strong>variable</strong>)와 관측(<strong>observation</strong>) 단위에 속함</li>
<li>변수는 측정 속성과 단위가 동일한 값으로 구성(예: 키, 몸무게, 체온 등)</li>
<li>관측(observation)은 속성(변수) 전체에서 동일한 단위(예: 사람, 가구, 지역 등)에서 측정된 모든 값</li>
</ol></li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-77"></span>
<img src="figures/tidydata-structure-01.png" alt="데이터의 구성 요소" width="100%" />
<p class="caption">
Figure 4.10: 데이터의 구성 요소
</p>
</div>



<div class="rmdimportant">
<p><strong>Tidy Data Principles</strong></p>
<ul>
<li><strong>각각의 변수는 하나의 열로 구성된다(Each variable forms a column)</strong>.</li>
<li><strong>각각의 관측은 하나의 행으로 구성된다(Each observation forms a row)</strong>.</li>
<li><strong>각각의 값은 반드시 자체적인 하나의 셀을 가져야 한다(Each value must have its own cell)</strong>.</li>
<li>각각의 관찰 단위는 테이블을 구성한다(Each type of observational unit forms a table).</li>
</ul>
</div>


<ul>
<li>2 <span class="math inline">\(\times\)</span> 2 교차설계 데이터 예시: 2개의 열(column), 3개의 행(row), 각 행과 열은 이름을 갖고 있음(labelled)</li>
</ul>

<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-79">Table 4.8: </span>Tidy data 예시 데이터 1
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
treatmenta
</th>
<th style="text-align:center;">
treatmentb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 4cm; ">
James McGill
</td>
<td style="text-align:left;width: 2cm; ">
NA
</td>
<td style="text-align:center;width: 2cm; ">
1
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Kimberly Wexler
</td>
<td style="text-align:left;width: 2cm; ">
17
</td>
<td style="text-align:center;width: 2cm; ">
14
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Lalo Salamanca
</td>
<td style="text-align:left;width: 2cm; ">
8
</td>
<td style="text-align:center;width: 2cm; ">
19
</td>
</tr>
</tbody>
</table>

<blockquote>
<p>데이터셋에서 중요한 요인인 배정군의 수준이 변수로 사용 <span class="math inline">\(\rightarrow\)</span> <strong>a</strong>와 <strong>b</strong>는 <strong>treatment</strong>의 하위 수준임</p>
</blockquote>
<p><br/></p>
<ul>
<li>예시 데이터 1 전치 <span class="math inline">\(\rightarrow\)</span> 위 데이터 셋과 동일한 내용이지만 다른 레이아웃 형태</li>
</ul>

<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-80">Table 4.9: </span>Tidy data: 예시 데이터 1과 동일 내용, 다른 레이아웃
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
James McGill
</th>
<th style="text-align:center;">
Kimberly Wexler
</th>
<th style="text-align:center;">
Lalo Salamanca
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; ">
treatmenta
</td>
<td style="text-align:left;width: 3cm; ">
NA
</td>
<td style="text-align:center;width: 3cm; ">
17
</td>
<td style="text-align:center;width: 3cm; ">
8
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
treatmentb
</td>
<td style="text-align:left;width: 3cm; ">
1
</td>
<td style="text-align:center;width: 3cm; ">
14
</td>
<td style="text-align:center;width: 3cm; ">
19
</td>
</tr>
</tbody>
</table>

<blockquote>
<p>관측 단위가 변수로 사용</p>
</blockquote>
<ul>
<li>위 예시 데이터 1을 재정의
<ol style="list-style-type: decimal">
<li><code>person</code>: 3 개의 값(<code>James</code>, <code>Kimberly</code>, <code>Lalo</code>)</li>
<li><code>treatment</code>: 2 개의 값(<code>a</code>, <code>b</code>)</li>
<li><code>result</code>: 6 개의 값(결측 포함) <code>person</code>과 <code>treatment</code>의 조합</li>
</ol></li>
</ul>

<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-81">Table 4.10: </span>Tidy data: 예시 데이터 1 구조 변환
</caption>
<thead>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:center;">
treatment
</th>
<th style="text-align:center;">
result
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 4cm; ">
James McGill
</td>
<td style="text-align:center;width: 2cm; ">
a
</td>
<td style="text-align:center;width: 2cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Kimberly Wexler
</td>
<td style="text-align:center;width: 2cm; ">
a
</td>
<td style="text-align:center;width: 2cm; ">
17
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Lalo Salamanca
</td>
<td style="text-align:center;width: 2cm; ">
a
</td>
<td style="text-align:center;width: 2cm; ">
8
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
James McGill
</td>
<td style="text-align:center;width: 2cm; ">
b
</td>
<td style="text-align:center;width: 2cm; ">
1
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Kimberly Wexler
</td>
<td style="text-align:center;width: 2cm; ">
b
</td>
<td style="text-align:center;width: 2cm; ">
14
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Lalo Salamanca
</td>
<td style="text-align:center;width: 2cm; ">
b
</td>
<td style="text-align:center;width: 2cm; ">
19
</td>
</tr>
</tbody>
</table>

<blockquote>
<p>위 데이터는</p>
<ul>
<li>모든 행(row)는 observation을 나타냄</li>
<li>모든 <code>result</code>에 해당하는 값(<strong>value</strong>)은 하나의 <code>treatment</code>와 하나의 <code>person</code>에 대응함</li>
<li>모든 열은 변수(<strong>variable</strong>)</li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> <strong>tidy data</strong> 원칙을 만족</p>
</blockquote>
<p><strong>Tidy data</strong>의 장점</p>
<ul>
<li>표준화된 데이터 구조로 변수 및 관측치 추출이 용이</li>
<li>일관된 데이터 구조를 유지된다면 이와 관련한 도구(함수)를 배우는 것이 보다 용이함</li>
<li>R의 vectorized programming 환경에 최적화 <span class="math inline">\(\rightarrow\)</span> 동일한 관측에 대한 서로 다른 변수값이 항상 짝으로 매칭되는 것을 보장</li>
</ul>
<p><strong>Messy data</strong>의 일반적인 문제점</p>
<ol style="list-style-type: decimal">
<li>열 이름을 변수명이 아닌 값(value)으로 사용</li>
<li>두 개 이상의 변수에 해당하는 값이 하나의 열에 저장</li>
</ol>
<p>이러한 문제를 해결(데이터 정돈)하기 위해 데이터의 구조 변환은 필수적이며, 이를 위해 tidyr 패키지에서 아래와 같은 패키지 제공</p>
<ul>
<li><code>gather()</code>, <code>pivot_longer()</code>: 아래로 긴 데이터 셋(melt된 데이터셋) <span class="math inline">\(\rightarrow\)</span> <strong>long format</strong></li>
<li><code>spread()</code>, <code>pivot_wider()</code>: 옆으로 긴 데이터 셋(열에 cast된 데이터셋) <span class="math inline">\(\rightarrow\)</span> <strong>wide format</strong></li>
</ul>

<p><img src="figures/tidyr-pre.png" width="70%" style="display: block; margin: auto;" /></p>

<blockquote>
<ul>
<li>long format: 데이터가 적은 수의 열로 이루어지며, 각 열 보통 행의 unique한 정보를 표현하기 위한 ID(또는 key)로 구성되어 있고 보통은 관측된 변수에 대한 한 개의 열로 구성된 데이터 형태</li>
<li>wide format: 통계학에서 다루는 데이터 구조와 동일한 개념으로 한 관측 단위(사람, 가구 등)가 한 행을 이루고, 관측 단위에 대한 측정값(예: 키, 몸무게, 성별)들이 변수(열)로 표현된 데이터 형태</li>
</ul>
</blockquote>

<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<pre><code># A tibble: 352 x 3
   model       variable  value
   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
 1 AMC Javelin mpg       15.2 
 2 AMC Javelin cyl        8   
 3 AMC Javelin disp     304   
 4 AMC Javelin hp       150   
 5 AMC Javelin drat       3.15
 6 AMC Javelin wt         3.44
 7 AMC Javelin qsec      17.3 
 8 AMC Javelin vs         0   
 9 AMC Javelin am         0   
10 AMC Javelin gear       3   
# ... with 342 more rows</code></pre>



<div class="rmdcaution">
dplyr 패키지와 마찬가지로 tidyr 패키지에서 제공하는 함수는 데이터 프레임 또는 티블에서만 작동함
</div>


</div>
<div id="long-format" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Long format</h3>
<ul>
<li>“long” 형태의 데이터 구조는 “wide” 형태의 데이터 보다 “사람”이 이해하기에 편한 형태는 아니지만 아래와 같은 장점을 가짐
<ul>
<li>“컴퓨터”가 이해하기 편한 구조</li>
<li>“wide” 형태보다 유연 <span class="math inline">\(\rightarrow\)</span> 데이터의 추가 및 삭제 용이</li>
</ul></li>
<li>“wide” 형태의 데이터를 “long” 형태로 변환 해주는 tidyr 패키지 내장 함수는
<ul>
<li><strong><code>pivot_longer()</code></strong>: 데이터의 행의 길이를 늘리고 열의 개수를 줄이는 함수</li>
<li><code>gather()</code>: <code>pivot_longer()</code>의 이전 버전으로 보다 쉽게 사용할 수 있고, 함수 명칭도 보다 직관적이지만 함수 업데이트는 종료</li>
</ul></li>
</ul>
<blockquote>
<p>“wide” 형태의 데이터를 “long” 형태로 바꾸는 것은 원래 구조의 데이터를 녹여서(melt) 길게 만든다는 의미로도 해석할 수 있음. tidyr의 초기 버전인 reshape 패키지에서 <code>pivot_wider()</code> 또는 <code>gather()</code>와 유사한 기능을 가진 함수 이름이 <code>melt()</code> 임. 본 강의에서는 <code>melt()</code> 함수의 사용 방법에 대해서는 다루지 않음.</p>
</blockquote>

<div class="sourceCode" id="cb1431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1431-1" title="1"><span class="co"># pivot_longer()의 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1431-2" title="2"><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb1431-3" title="3">  data, <span class="co"># 데이터 프레임</span></a>
<a class="sourceLine" id="cb1431-4" title="4">  cols, <span class="co"># long format으로 변경을 위해 선택한 열 이름</span></a>
<a class="sourceLine" id="cb1431-5" title="5">        <span class="co"># dplyr select() 함수에서 사용한 변수선정 방법 준용</span></a>
<a class="sourceLine" id="cb1431-6" title="6">  names_to, <span class="co"># 선택한 열 이름을 값으로 갖는 변수명칭 지정</span></a>
<a class="sourceLine" id="cb1431-7" title="7">  names_prefix, <span class="co">#변수명에 처음에 붙는 접두어 패턴 제거(예시 참조, optional)</span></a>
<a class="sourceLine" id="cb1431-8" title="8">  names_pattern, <span class="co"># 정규표현식의 그룹지정(())에 해당하는 패턴을 값으로 사용</span></a>
<a class="sourceLine" id="cb1431-9" title="9">                 <span class="co"># 예시 참조(optional)</span></a>
<a class="sourceLine" id="cb1431-10" title="10">  values_to <span class="co"># 선택한 열에 포함되어 있는 셀 값을 저장할 변수 이름 지정</span></a>
<a class="sourceLine" id="cb1431-11" title="11">)</a>
<a class="sourceLine" id="cb1431-12" title="12"></a>
<a class="sourceLine" id="cb1431-13" title="13"><span class="co"># gather() 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1431-14" title="14"><span class="kw">gather</span>(</a>
<a class="sourceLine" id="cb1431-15" title="15">  data, <span class="co"># 데이터 프레임</span></a>
<a class="sourceLine" id="cb1431-16" title="16">  key, <span class="co"># 선택한 열 이름을 값으로 갖는 변수명칭 지정</span></a>
<a class="sourceLine" id="cb1431-17" title="17">  value, <span class="co"># 선택한 열에 포함되어 있는 셀 값을 저장할 변수 이름 지정</span></a>
<a class="sourceLine" id="cb1431-18" title="18">  ... <span class="co"># long format으로 변경할 열 선택</span></a>
<a class="sourceLine" id="cb1431-19" title="19">)</a></code></pre></div>


<p><img src="figures/tidyr-pivot_longer.png" width="90%" style="display: block; margin: auto;" /></p>

<div id="longer-ex" class="section level4 unnumbered">
<h4><strong>Examples</strong></h4>
<ol style="list-style-type: decimal">
<li><strong>열의 이름이 변수명이 아니라 값으로 표현된 경우</strong></li>
</ol>
<!-- ```{r, echo=FALSE} -->
<!-- gap_filter %>% -->
<!--   filter(grepl("KOR|USA|DEU", iso), -->
<!--          between(year, 2001, 2020)) %>% -->
<!--   select(iso:year, gdp_cap) %>% -->
<!--   pivot_wider(names_from = year, -->
<!--               values_from = gdp_cap) %>% -->
<!--   select(-region, -iso) #%>% -->
<!--   # write_csv("dataset/tidyr-wide-ex01.csv", col_names = TRUE) -->
<!-- ``` -->

<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1432-1" title="1"><span class="co"># 데이터 불러오기: read_csv() 함수를 이용해 </span></a>
<a class="sourceLine" id="cb1432-2" title="2"><span class="co"># tidyr-wide-ex01.csv 파일 불러오기</span></a>
<a class="sourceLine" id="cb1432-3" title="3">wide_<span class="dv">01</span> &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;dataset/tidyr-wide-ex01.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1432-4" title="4">wide_<span class="dv">01</span></a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["2001"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["2002"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["2003"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["2004"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["2005"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["2006"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["2007"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["2008"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["2009"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["2010"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["2011"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["2012"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["2013"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["2014"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["2015"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["2016"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["2017"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["2018"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["2019"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["2020"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"Germany","2":"37325.04","3":"37262.35","4":"36977.31","5":"37418.15","6":"37703.88","7":"39143.15","8":"40473.52","9":"40989.44","10":"38784.44","11":"40428.69","12":"42692.51","13":"42822.12","14":"42914.53","15":"43666.71","16":"44043.21","17":"44668.71","18":"45462.04","19":"45959.30","20":"46172.61","21":"46743.92"},{"1":"South Korea","2":"21530.31","3":"22997.09","4":"23549.29","5":"24605.60","6":"25516.89","7":"26696.97","8":"28013.77","9":"28588.45","10":"28642.82","11":"30352.02","12":"31228.56","13":"31776.86","14":"32548.74","15":"33425.61","16":"34177.58","17":"35020.39","18":"35938.34","19":"36776.58","20":"37343.25","21":"38016.79"},{"1":"United States","2":"45662.81","3":"46029.07","4":"46940.89","5":"48275.27","6":"49512.95","7":"50437.77","8":"50897.78","9":"50349.60","10":"48644.24","11":"49479.39","12":"49883.17","13":"50632.41","14":"51208.83","15":"52080.90","16":"53187.45","17":"53631.71","18":"54470.72","19":"55681.16","20":"56657.21","21":"57530.05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

<blockquote>
<ul>
<li>총 21개의 열과 3개의 행으로 구성된 <strong>“wide”</strong> 형태 데이터 구조</li>
<li>열 이름 <code>2001</code> ~ <code>2020</code>은 2001년부터 2020년 까지 년도을 의미함</li>
<li>현재 데이터 구조에서 각 셀의 값(value)은 일인당 국민소득을 나타냄</li>
<li>한 행은 국가(<code>country</code>)의 2001년부터 2020년 까지 년도 별 일인당 국민소득</li>
<li>여기서 관측 단위(observational unit)은 국가(<code>country</code>)이며, 각 국가는 2001년부터 2020년 까지 일인당 국민소득에 대한 관찰값을 가짐</li>
</ul>
</blockquote>
<p><strong>위 데이터가 tidy data 원칙을 준수하려면 어떤 형태로 재구성 되야 할까?</strong></p>
<ol style="list-style-type: decimal">
<li>열 이름은 년도에 해당하는 값(value) 임 <span class="math inline">\(\rightarrow\)</span> <code>year</code>라는 새로운 변수에 해당 값을 저장</li>
<li>일인당 국민소득 정보를 포함한 <code>gdp_cap</code>이라는 변수 생성</li>
<li>대략 아래와 같은 형태의 데이터</li>
</ol>

<p><img src="figures/tidyr-gap-ex-01.png" width="50%" style="display: block; margin: auto;" /></p>

<blockquote>
<p><strong>long format</strong> 의 데이터 구조</p>
<ul>
<li>Unique한 각각의 관측 결과(대한민국의 2001년 일인당 국민소득이 얼마)는 하나의 행에 존재</li>
<li>데이터에서 변수로 표현할 수 있는 속성은 모두 열로 표시</li>
<li>각 변수에 해당하는 값(value)은 하나의 셀에 위치</li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> <strong>tidy data</strong> 원칙 만족</p>
</blockquote>
<ul>
<li>예시 1: <code>wide_01</code> 데이터셋</li>
</ul>

<div class="sourceCode" id="cb1433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1433-1" title="1"><span class="co"># wide_01 데이터 tidying</span></a>
<a class="sourceLine" id="cb1433-2" title="2"><span class="co">## pivot_wider() 사용</span></a>
<a class="sourceLine" id="cb1433-3" title="3">tidy_ex_<span class="dv">01</span> &lt;-<span class="st"> </span>wide_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1433-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">2001</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2020</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1433-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>,</a>
<a class="sourceLine" id="cb1433-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;gdp_cap&quot;</span>)</a>
<a class="sourceLine" id="cb1433-7" title="7">tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 60 x 3
   country year  gdp_cap
   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;
 1 Germany 2001   37325.
 2 Germany 2002   37262.
 3 Germany 2003   36977.
 4 Germany 2004   37418.
 5 Germany 2005   37704.
 6 Germany 2006   39143.
 7 Germany 2007   40474.
 8 Germany 2008   40989.
 9 Germany 2009   38784.
10 Germany 2010   40429.
# ... with 50 more rows</code></pre>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1435-1" title="1"><span class="co">## gather() 사용</span></a>
<a class="sourceLine" id="cb1435-2" title="2">tidy_ex_<span class="dv">01</span> &lt;-<span class="st"> </span>wide_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1435-3" title="3"><span class="st">  </span><span class="kw">gather</span>(year, gdp_cap, <span class="st">`</span><span class="dt">2001</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2020</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb1435-4" title="4">tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 60 x 3
   country       year  gdp_cap
   &lt;chr&gt;         &lt;chr&gt;   &lt;dbl&gt;
 1 Germany       2001   37325.
 2 South Korea   2001   21530.
 3 United States 2001   45663.
 4 Germany       2002   37262.
 5 South Korea   2002   22997.
 6 United States 2002   46029.
 7 Germany       2003   36977.
 8 South Korea   2003   23549.
 9 United States 2003   46941.
10 Germany       2004   37418.
# ... with 50 more rows</code></pre>

<ul>
<li>예시 2: <strong>tidyr</strong> 패키지에 내장되어 있는 <code>billboard</code> 데이터셋(<code>help(billboard)</code> 참고)</li>
</ul>

<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1437-1" title="1">billboard <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 317 x 79
   artist track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8
   &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2 Pac  Baby~ 2000-02-26      87    82    72    77    87    94    99    NA
 2 2Ge+h~ The ~ 2000-09-02      91    87    92    NA    NA    NA    NA    NA
 3 3 Doo~ Kryp~ 2000-04-08      81    70    68    67    66    57    54    53
 4 3 Doo~ Loser 2000-10-21      76    76    72    69    67    65    55    59
 5 504 B~ Wobb~ 2000-04-15      57    34    25    17    17    31    36    49
 6 98^0   Give~ 2000-08-19      51    39    34    26    26    19     2     2
 7 A*Tee~ Danc~ 2000-07-08      97    97    96    95   100    NA    NA    NA
 8 Aaliy~ I Do~ 2000-01-29      84    62    51    41    38    35    35    38
 9 Aaliy~ Try ~ 2000-03-18      59    53    38    28    21    18    16    14
10 Adams~ Open~ 2000-08-26      76    76    74    69    68    67    61    58
# ... with 307 more rows, and 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;,
#   wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;, wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;,
#   wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;, wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;,
#   wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;, wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;,
#   wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;, wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;,
#   wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;, wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;,
#   wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, wk43 &lt;dbl&gt;, wk44 &lt;dbl&gt;, wk45 &lt;dbl&gt;, wk46 &lt;dbl&gt;,
#   wk47 &lt;dbl&gt;, wk48 &lt;dbl&gt;, wk49 &lt;dbl&gt;, wk50 &lt;dbl&gt;, wk51 &lt;dbl&gt;, wk52 &lt;dbl&gt;,
#   wk53 &lt;dbl&gt;, wk54 &lt;dbl&gt;, wk55 &lt;dbl&gt;, wk56 &lt;dbl&gt;, wk57 &lt;dbl&gt;, wk58 &lt;dbl&gt;,
#   wk59 &lt;dbl&gt;, wk60 &lt;dbl&gt;, wk61 &lt;dbl&gt;, wk62 &lt;dbl&gt;, wk63 &lt;dbl&gt;, wk64 &lt;dbl&gt;,
#   wk65 &lt;dbl&gt;, wk66 &lt;lgl&gt;, wk67 &lt;lgl&gt;, wk68 &lt;lgl&gt;, wk69 &lt;lgl&gt;, wk70 &lt;lgl&gt;,
#   wk71 &lt;lgl&gt;, wk72 &lt;lgl&gt;, wk73 &lt;lgl&gt;, wk74 &lt;lgl&gt;, wk75 &lt;lgl&gt;, wk76 &lt;lgl&gt;</code></pre>
<div class="sourceCode" id="cb1439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1439-1" title="1"><span class="kw">names</span>(billboard)</a></code></pre></div>
<pre><code> [1] &quot;artist&quot;       &quot;track&quot;        &quot;date.entered&quot; &quot;wk1&quot;          &quot;wk2&quot;         
 [6] &quot;wk3&quot;          &quot;wk4&quot;          &quot;wk5&quot;          &quot;wk6&quot;          &quot;wk7&quot;         
[11] &quot;wk8&quot;          &quot;wk9&quot;          &quot;wk10&quot;         &quot;wk11&quot;         &quot;wk12&quot;        
[16] &quot;wk13&quot;         &quot;wk14&quot;         &quot;wk15&quot;         &quot;wk16&quot;         &quot;wk17&quot;        
[21] &quot;wk18&quot;         &quot;wk19&quot;         &quot;wk20&quot;         &quot;wk21&quot;         &quot;wk22&quot;        
[26] &quot;wk23&quot;         &quot;wk24&quot;         &quot;wk25&quot;         &quot;wk26&quot;         &quot;wk27&quot;        
[31] &quot;wk28&quot;         &quot;wk29&quot;         &quot;wk30&quot;         &quot;wk31&quot;         &quot;wk32&quot;        
[36] &quot;wk33&quot;         &quot;wk34&quot;         &quot;wk35&quot;         &quot;wk36&quot;         &quot;wk37&quot;        
[41] &quot;wk38&quot;         &quot;wk39&quot;         &quot;wk40&quot;         &quot;wk41&quot;         &quot;wk42&quot;        
[46] &quot;wk43&quot;         &quot;wk44&quot;         &quot;wk45&quot;         &quot;wk46&quot;         &quot;wk47&quot;        
[51] &quot;wk48&quot;         &quot;wk49&quot;         &quot;wk50&quot;         &quot;wk51&quot;         &quot;wk52&quot;        
[56] &quot;wk53&quot;         &quot;wk54&quot;         &quot;wk55&quot;         &quot;wk56&quot;         &quot;wk57&quot;        
[61] &quot;wk58&quot;         &quot;wk59&quot;         &quot;wk60&quot;         &quot;wk61&quot;         &quot;wk62&quot;        
[66] &quot;wk63&quot;         &quot;wk64&quot;         &quot;wk65&quot;         &quot;wk66&quot;         &quot;wk67&quot;        
[71] &quot;wk68&quot;         &quot;wk69&quot;         &quot;wk70&quot;         &quot;wk71&quot;         &quot;wk72&quot;        
[76] &quot;wk73&quot;         &quot;wk74&quot;         &quot;wk75&quot;         &quot;wk76&quot;        </code></pre>
<div class="sourceCode" id="cb1441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1441-1" title="1"><span class="co"># pivot_wider()을 이용해 데이터 정돈</span></a>
<a class="sourceLine" id="cb1441-2" title="2">billb_tidy &lt;-<span class="st"> </span>billboard <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1441-3" title="3"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">starts_with</span>(<span class="st">&quot;wk&quot;</span>),</a>
<a class="sourceLine" id="cb1441-4" title="4">               <span class="dt">names_to =</span> <span class="st">&quot;week&quot;</span>,</a>
<a class="sourceLine" id="cb1441-5" title="5">               <span class="dt">values_to =</span> <span class="st">&quot;rank&quot;</span>)</a>
<a class="sourceLine" id="cb1441-6" title="6">billb_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 24,092 x 5
   artist track                   date.entered week   rank
   &lt;chr&gt;  &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
 1 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk1      87
 2 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk2      82
 3 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk3      72
 4 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk4      77
 5 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk5      87
 6 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk6      94
 7 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk7      99
 8 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk8      NA
 9 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk9      NA
10 2 Pac  Baby Don&#39;t Cry (Keep... 2000-02-26   wk10     NA
# ... with 24,082 more rows</code></pre>
<div class="sourceCode" id="cb1443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1443-1" title="1"><span class="co"># pivot_longer() 함수의 인수 중 value_drop_na 값 조정을 통해</span></a>
<a class="sourceLine" id="cb1443-2" title="2"><span class="co"># 데이터 값에 포함된 결측 제거 가능</span></a>
<a class="sourceLine" id="cb1443-3" title="3">billb_tidy &lt;-<span class="st"> </span>billboard <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1443-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">starts_with</span>(<span class="st">&quot;wk&quot;</span>),</a>
<a class="sourceLine" id="cb1443-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;week&quot;</span>,</a>
<a class="sourceLine" id="cb1443-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;rank&quot;</span>,</a>
<a class="sourceLine" id="cb1443-7" title="7">               <span class="dt">values_drop_na =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1443-8" title="8">billb_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 5,307 x 5
   artist  track                   date.entered week   rank
   &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
 1 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk1      87
 2 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk2      82
 3 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk3      72
 4 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk4      77
 5 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk5      87
 6 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk6      94
 7 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk7      99
 8 2Ge+her The Hardest Part Of ... 2000-09-02   wk1      91
 9 2Ge+her The Hardest Part Of ... 2000-09-02   wk2      87
10 2Ge+her The Hardest Part Of ... 2000-09-02   wk3      92
# ... with 5,297 more rows</code></pre>
<div class="sourceCode" id="cb1445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1445-1" title="1"><span class="co"># pivot_longer() 함수의 인수 중 names_prefix 인수 값 설정을 통해</span></a>
<a class="sourceLine" id="cb1445-2" title="2"><span class="co"># 변수명에 처음에 붙는 접두어(예: V, wk 등) 제거 가능</span></a>
<a class="sourceLine" id="cb1445-3" title="3">billb_tidy &lt;-<span class="st"> </span>billboard <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1445-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">starts_with</span>(<span class="st">&quot;wk&quot;</span>),</a>
<a class="sourceLine" id="cb1445-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;week&quot;</span>,</a>
<a class="sourceLine" id="cb1445-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;rank&quot;</span>,</a>
<a class="sourceLine" id="cb1445-7" title="7">               <span class="dt">names_prefix =</span> <span class="st">&quot;wk&quot;</span>,</a>
<a class="sourceLine" id="cb1445-8" title="8">               <span class="dt">values_drop_na =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1445-9" title="9">billb_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 5,307 x 5
   artist  track                   date.entered week   rank
   &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
 1 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   1        87
 2 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   2        82
 3 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   3        72
 4 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   4        77
 5 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   5        87
 6 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   6        94
 7 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   7        99
 8 2Ge+her The Hardest Part Of ... 2000-09-02   1        91
 9 2Ge+her The Hardest Part Of ... 2000-09-02   2        87
10 2Ge+her The Hardest Part Of ... 2000-09-02   3        92
# ... with 5,297 more rows</code></pre>
<div class="sourceCode" id="cb1447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1447-1" title="1"><span class="co"># pivot_longer() 함수의 인수 중 names_ptypes 또는 values_ptypes 인수 값 설정을 통해</span></a>
<a class="sourceLine" id="cb1447-2" title="2"><span class="co"># 새로 생성한 변수(name과 value 에 해당하는)의 데이터 타입 변경 가능</span></a>
<a class="sourceLine" id="cb1447-3" title="3">billb_tidy &lt;-<span class="st"> </span>billboard <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1447-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">starts_with</span>(<span class="st">&quot;wk&quot;</span>),</a>
<a class="sourceLine" id="cb1447-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;week&quot;</span>,</a>
<a class="sourceLine" id="cb1447-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;rank&quot;</span>,</a>
<a class="sourceLine" id="cb1447-7" title="7">               <span class="dt">names_prefix =</span> <span class="st">&quot;wk&quot;</span>,</a>
<a class="sourceLine" id="cb1447-8" title="8">               <span class="dt">names_transform =</span> <span class="kw">list</span>(<span class="dt">week =</span> as.integer),</a>
<a class="sourceLine" id="cb1447-9" title="9">               <span class="dt">values_drop_na =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1447-10" title="10">billb_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 5,307 x 5
   artist  track                   date.entered  week  rank
   &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;int&gt; &lt;dbl&gt;
 1 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       1    87
 2 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       2    82
 3 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       3    72
 4 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       4    77
 5 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       5    87
 6 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       6    94
 7 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26       7    99
 8 2Ge+her The Hardest Part Of ... 2000-09-02       1    91
 9 2Ge+her The Hardest Part Of ... 2000-09-02       2    87
10 2Ge+her The Hardest Part Of ... 2000-09-02       3    92
# ... with 5,297 more rows</code></pre>
<div class="sourceCode" id="cb1449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1449-1" title="1"><span class="co"># 연습: wide_01 데이터에서 year을 정수형으로 변환(mutate 함수 사용하지 않고)</span></a></code></pre></div>

<ol start="2" style="list-style-type: decimal">
<li><strong>두 개 이상의 변수에 해당하는 값이 하나의 열에 저장</strong>
<ul>
<li>예시 데이터: <strong>tidyr</strong> 패키지에 내장되어 있는 <code>who</code> 데이터셋(<code>help(who)</code>를 통해 데이터 설명 참고)</li>
</ul></li>
</ol>

<pre><code># A tibble: 7,240 x 60
   country iso2  iso3   year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;       &lt;int&gt;        &lt;int&gt;        &lt;int&gt;        &lt;int&gt;
 1 Afghan~ AF    AFG    1980          NA           NA           NA           NA
 2 Afghan~ AF    AFG    1981          NA           NA           NA           NA
 3 Afghan~ AF    AFG    1982          NA           NA           NA           NA
 4 Afghan~ AF    AFG    1983          NA           NA           NA           NA
 5 Afghan~ AF    AFG    1984          NA           NA           NA           NA
 6 Afghan~ AF    AFG    1985          NA           NA           NA           NA
 7 Afghan~ AF    AFG    1986          NA           NA           NA           NA
 8 Afghan~ AF    AFG    1987          NA           NA           NA           NA
 9 Afghan~ AF    AFG    1988          NA           NA           NA           NA
10 Afghan~ AF    AFG    1989          NA           NA           NA           NA
# ... with 7,230 more rows, and 52 more variables: new_sp_m4554 &lt;int&gt;,
#   new_sp_m5564 &lt;int&gt;, new_sp_m65 &lt;int&gt;, new_sp_f014 &lt;int&gt;,
#   new_sp_f1524 &lt;int&gt;, new_sp_f2534 &lt;int&gt;, new_sp_f3544 &lt;int&gt;,
#   new_sp_f4554 &lt;int&gt;, new_sp_f5564 &lt;int&gt;, new_sp_f65 &lt;int&gt;,
#   new_sn_m014 &lt;int&gt;, new_sn_m1524 &lt;int&gt;, new_sn_m2534 &lt;int&gt;,
#   new_sn_m3544 &lt;int&gt;, new_sn_m4554 &lt;int&gt;, new_sn_m5564 &lt;int&gt;,
#   new_sn_m65 &lt;int&gt;, new_sn_f014 &lt;int&gt;, new_sn_f1524 &lt;int&gt;,
#   new_sn_f2534 &lt;int&gt;, new_sn_f3544 &lt;int&gt;, new_sn_f4554 &lt;int&gt;,
#   new_sn_f5564 &lt;int&gt;, new_sn_f65 &lt;int&gt;, new_ep_m014 &lt;int&gt;,
#   new_ep_m1524 &lt;int&gt;, new_ep_m2534 &lt;int&gt;, new_ep_m3544 &lt;int&gt;,
#   new_ep_m4554 &lt;int&gt;, new_ep_m5564 &lt;int&gt;, new_ep_m65 &lt;int&gt;,
#   new_ep_f014 &lt;int&gt;, new_ep_f1524 &lt;int&gt;, new_ep_f2534 &lt;int&gt;,
#   new_ep_f3544 &lt;int&gt;, new_ep_f4554 &lt;int&gt;, new_ep_f5564 &lt;int&gt;,
#   new_ep_f65 &lt;int&gt;, newrel_m014 &lt;int&gt;, newrel_m1524 &lt;int&gt;,
#   newrel_m2534 &lt;int&gt;, newrel_m3544 &lt;int&gt;, newrel_m4554 &lt;int&gt;,
#   newrel_m5564 &lt;int&gt;, newrel_m65 &lt;int&gt;, newrel_f014 &lt;int&gt;,
#   newrel_f1524 &lt;int&gt;, newrel_f2534 &lt;int&gt;, newrel_f3544 &lt;int&gt;,
#   newrel_f4554 &lt;int&gt;, newrel_f5564 &lt;int&gt;, newrel_f65 &lt;int&gt;</code></pre>
<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-91">Table 4.11: </span>tidyr 패키지 내장 데이터 who 코드 설명
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수명
</th>
<th style="text-align:left;">
변수설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
country
</td>
<td style="text-align:left;width: 6cm; font-family: monospace;">
국가명
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
iso2, iso3
</td>
<td style="text-align:left;width: 6cm; font-family: monospace;">
2자리 또는 3자리 국가코드
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
year
</td>
<td style="text-align:left;width: 6cm; font-family: monospace;">
년도
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
new_sp_m014 - newrel_f65
</td>
<td style="text-align:left;width: 6cm; font-family: monospace;">
변수 접두사: new_ 또는 new;
진단명: sp = positive pulmonary smear,
sn = negative pulmonary smear,
ep = extrapulmonary, rel = relapse;
성별: m = male, f = female;
연령대: 014 = 0-14 yrs,
1524 = 14-24 yrs,
2534 = 25-34 yrs,
3544 = 35-44 yrs,
4554 = 45-54 yrs,
5564 = 55-64 yrs,
65 = 65 yrs or older
</td>
</tr>
</tbody>
</table>

<ul>
<li>데이터 정돈 전략(<code>pivot_longer()</code> 이용)
<ol style="list-style-type: decimal">
<li><code>country</code>, <code>iso2</code>, <code>iso3</code>, <code>year</code>은 정상적인 변수 형태임 <span class="math inline">\(\rightarrow\)</span> 그대로 둔다</li>
<li><code>names_to</code> 인수에 <code>diagnosis</code>, <code>sex</code>, <code>age_group</code>로 변수명을 지정</li>
<li><code>names_prefix</code> 인수에서 접두어 제거</li>
<li><code>names_pattern</code> 인수에서 추출한 변수의 패턴을 정규표현식을 이용해 표현(각 변수는 <code>()</code>으로 구분) <span class="math inline">\(\rightarrow\)</span> <code>_</code>를 기준으로 왼쪽에는 (소문자 알파벳이 하나 이상 존재하고), 오른쪽에는 (m 또는 f)와 (숫자가 1개 이상)인 패턴</li>
<li><code>names_ptypes</code> 인수를 이용해 생성한 변수의 데이터 타입 지정
<ul>
<li><code>diagnosis</code>: factor</li>
<li><code>sex</code>: factor</li>
<li><code>age_group</code>: factor</li>
</ul></li>
<li><code>values_to</code> 인수에 longer 형태로 변환 후 생성된 값을 저장한 열(변수) 이름 <code>count</code> 지정</li>
<li><code>values_drop_na</code> 인수를 이용해 결측 제거</li>
</ol></li>
</ul>

<div class="sourceCode" id="cb1451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1451-1" title="1"><span class="co"># pivot_longer()를 이용해 who 데이터셋 데이터 정돈</span></a>
<a class="sourceLine" id="cb1451-2" title="2">who_tidy &lt;-<span class="st"> </span>who <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1451-3" title="3"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb1451-4" title="4">    new_sp_m014<span class="op">:</span>newrel_f65,</a>
<a class="sourceLine" id="cb1451-5" title="5">    <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age_group&quot;</span>),</a>
<a class="sourceLine" id="cb1451-6" title="6">    <span class="dt">names_prefix =</span> <span class="st">&quot;^new_?&quot;</span>,</a>
<a class="sourceLine" id="cb1451-7" title="7">    <span class="dt">names_pattern =</span> <span class="st">&quot;([a-z]+)_(m|f)([0-9]+)&quot;</span>,</a>
<a class="sourceLine" id="cb1451-8" title="8">    <span class="dt">names_ptypes =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb1451-9" title="9">      <span class="dt">diagnosis =</span> <span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;rel&quot;</span>, <span class="st">&quot;sn&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;ep&quot;</span>)),</a>
<a class="sourceLine" id="cb1451-10" title="10">      <span class="dt">sex =</span> <span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>)),</a>
<a class="sourceLine" id="cb1451-11" title="11">      <span class="dt">age_group =</span> <span class="kw">factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;014&quot;</span>, <span class="st">&quot;1524&quot;</span>, <span class="st">&quot;2534&quot;</span>, <span class="st">&quot;3544&quot;</span>,</a>
<a class="sourceLine" id="cb1451-12" title="12">                                    <span class="st">&quot;4554&quot;</span>, <span class="st">&quot;5564&quot;</span>, <span class="st">&quot;65&quot;</span>),</a>
<a class="sourceLine" id="cb1451-13" title="13">                         <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1451-14" title="14">    ),</a>
<a class="sourceLine" id="cb1451-15" title="15">    <span class="dt">values_to =</span> <span class="st">&quot;count&quot;</span>,</a>
<a class="sourceLine" id="cb1451-16" title="16">    <span class="dt">values_drop_na =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb1451-17" title="17">  )</a>
<a class="sourceLine" id="cb1451-18" title="18"></a>
<a class="sourceLine" id="cb1451-19" title="19">who_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 76,046 x 8
   country     iso2  iso3   year diagnosis sex   age_group count
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt;     &lt;fct&gt; &lt;ord&gt;     &lt;int&gt;
 1 Afghanistan AF    AFG    1997 sp        m     014           0
 2 Afghanistan AF    AFG    1997 sp        m     1524         10
 3 Afghanistan AF    AFG    1997 sp        m     2534          6
 4 Afghanistan AF    AFG    1997 sp        m     3544          3
 5 Afghanistan AF    AFG    1997 sp        m     4554          5
 6 Afghanistan AF    AFG    1997 sp        m     5564          2
 7 Afghanistan AF    AFG    1997 sp        m     65            0
 8 Afghanistan AF    AFG    1997 sp        f     014           5
 9 Afghanistan AF    AFG    1997 sp        f     1524         38
10 Afghanistan AF    AFG    1997 sp        f     2534         36
# ... with 76,036 more rows</code></pre>

</div>
</div>
<div id="wider-format" class="section level3">
<h3><span class="header-section-number">4.5.3</span> Wide format</h3>
<ul>
<li>long format의 반대가 되는 데이터 형태</li>
<li>관측 단위의 측정값(예: 다수 변수들)이 다중 행으로 구성된 경우 tidy data를 만들기 위해 wide format으로 데이터 변환 요구</li>
<li>요약표 생성 시 유용하게 사용</li>
<li>“long” 형태의 데이터를 “wide” 형태로 변환 해주는 tidyr 패키지 내장 함수는
<ul>
<li><strong><code>pivot_wider()</code></strong>: 데이터의 행을 줄이고 열의 개수를 늘리는 함수</li>
<li><code>spread()</code>: <code>pivot_wider()</code>의 이전 버전</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1453-1" title="1"><span class="co"># pivot_wider()의 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1453-2" title="2"><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1453-3" title="3">  data, <span class="co"># 데이터 프레임</span></a>
<a class="sourceLine" id="cb1453-4" title="4">  names_from, <span class="co"># 출력 시 변수명으로 사용할 값을 갖고 있는 열 이름</span></a>
<a class="sourceLine" id="cb1453-5" title="5">  values_from, <span class="co"># 위에서 선택한 변수의 각 셀에 대응하는 측정 값을 포함하는 열 이름</span></a>
<a class="sourceLine" id="cb1453-6" title="6">  values_fill <span class="co">#</span></a>
<a class="sourceLine" id="cb1453-7" title="7">)</a>
<a class="sourceLine" id="cb1453-8" title="8"></a>
<a class="sourceLine" id="cb1453-9" title="9"><span class="co"># spread() 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1453-10" title="10"><span class="kw">spread</span>(</a>
<a class="sourceLine" id="cb1453-11" title="11">  data, <span class="co"># 데이터 프레임</span></a>
<a class="sourceLine" id="cb1453-12" title="12">  key, <span class="co"># 출력 시 변수명으로 사용할 값을 갖고 있는 열 이름</span></a>
<a class="sourceLine" id="cb1453-13" title="13">  value <span class="co"># 위에서 선택한 변수의 각 셀에 대응하는 측정 값을 포함하는 열 이름</span></a>
<a class="sourceLine" id="cb1453-14" title="14">)</a></code></pre></div>


<p><img src="figures/tidyr-pivot_wider.png" width="90%" style="display: block; margin: auto;" /></p>

<div id="wide-format-ex" class="section level4 unnumbered">
<h4><strong>Examples</strong></h4>
<ol style="list-style-type: decimal">
<li><code>pivot_longer()</code>와의 관계</li>
</ol>

<div class="sourceCode" id="cb1454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1454-1" title="1"><span class="co"># 위 예시에서 생성한 tidy_ex_01 데이터 예시</span></a>
<a class="sourceLine" id="cb1454-2" title="2"><span class="co">## long format으로 변환한 데이터를 다시 wide format으로 변경</span></a>
<a class="sourceLine" id="cb1454-3" title="3"><span class="co">## pivot_wider() 함수</span></a>
<a class="sourceLine" id="cb1454-4" title="4"></a>
<a class="sourceLine" id="cb1454-5" title="5">wide_ex_<span class="dv">01</span> &lt;-<span class="st"> </span>tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1454-6" title="6"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1454-7" title="7">    <span class="dt">names_from =</span> year,</a>
<a class="sourceLine" id="cb1454-8" title="8">    <span class="dt">values_from =</span> gdp_cap</a>
<a class="sourceLine" id="cb1454-9" title="9">  )</a>
<a class="sourceLine" id="cb1454-10" title="10">wide_ex_<span class="dv">01</span> <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 21
  country `2001` `2002` `2003` `2004` `2005` `2006` `2007` `2008` `2009` `2010`
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Germany 37325. 37262. 36977. 37418. 37704. 39143. 40474. 40989. 38784. 40429.
2 South ~ 21530. 22997. 23549. 24606. 25517. 26697. 28014. 28588. 28643. 30352.
3 United~ 45663. 46029. 46941. 48275. 49513. 50438. 50898. 50350. 48644. 49479.
# ... with 10 more variables: `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, `2013` &lt;dbl&gt;,
#   `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;, `2018` &lt;dbl&gt;,
#   `2019` &lt;dbl&gt;, `2020` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb1456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1456-1" title="1"><span class="co">## 데이터 동일성 확인</span></a>
<a class="sourceLine" id="cb1456-2" title="2"><span class="kw">all.equal</span>(wide_<span class="dv">01</span>, wide_ex_<span class="dv">01</span>)</a></code></pre></div>
<pre><code>[1] &quot;Attributes: &lt; Length mismatch: comparison on first 2 components &gt;&quot;                     
[2] &quot;Attributes: &lt; Component \&quot;class\&quot;: Lengths (4, 3) differ (string compare on first 3) &gt;&quot;
[3] &quot;Attributes: &lt; Component \&quot;class\&quot;: 3 string mismatches &gt;&quot;                              </code></pre>
<div class="sourceCode" id="cb1458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1458-1" title="1"><span class="co">## spread() 함수</span></a>
<a class="sourceLine" id="cb1458-2" title="2">wide_ex_<span class="dv">01</span> &lt;-<span class="st"> </span>tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1458-3" title="3"><span class="st">  </span><span class="kw">spread</span>(year, gdp_cap)</a>
<a class="sourceLine" id="cb1458-4" title="4"></a>
<a class="sourceLine" id="cb1458-5" title="5"><span class="kw">all.equal</span>(wide_<span class="dv">01</span>, wide_ex_<span class="dv">01</span>)</a></code></pre></div>
<pre><code>[1] &quot;Attributes: &lt; Length mismatch: comparison on first 2 components &gt;&quot;                     
[2] &quot;Attributes: &lt; Component \&quot;class\&quot;: Lengths (4, 3) differ (string compare on first 3) &gt;&quot;
[3] &quot;Attributes: &lt; Component \&quot;class\&quot;: 3 string mismatches &gt;&quot;                              </code></pre>

<ol start="2" style="list-style-type: decimal">
<li>관측 단위의 측정값(예: 다수 변수들)이 다중 행으로 구성된 데이터 구조 변환
<ul>
<li>예시 데이터: <strong>tidyr</strong> 패키지 <code>table2</code> 데이터셋</li>
</ul></li>
</ol>

<div class="sourceCode" id="cb1460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1460-1" title="1"><span class="co"># table2 데이터셋 check</span></a>
<a class="sourceLine" id="cb1460-2" title="2">table2 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 12 x 4
   country      year type            count
   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
<div class="sourceCode" id="cb1462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1462-1" title="1"><span class="co"># type 변수의 값은 사실 관측 단위의 변수임</span></a>
<a class="sourceLine" id="cb1462-2" title="2"><span class="co"># type 값에 대응하는 값을 가진 변수는 count 임</span></a>
<a class="sourceLine" id="cb1462-3" title="3"><span class="co">## 데이터 정돈(pivot_wider() 사용)</span></a>
<a class="sourceLine" id="cb1462-4" title="4"></a>
<a class="sourceLine" id="cb1462-5" title="5">table2_tidy &lt;-<span class="st"> </span>table2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1462-6" title="6"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1462-7" title="7">    <span class="dt">names_from =</span> type,</a>
<a class="sourceLine" id="cb1462-8" title="8">    <span class="dt">values_from =</span> count</a>
<a class="sourceLine" id="cb1462-9" title="9">  )</a>
<a class="sourceLine" id="cb1462-10" title="10">table2_tidy <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>

<ol start="3" style="list-style-type: decimal">
<li>데이터 요약 테이블
<ul>
<li>예시 데이터: <code>mtcars</code> 데이터셋</li>
</ul></li>
</ol>
<!-- - 사이버 캠퍼스 자료실 또는 [Github](https://github.com/zorba78/cnu-r-programming-lecture-note/dataset/gapminder/gapminder_filter.csv)에서 확인 및 다운로드 가능 -->

<div class="sourceCode" id="cb1464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1464-1" title="1"><span class="co"># 1) mtcars 데이터셋: 행 이름을 변수로 변환 후 long format 변환</span></a>
<a class="sourceLine" id="cb1464-2" title="2"><span class="co">## rownames_to_column() 함수 사용</span></a>
<a class="sourceLine" id="cb1464-3" title="3">mtcars2 &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-4" title="4"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;model&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-5" title="5"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb1464-6" title="6">    <span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;vs&quot;</span>, <span class="st">&quot;am&quot;</span>),</a>
<a class="sourceLine" id="cb1464-7" title="7">    <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>,</a>
<a class="sourceLine" id="cb1464-8" title="8">    <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span></a>
<a class="sourceLine" id="cb1464-9" title="9">  )</a>
<a class="sourceLine" id="cb1464-10" title="10"></a>
<a class="sourceLine" id="cb1464-11" title="11"><span class="co"># 2) 엔진 유형 별 variable의 평균과 표준편차 계산</span></a>
<a class="sourceLine" id="cb1464-12" title="12"><span class="co"># &quot;사람&quot;이 읽기 편한 형태로 테이블 변경</span></a>
<a class="sourceLine" id="cb1464-13" title="13">mtcars2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-14" title="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vs =</span> <span class="kw">factor</span>(vs,</a>
<a class="sourceLine" id="cb1464-15" title="15">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;V-shaped&quot;</span>,</a>
<a class="sourceLine" id="cb1464-16" title="16">                                <span class="st">&quot;Straight&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-17" title="17"><span class="st">  </span><span class="kw">group_by</span>(vs, variable) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-18" title="18"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">mean</span>(value),</a>
<a class="sourceLine" id="cb1464-19" title="19">            <span class="dt">SD =</span> <span class="kw">sd</span>(value)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-20" title="20"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb1464-21" title="21">    Mean<span class="op">:</span>SD,</a>
<a class="sourceLine" id="cb1464-22" title="22">    <span class="dt">names_to =</span> <span class="st">&quot;stat&quot;</span>,</a>
<a class="sourceLine" id="cb1464-23" title="23">    <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span></a>
<a class="sourceLine" id="cb1464-24" title="24">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1464-25" title="25"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1464-26" title="26">    <span class="dt">names_from =</span> variable,</a>
<a class="sourceLine" id="cb1464-27" title="27">    <span class="dt">values_from =</span> value</a>
<a class="sourceLine" id="cb1464-28" title="28">  )</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;vs&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["vs"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["stat"],"name":[2],"type":["chr"],"align":["left"]},{"label":["carb"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["mpg"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"V-shaped","2":"Mean","3":"3.611111","4":"7.4444444","5":"307.15000","6":"3.3922222","7":"3.5555556","8":"189.72222","9":"16.616667","10":"16.693889","11":"3.6885556"},{"1":"V-shaped","2":"SD","3":"1.539247","4":"1.1490263","5":"106.76522","6":"0.4739515","7":"0.8555853","8":"60.28150","9":"3.860699","10":"1.091896","11":"0.9040308"},{"1":"Straight","2":"Mean","3":"1.785714","4":"4.5714286","5":"132.45714","6":"3.8592857","7":"3.8571429","8":"91.35714","9":"24.557143","10":"19.333571","11":"2.6112857"},{"1":"Straight","2":"SD","3":"1.050902","4":"0.9376145","5":"56.89324","6":"0.5057890","7":"0.5345225","8":"24.42447","9":"5.378978","10":"1.354415","11":"0.7150100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1466-1" title="1"><span class="co"># 조금 더 응용...</span></a>
<a class="sourceLine" id="cb1466-2" title="2"><span class="co">## 위 Mean ± SD 형태로 위와 유사한 구조의 테이블 생성</span></a>
<a class="sourceLine" id="cb1466-3" title="3"><span class="co">### tip: 한글로 &quot;ㄷ(e) + 한자&quot; 통해 ± 입력 가능</span></a>
<a class="sourceLine" id="cb1466-4" title="4"></a>
<a class="sourceLine" id="cb1466-5" title="5">mtcars2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vs =</span> <span class="kw">factor</span>(vs,</a>
<a class="sourceLine" id="cb1466-7" title="7">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;V-shaped&quot;</span>,</a>
<a class="sourceLine" id="cb1466-8" title="8">                                <span class="st">&quot;Straight&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-9" title="9"><span class="st">  </span><span class="kw">group_by</span>(vs, variable) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-10" title="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">mean</span>(value),</a>
<a class="sourceLine" id="cb1466-11" title="11">            <span class="dt">SD =</span> <span class="kw">sd</span>(value)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">res =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%.1f ± %.1f&quot;</span>,</a>
<a class="sourceLine" id="cb1466-13" title="13">                       Mean, SD)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-14" title="14"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(Mean<span class="op">:</span>SD)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1466-15" title="15"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1466-16" title="16">    <span class="dt">names_from =</span> variable,</a>
<a class="sourceLine" id="cb1466-17" title="17">    <span class="dt">values_from =</span> res</a>
<a class="sourceLine" id="cb1466-18" title="18">  )</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;vs&#39; (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["vs"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["carb"],"name":[2],"type":["chr"],"align":["left"]},{"label":["cyl"],"name":[3],"type":["chr"],"align":["left"]},{"label":["disp"],"name":[4],"type":["chr"],"align":["left"]},{"label":["drat"],"name":[5],"type":["chr"],"align":["left"]},{"label":["gear"],"name":[6],"type":["chr"],"align":["left"]},{"label":["hp"],"name":[7],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[8],"type":["chr"],"align":["left"]},{"label":["qsec"],"name":[9],"type":["chr"],"align":["left"]},{"label":["wt"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"V-shaped","2":"3.6 ± 1.5","3":"7.4 ± 1.1","4":"307.1 ± 106.8","5":"3.4 ± 0.5","6":"3.6 ± 0.9","7":"189.7 ± 60.3","8":"16.6 ± 3.9","9":"16.7 ± 1.1","10":"3.7 ± 0.9"},{"1":"Straight","2":"1.8 ± 1.1","3":"4.6 ± 0.9","4":"132.5 ± 56.9","5":"3.9 ± 0.5","6":"3.9 ± 0.5","7":"91.4 ± 24.4","8":"24.6 ± 5.4","9":"19.3 ± 1.4","10":"2.6 ± 0.7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
</div>
<div id="separate-unite" class="section level3">
<h3><span class="header-section-number">4.5.4</span> Separate and unite</h3>
<ul>
<li>하나의 열을 구성하는 값이 두 개 이상 변수가 혼합되어 한 셀에 표현된 경우 이를 분리해야 할 필요가 있음 <span class="math inline">\(\rightarrow\)</span> <strong><code>separate()</code></strong></li>
<li>하나의 변수에 대한 값으로 표현할 수 있음에도 불구하고 두 개 이상의 변수로 구성된 경우(예: 날짜 변수의 경우 간혹 <code>year</code>, <code>month</code>,<code>day</code>와 같이 3 개의 변수로 분리), 이를 연결하여 하나의 변수로 변경 필요 <span class="math inline">\(\rightarrow\)</span> <strong><code>unite()</code></strong></li>
</ul>
<div id="saparate" class="section level4 unnumbered">
<h4>Separate</h4>
<ul>
<li><code>separate()</code>: 지정한 구분 문자가 존재하는 경우 이를 쪼개서 하나의 열을 다수의 열로 분리</li>
</ul>

<div class="sourceCode" id="cb1468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1468-1" title="1"><span class="co"># separate() 함수 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1468-2" title="2"><span class="kw">seprate</span>(</a>
<a class="sourceLine" id="cb1468-3" title="3">  data, <span class="co"># 데이터 프레임</span></a>
<a class="sourceLine" id="cb1468-4" title="4">  col, <span class="co"># 분리 대상이 되는 열 이름</span></a>
<a class="sourceLine" id="cb1468-5" title="5">  into, <span class="co"># 분리 후 새로 생성한 열들에 대한 이름(문자형 벡터) 지정</span></a>
<a class="sourceLine" id="cb1468-6" title="6">  <span class="dt">sep =</span> <span class="st">&quot;[^[:alnum:]]+&quot;</span>, <span class="co"># 구분자: 기본적으로 정규표현식 사용</span></a>
<a class="sourceLine" id="cb1468-7" title="7">  convert <span class="co"># 분리한 열의 데이터 타입 변환 여부</span></a>
<a class="sourceLine" id="cb1468-8" title="8">)</a></code></pre></div>

<ul>
<li>예시: tidyr 패키지 <code>table3</code> 데이터셋</li>
</ul>

<div class="sourceCode" id="cb1469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1469-1" title="1"><span class="co"># table3 데이터 체크</span></a>
<a class="sourceLine" id="cb1469-2" title="2">table3 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 3
  country      year rate             
* &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
<div class="sourceCode" id="cb1471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1471-1" title="1"><span class="co"># rate 변수를 case와 population으로 분리</span></a>
<a class="sourceLine" id="cb1471-2" title="2">table3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1471-3" title="3"><span class="st">  </span><span class="kw">separate</span>(rate,</a>
<a class="sourceLine" id="cb1471-4" title="4">           <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;population&quot;</span>),</a>
<a class="sourceLine" id="cb1471-5" title="5">           <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1471-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year case   population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode" id="cb1473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1473-1" title="1">table3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1473-2" title="2"><span class="st">  </span><span class="kw">separate</span>(rate,</a>
<a class="sourceLine" id="cb1473-3" title="3">           <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;population&quot;</span>),</a>
<a class="sourceLine" id="cb1473-4" title="4">           <span class="dt">convert =</span> <span class="ot">TRUE</span>) -&gt;<span class="st"> </span>table3_sep</a>
<a class="sourceLine" id="cb1473-5" title="5"></a>
<a class="sourceLine" id="cb1473-6" title="6"><span class="co">## sep 인수값이 수치형 백터인 경우 분리할 위치로 인식</span></a>
<a class="sourceLine" id="cb1473-7" title="7"><span class="co">## 양수: 문자열 맨 왼쪽에서 1부터 시작</span></a>
<a class="sourceLine" id="cb1473-8" title="8"><span class="co">## 음수: 문자열 맨 오른쪽에서 -1부터 시작</span></a>
<a class="sourceLine" id="cb1473-9" title="9"><span class="co">## sep의 길이(length)는 into 인수의 길이보다 작아야 함</span></a>
<a class="sourceLine" id="cb1473-10" title="10"></a>
<a class="sourceLine" id="cb1473-11" title="11"><span class="co"># year 변수를 century와 year로 분할</span></a>
<a class="sourceLine" id="cb1473-12" title="12">table3 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1473-13" title="13"><span class="st">  </span><span class="kw">separate</span>(year,</a>
<a class="sourceLine" id="cb1473-14" title="14">           <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;century&quot;</span>, <span class="st">&quot;year&quot;</span>),</a>
<a class="sourceLine" id="cb1473-15" title="15">           <span class="dt">sep =</span> <span class="dv">-2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1473-16" title="16"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>

</div>
<div id="unite" class="section level4 unnumbered">
<h4>Unite</h4>
<ul>
<li><code>unite()</code>: <code>seprate()</code> 함수의 반대 기능을 수행하며, 다수 변수를 결합</li>
</ul>

<div class="sourceCode" id="cb1475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1475-1" title="1"><span class="co"># unite() 기본 사용 형태</span></a>
<a class="sourceLine" id="cb1475-2" title="2"><span class="kw">unite</span>(</a>
<a class="sourceLine" id="cb1475-3" title="3">  data, <span class="co"># 데이터프레임</span></a>
<a class="sourceLine" id="cb1475-4" title="4">  ..., <span class="co"># 선택한 열 이름</span></a>
<a class="sourceLine" id="cb1475-5" title="5">  sep, <span class="co"># 연결 구분자</span></a>
<a class="sourceLine" id="cb1475-6" title="6">)</a></code></pre></div>

<ul>
<li>예제: tidyr 패키지 <code>table5</code> 데이터셋</li>
</ul>

<div class="sourceCode" id="cb1476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1476-1" title="1"><span class="co"># table5 체크</span></a>
<a class="sourceLine" id="cb1476-2" title="2">table5 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  country     century year  rate             
* &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
<div class="sourceCode" id="cb1478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1478-1" title="1"><span class="co"># century와 year을 결합한 new 변수 생성</span></a>
<a class="sourceLine" id="cb1478-2" title="2">table5 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1478-3" title="3"><span class="st">  </span><span class="kw">unite</span>(new, century, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1478-4" title="4"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     new   rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19_99 745/19987071     
2 Afghanistan 20_00 2666/20595360    
3 Brazil      19_99 37737/172006362  
4 Brazil      20_00 80488/174504898  
5 China       19_99 212258/1272915272
6 China       20_00 213766/1280428583</code></pre>
<div class="sourceCode" id="cb1480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1480-1" title="1"><span class="co"># _없이 결합 후 new를 정수형으로 변환</span></a>
<a class="sourceLine" id="cb1480-2" title="2">table5 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1480-3" title="3"><span class="st">  </span><span class="kw">unite</span>(new, century, year, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1480-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">new =</span> <span class="kw">as.integer</span>(new)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1480-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 3
  country       new rate             
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
<div class="sourceCode" id="cb1482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1482-1" title="1"><span class="co"># table5 데이터 정돈(separate(), unite() 동시 사용)</span></a>
<a class="sourceLine" id="cb1482-2" title="2">table5 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1482-3" title="3"><span class="st">  </span><span class="kw">unite</span>(new, century, year, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1482-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">new =</span> <span class="kw">as.integer</span>(new)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1482-5" title="5"><span class="st">  </span><span class="kw">separate</span>(rate, <span class="kw">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;population&quot;</span>),</a>
<a class="sourceLine" id="cb1482-6" title="6">           <span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1482-7" title="7"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  country       new   case population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>

<ul>
<li>응용 예제: <code>mtcars</code> 데이터셋에서 계산한 통계량 정리</li>
</ul>

<div class="sourceCode" id="cb1484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1484-1" title="1"><span class="co"># 기어 종류(`am`) 별 `mpg`, `cyl`, `disp`, `hp`, `drat`, `wt`, `qsec`의</span></a>
<a class="sourceLine" id="cb1484-2" title="2"><span class="co"># 평균과 표준편차 계산</span></a>
<a class="sourceLine" id="cb1484-3" title="3">mtcar_summ1 &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1484-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">am =</span> <span class="kw">factor</span>(am,</a>
<a class="sourceLine" id="cb1484-5" title="5">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;automatic&quot;</span>, <span class="st">&quot;manual&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1484-6" title="6"><span class="st">  </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1484-7" title="7"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(mpg<span class="op">:</span>qsec),</a>
<a class="sourceLine" id="cb1484-8" title="8">               <span class="kw">list</span>(<span class="dt">mean =</span> <span class="op">~</span><span class="st"> </span><span class="kw">mean</span>(.),</a>
<a class="sourceLine" id="cb1484-9" title="9">                    <span class="dt">sd =</span> <span class="op">~</span><span class="st"> </span><span class="kw">sd</span>(.)))</a>
<a class="sourceLine" id="cb1484-10" title="10">mtcar_summ1 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 2 x 15
  am    mpg_mean cyl_mean disp_mean hp_mean drat_mean wt_mean qsec_mean mpg_sd
  &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 auto~     17.1     6.95      290.    160.      3.29    3.77      18.2   3.83
2 manu~     24.4     5.08      144.    127.      4.05    2.41      17.4   6.17
# ... with 6 more variables: cyl_sd &lt;dbl&gt;, disp_sd &lt;dbl&gt;, hp_sd &lt;dbl&gt;,
#   drat_sd &lt;dbl&gt;, wt_sd &lt;dbl&gt;, qsec_sd &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb1486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1486-1" title="1"><span class="co"># am을 제외한 모든 변수에 대해 long format으로 데이터 변환</span></a>
<a class="sourceLine" id="cb1486-2" title="2">mtcar_summ2 &lt;-<span class="st"> </span>mtcar_summ1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1486-3" title="3"><span class="st">  </span><span class="kw">pivot_longer</span>(</a>
<a class="sourceLine" id="cb1486-4" title="4">    <span class="op">-</span>am,</a>
<a class="sourceLine" id="cb1486-5" title="5">    <span class="dt">names_to =</span> <span class="st">&quot;stat&quot;</span>,</a>
<a class="sourceLine" id="cb1486-6" title="6">    <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span></a>
<a class="sourceLine" id="cb1486-7" title="7">  )</a>
<a class="sourceLine" id="cb1486-8" title="8">mtcar_summ2 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 28 x 3
   am        stat       value
   &lt;fct&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 automatic mpg_mean   17.1 
 2 automatic cyl_mean    6.95
 3 automatic disp_mean 290.  
 4 automatic hp_mean   160.  
 5 automatic drat_mean   3.29
 6 automatic wt_mean     3.77
 7 automatic qsec_mean  18.2 
 8 automatic mpg_sd      3.83
 9 automatic cyl_sd      1.54
10 automatic disp_sd   110.  
# ... with 18 more rows</code></pre>
<div class="sourceCode" id="cb1488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1488-1" title="1"><span class="co"># stat 변수를 &quot;variable&quot;, &quot;statistic&quot;으로 분리 후</span></a>
<a class="sourceLine" id="cb1488-2" title="2"><span class="co"># variable과 value를 wide format으로 데이터 변환</span></a>
<a class="sourceLine" id="cb1488-3" title="3">mtcar_summ3 &lt;-<span class="st"> </span>mtcar_summ2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1488-4" title="4"><span class="st">  </span><span class="kw">separate</span>(stat, <span class="kw">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;statistic&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1488-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb1488-6" title="6">    <span class="dt">names_from =</span> variable,</a>
<a class="sourceLine" id="cb1488-7" title="7">    <span class="dt">values_from =</span> value</a>
<a class="sourceLine" id="cb1488-8" title="8">  )</a>
<a class="sourceLine" id="cb1488-9" title="9">mtcar_summ3 <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 4 x 9
  am        statistic   mpg   cyl  disp    hp  drat    wt  qsec
  &lt;fct&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 automatic mean      17.1   6.95 290.  160.  3.29  3.77  18.2 
2 automatic sd         3.83  1.54 110.   53.9 0.392 0.777  1.75
3 manual    mean      24.4   5.08 144.  127.  4.05  2.41  17.4 
4 manual    sd         6.17  1.55  87.2  84.1 0.364 0.617  1.79</code></pre>

<p><strong>Tidy data</strong>를 만들기 위한 과정이 꼭 필요할까? <span class="math inline">\(\rightarrow\)</span> long format 데이터가 정말 필요할까?</p>
<blockquote>
<p>ggplot trailer: <a href="data-transformation.html#long-format">4.5.2</a> 절 Long format 에서 예시 데이터로 활용한 <code>wide-01</code> 데이터 셋을 이용해 국가별 연도에 따른 일인당 국민소득 추이를 시각화</p>
<p><strong>Strategy</strong></p>
<ul>
<li><code>wide-01</code> 데이터 형태 그대로 시각화</li>
<li><code>wide-01</code>을 long format으로 변환한 <code>tidy_ex_01</code> 에서 시각화</li>
</ul>
</blockquote>

<div class="sourceCode" id="cb1490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1490-1" title="1"><span class="co"># ggplot trailer</span></a>
<a class="sourceLine" id="cb1490-2" title="2">tidy_ex_<span class="dv">01</span> &lt;-<span class="st"> </span>wide_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1490-3" title="3"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">2001</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2020</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1490-4" title="4">               <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>,</a>
<a class="sourceLine" id="cb1490-5" title="5">               <span class="dt">values_to =</span> <span class="st">&quot;gdp_cap&quot;</span>,</a>
<a class="sourceLine" id="cb1490-6" title="6">               <span class="dt">names_transform =</span> <span class="kw">list</span>(<span class="dt">year =</span> as.integer))</a>
<a class="sourceLine" id="cb1490-7" title="7">tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1490-8" title="8"><span class="st">  </span>ggplot <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-9" title="9"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gdp_cap,</a>
<a class="sourceLine" id="cb1490-10" title="10">      <span class="dt">color =</span> country,</a>
<a class="sourceLine" id="cb1490-11" title="11">      <span class="dt">group =</span> country) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-12" title="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-13" title="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb1490-15" title="15">       <span class="dt">y =</span> <span class="st">&quot;Total GDP/captia&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-16" title="16"><span class="st">  </span><span class="kw">theme_classic</span>()</a>
<a class="sourceLine" id="cb1490-17" title="17"></a>
<a class="sourceLine" id="cb1490-18" title="18">tidy_ex_<span class="dv">01</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1490-19" title="19"><span class="st">  </span>ggplot <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-20" title="20"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> gdp_cap,</a>
<a class="sourceLine" id="cb1490-21" title="21">      <span class="dt">group =</span> country) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-22" title="22"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-23" title="23"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-24" title="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>,</a>
<a class="sourceLine" id="cb1490-25" title="25">       <span class="dt">y =</span> <span class="st">&quot;Total GDP/captia&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-26" title="26"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>country) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-27" title="27"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="04-data-manupulation_files/figure-html/unnamed-chunk-103-1.svg" width="672" /><img src="04-data-manupulation_files/figure-html/unnamed-chunk-103-2.svg" width="672" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wickham-2007p">
<p>Wickham, Hadley. 2007. “Reshaping Data with the reshape Package.” <em>Journal of Statistical Software</em> 21 (12): 1–20. <a href="http://www.jstatsoft.org/v21/i12/">http://www.jstatsoft.org/v21/i12/</a>.</p>
</div>
<div id="ref-wickham-2014p">
<p>Wickham, Hadley, and others. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10): 1–23.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-04.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zorba78/cnu-r-programming-lecture-note/04-data-manupulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cnu-r-programming.pdf", "cnu-r-programming.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
