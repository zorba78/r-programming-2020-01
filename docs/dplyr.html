<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 dplyr 패키지 | 통계 프로그래밍 언어</title>
  <meta name="description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 dplyr 패키지 | 통계 프로그래밍 언어" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  <meta name="github-repo" content="zorba78/cnu-r-programming-lecture-note" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 dplyr 패키지 | 통계 프로그래밍 언어" />
  
  <meta name="twitter:description" content="2020년도 1학기 정보통계학과 통계 프로그래밍 언어 강의 노트로 해당 노트는 https://zorba78.github.io/cnu-r-programming-lecture-note/ 에서 확인 가능" />
  

<meta name="author" content="한국한의학연구원, 구본초" />


<meta name="date" content="2020-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="readr.html"/>
<link rel="next" href="data-transformation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">통계 프로그래밍 언어</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Overview</a></li>
<li class="part"><span><b>I Get Started</b></span></li>
<li class="chapter" data-level="1" data-path="intro-chap.html"><a href="intro-chap.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1.1</b> R 설치하기</a></li>
<li class="chapter" data-level="1.2" data-path="r-check.html"><a href="r-check.html"><i class="fa fa-check"></i><b>1.2</b> R 시작 및 작동 체크</a></li>
<li class="chapter" data-level="1.3" data-path="rconsle-script.html"><a href="rconsle-script.html"><i class="fa fa-check"></i><b>1.3</b> R script 편집기 사용</a></li>
<li class="chapter" data-level="1.4" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>1.4</b> RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-studio.html"><a href="r-studio.html#rstudio-install"><i class="fa fa-check"></i><b>1.4.1</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-studio.html"><a href="r-studio.html#rstudio-component"><i class="fa fa-check"></i><b>1.4.2</b> RStudio IDE 화면 구성</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-studio.html"><a href="r-studio.html#rstudio-glob-options"><i class="fa fa-check"></i><b>1.4.3</b> RStudio 환경 설정</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-studio.html"><a href="r-studio.html#rstudio-project"><i class="fa fa-check"></i><b>1.4.4</b> RStudio 프로젝트</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>1.5</b> R 패키지</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-package.html"><a href="r-package.html#r-package-path"><i class="fa fa-check"></i><b>1.5.1</b> R 패키지 경로 확인 및 변경</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-package.html"><a href="r-package.html#r-package-install"><i class="fa fa-check"></i><b>1.5.2</b> R 패키지 설치하기</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-package.html"><a href="r-package.html#r-package-load"><i class="fa fa-check"></i><b>1.5.3</b> R 패키지 불러오기</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-basic.html"><a href="r-basic.html"><i class="fa fa-check"></i><b>1.6</b> R 기초 문법</a></li>
<li class="chapter" data-level="1.7" data-path="r-markdown-get-start.html"><a href="r-markdown-get-start.html"><i class="fa fa-check"></i><b>1.7</b> R Markdown (맛보기)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-type.html"><a href="data-type.html"><i class="fa fa-check"></i><b>2</b> R 객체(R object)</a><ul>
<li class="chapter" data-level="2.1" data-path="scalar.html"><a href="scalar.html"><i class="fa fa-check"></i><b>2.1</b> 스칼라(scalar)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="scalar.html"><a href="scalar.html#definition"><i class="fa fa-check"></i><b>2.1.1</b> 선언</a></li>
<li class="chapter" data-level="2.1.2" data-path="scalar.html"><a href="scalar.html#numeric"><i class="fa fa-check"></i><b>2.1.2</b> 숫자형</a></li>
<li class="chapter" data-level="2.1.3" data-path="scalar.html"><a href="scalar.html#character"><i class="fa fa-check"></i><b>2.1.3</b> 문자형</a></li>
<li class="chapter" data-level="2.1.4" data-path="scalar.html"><a href="scalar.html#logical"><i class="fa fa-check"></i><b>2.1.4</b> 논리형 스칼라</a></li>
<li class="chapter" data-level="2.1.5" data-path="scalar.html"><a href="scalar.html#missing-value"><i class="fa fa-check"></i><b>2.1.5</b> 결측값(missing value)</a></li>
<li class="chapter" data-level="2.1.6" data-path="scalar.html"><a href="scalar.html#null"><i class="fa fa-check"></i><b>2.1.6</b> NULL 값</a></li>
<li class="chapter" data-level="2.1.7" data-path="scalar.html"><a href="scalar.html#finite"><i class="fa fa-check"></i><b>2.1.7</b> 무한대/무한소/숫자아님</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>2.2</b> 벡터(vector)</a><ul>
<li class="chapter" data-level="2.2.1" data-path="vector.html"><a href="vector.html#vector-prop"><i class="fa fa-check"></i><b>2.2.1</b> 벡터의 특징</a></li>
<li class="chapter" data-level="2.2.2" data-path="vector.html"><a href="vector.html#vector-operation"><i class="fa fa-check"></i><b>2.2.2</b> 벡터의 연산</a></li>
<li class="chapter" data-level="2.2.3" data-path="vector.html"><a href="vector.html#vector-index"><i class="fa fa-check"></i><b>2.2.3</b> 벡터의 색인(indexing)</a></li>
<li class="chapter" data-level="2.2.4" data-path="vector.html"><a href="vector.html#vector-function"><i class="fa fa-check"></i><b>2.2.4</b> 벡터 관련 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="list.html"><a href="list.html"><i class="fa fa-check"></i><b>2.3</b> 리스트(list)</a><ul>
<li class="chapter" data-level="2.3.1" data-path="list.html"><a href="list.html#make-list"><i class="fa fa-check"></i><b>2.3.1</b> 리스트 생성</a></li>
<li class="chapter" data-level="2.3.2" data-path="list.html"><a href="list.html#list-index"><i class="fa fa-check"></i><b>2.3.2</b> 리스트 색인</a></li>
<li class="chapter" data-level="2.3.3" data-path="list.html"><a href="list.html#list-add-delete"><i class="fa fa-check"></i><b>2.3.3</b> 리스트에 원소 추가/제거</a></li>
<li class="chapter" data-level="2.3.4" data-path="list.html"><a href="list.html#list-combine"><i class="fa fa-check"></i><b>2.3.4</b> 리스트의 결합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="matrix.html"><a href="matrix.html"><i class="fa fa-check"></i><b>2.4</b> 행렬(matrix)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="matrix.html"><a href="matrix.html#matrix-operation"><i class="fa fa-check"></i><b>2.4.1</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.4.2" data-path="matrix.html"><a href="matrix.html#mat-index"><i class="fa fa-check"></i><b>2.4.2</b> 행렬의 색인</a></li>
<li class="chapter" data-level="2.4.3" data-path="matrix.html"><a href="matrix.html#행과-열-추가-및-제거"><i class="fa fa-check"></i><b>2.4.3</b> 행과 열 추가 및 제거</a></li>
<li class="chapter" data-level="2.4.4" data-path="matrix.html"><a href="matrix.html#행렬-관련-함수"><i class="fa fa-check"></i><b>2.4.4</b> 행렬 관련 함수</a></li>
<li class="chapter" data-level="2.4.5" data-path="matrix.html"><a href="matrix.html#vec-mat-diff"><i class="fa fa-check"></i><b>2.4.5</b> 벡터와 행렬의 차이점</a></li>
<li class="chapter" data-level="2.4.6" data-path="matrix.html"><a href="matrix.html#mat-dim-reduc-sway"><i class="fa fa-check"></i><b>2.4.6</b> 의도치 않은 차원축소 피하기</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="array.html"><a href="array.html"><i class="fa fa-check"></i><b>2.5</b> 배열(array)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="array.html"><a href="array.html#make-array"><i class="fa fa-check"></i><b>2.5.1</b> 배열의 생성 및 색인</a></li>
<li class="chapter" data-level="2.5.2" data-path="array.html"><a href="array.html#rray-extend-example"><i class="fa fa-check"></i><b>2.5.2</b> 배열의 확장 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="factor-table.html"><a href="factor-table.html"><i class="fa fa-check"></i><b>2.6</b> 요인(factor)과 테이블(table)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="factor-table.html"><a href="factor-table.html#factor"><i class="fa fa-check"></i><b>2.6.1</b> 요인(factor)</a></li>
<li class="chapter" data-level="2.6.2" data-path="factor-table.html"><a href="factor-table.html#table"><i class="fa fa-check"></i><b>2.6.2</b> 테이블(table)</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-frame.html"><a href="data-frame.html"><i class="fa fa-check"></i><b>2.7</b> 데이터 프레임(data frame)</a><ul>
<li class="chapter" data-level="2.7.1" data-path="data-frame.html"><a href="data-frame.html#create-data-frame"><i class="fa fa-check"></i><b>2.7.1</b> 데이터 프레임 생성</a></li>
<li class="chapter" data-level="2.7.2" data-path="data-frame.html"><a href="data-frame.html#data-frame-get"><i class="fa fa-check"></i><b>2.7.2</b> 데이터 프레임 접근 및 필터링</a></li>
<li class="chapter" data-level="2.7.3" data-path="data-frame.html"><a href="data-frame.html#data-frame-function"><i class="fa fa-check"></i><b>2.7.3</b> 데이터 프레임 관련 함수</a></li>
<li class="chapter" data-level="2.7.4" data-path="data-frame.html"><a href="data-frame.html#apply-related-fun"><i class="fa fa-check"></i><b>2.7.4</b> <code>*apply()</code> 계열 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="is-as-function.html"><a href="is-as-function.html"><i class="fa fa-check"></i><b>2.8</b> 객체의 유형 판별 및 변환</a></li>
<li class="chapter" data-level="2.9" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i><b>2.9</b> Homework #2</a></li>
<li class="chapter" data-level="2.10" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i><b>2.10</b> Homework #3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="string-regexp.html"><a href="string-regexp.html"><i class="fa fa-check"></i><b>3</b> 문자열 처리와 정규표현식</a><ul>
<li class="chapter" data-level="3.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html"><i class="fa fa-check"></i><b>3.1</b> 유용한 문자열 관련 함수</a><ul>
<li class="chapter" data-level="3.1.1" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#nchar"><i class="fa fa-check"></i><b>3.1.1</b> <strong><code>nchar()</code></strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#paste"><i class="fa fa-check"></i><b>3.1.2</b> <strong><code>paste()</code></strong>, <strong><code>paste0()</code></strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#sprintf"><i class="fa fa-check"></i><b>3.1.3</b> <strong><code>sprintf()</code></strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#substr"><i class="fa fa-check"></i><b>3.1.4</b> <strong><code>substr()</code></strong></a></li>
<li class="chapter" data-level="3.1.5" data-path="유용한-문자열-관련-함수.html"><a href="유용한-문자열-관련-함수.html#low-up-fun"><i class="fa fa-check"></i><b>3.1.5</b> <strong><code>tolower()</code>, <code>toupper()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html"><i class="fa fa-check"></i><b>3.2</b> 정규표현식 기본 함수</a><ul>
<li class="chapter" data-level="3.2.1" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#grep-grepl"><i class="fa fa-check"></i><b>3.2.1</b> <strong><code>grep()</code>, <code>grepl()</code></strong></a></li>
<li class="chapter" data-level="3.2.2" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexpr-gregexpr"><i class="fa fa-check"></i><b>3.2.2</b> <strong><code>regexpr()</code></strong>, <strong><code>gregexpr()</code></strong></a></li>
<li class="chapter" data-level="3.2.3" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#sub-gsub-fun"><i class="fa fa-check"></i><b>3.2.3</b> <strong><code>sub()</code></strong>, <strong><code>gsub()</code></strong></a></li>
<li class="chapter" data-level="3.2.4" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#regexec-fun"><i class="fa fa-check"></i><b>3.2.4</b> <strong><code>regexec()</code></strong></a></li>
<li class="chapter" data-level="3.2.5" data-path="regexp-basic-fun.html"><a href="regexp-basic-fun.html#strsplit"><i class="fa fa-check"></i><b>3.2.5</b> <strong><code>strsplit()</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reg-exp.html"><a href="reg-exp.html"><i class="fa fa-check"></i><b>3.3</b> 정규 표현식(regular expression)</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reg-exp.html"><a href="reg-exp.html#basic-meta"><i class="fa fa-check"></i><b>3.3.1</b> 기본 메타 문자</a></li>
<li class="chapter" data-level="3.3.2" data-path="reg-exp.html"><a href="reg-exp.html#character-set"><i class="fa fa-check"></i><b>3.3.2</b> 문자 집합</a></li>
<li class="chapter" data-level="3.3.3" data-path="reg-exp.html"><a href="reg-exp.html#character-class"><i class="fa fa-check"></i><b>3.3.3</b> 문자 클래스</a></li>
<li class="chapter" data-level="3.3.4" data-path="reg-exp.html"><a href="reg-exp.html#regexp-ex"><i class="fa fa-check"></i><b>3.3.4</b> 정규 표현식 예시</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>4</b> 데이터 핸들링(Data handling)</a><ul>
<li class="chapter" data-level="4.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ch4-prerequi.html"><a href="ch4-prerequi.html#data-import-export"><i class="fa fa-check"></i><b>4.1.1</b> 외부데이터 불러오기 및 저장</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4.2</b> Tidyverse</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4.3</b> <code>readr</code> 패키지</a><ul>
<li class="chapter" data-level="4.3.1" data-path="readr.html"><a href="readr.html#import-export-excel"><i class="fa fa-check"></i><b>4.3.1</b> Excel 파일 입출력</a></li>
<li class="chapter" data-level="4.3.2" data-path="readr.html"><a href="readr.html#tibble"><i class="fa fa-check"></i><b>4.3.2</b> tibble 패키지</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4.4</b> <code>dplyr</code> 패키지</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dplyr.html"><a href="dplyr.html#pipe-op"><i class="fa fa-check"></i><b>4.4.1</b> 파이프 연산자: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-filter"><i class="fa fa-check"></i><b>4.4.2</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>4.4.3</b> <code id="dplyr-arrange">arrange()</code></a></li>
<li class="chapter" data-level="4.4.4" data-path="dplyr.html"><a href="dplyr.html#dplyr-select"><i class="fa fa-check"></i><b>4.4.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.4.5" data-path="dplyr.html"><a href="dplyr.html#dplyr-mutate"><i class="fa fa-check"></i><b>4.4.5</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.4.6" data-path="dplyr.html"><a href="dplyr.html#dplyr-transmute"><i class="fa fa-check"></i><b>4.4.6</b> <code>transmute()</code></a></li>
<li class="chapter" data-level="4.4.7" data-path="dplyr.html"><a href="dplyr.html#dplyr-summarise"><i class="fa fa-check"></i><b>4.4.7</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="4.4.8" data-path="dplyr.html"><a href="dplyr.html#dplyr-group_by"><i class="fa fa-check"></i><b>4.4.8</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="4.4.9" data-path="dplyr.html"><a href="dplyr.html#dplyr-application"><i class="fa fa-check"></i><b>4.4.9</b> dplyr 관련 유용한 함수</a></li>
<li class="chapter" data-level="4.4.10" data-path="dplyr.html"><a href="dplyr.html#dplyr-verb-variant-adverb"><i class="fa fa-check"></i><b>4.4.10</b> 부가 기능</a></li>
<li class="chapter" data-level="4.4.11" data-path="dplyr.html"><a href="dplyr.html#dplyr-join"><i class="fa fa-check"></i><b>4.4.11</b> 데이터 연결</a></li>
<li class="chapter" data-level="4.4.12" data-path="dplyr.html"><a href="dplyr.html#ex-gapminder"><i class="fa fa-check"></i><b>4.4.12</b> 확장 예제: Gapminder</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4.5</b> 데이터 변환</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-transformation.html"><a href="data-transformation.html#tidy-data"><i class="fa fa-check"></i><b>4.5.1</b> Tidy data</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-transformation.html"><a href="data-transformation.html#long-format"><i class="fa fa-check"></i><b>4.5.2</b> Long format</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-transformation.html"><a href="data-transformation.html#wider-format"><i class="fa fa-check"></i><b>4.5.3</b> Wide format</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-transformation.html"><a href="data-transformation.html#separate-unite"><i class="fa fa-check"></i><b>4.5.4</b> Separate and unite</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="homework-04.html"><a href="homework-04.html"><i class="fa fa-check"></i><b>4.6</b> Homework #4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-data-visualization.html"><a href="ch-data-visualization.html"><i class="fa fa-check"></i><b>5</b> 데이터 시각화</a><ul>
<li class="chapter" data-level="5.1" data-path="r-basic-graphics.html"><a href="r-basic-graphics.html"><i class="fa fa-check"></i><b>5.1</b> R 기본 그래프 함수</a></li>
<li class="chapter" data-level="5.2" data-path="high-level-graph.html"><a href="high-level-graph.html"><i class="fa fa-check"></i><b>5.2</b> 고수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.2.1" data-path="high-level-graph.html"><a href="high-level-graph.html#plot-fun"><i class="fa fa-check"></i><b>5.2.1</b> <strong><code>plot()</code> 함수</strong></a></li>
<li class="chapter" data-level="5.2.2" data-path="high-level-graph.html"><a href="high-level-graph.html#main-high-level-graph"><i class="fa fa-check"></i><b>5.2.2</b> 주요 고수준 그래픽 함수</a></li>
<li class="chapter" data-level="5.2.3" data-path="high-level-graph.html"><a href="high-level-graph.html#scatter-plot"><i class="fa fa-check"></i><b>5.2.3</b> 산점도</a></li>
<li class="chapter" data-level="5.2.4" data-path="high-level-graph.html"><a href="high-level-graph.html#mat-plot"><i class="fa fa-check"></i><b>5.2.4</b> 행렬 그래프</a></li>
<li class="chapter" data-level="5.2.5" data-path="high-level-graph.html"><a href="high-level-graph.html#histogram"><i class="fa fa-check"></i><b>5.2.5</b> 히스토그램</a></li>
<li class="chapter" data-level="5.2.6" data-path="high-level-graph.html"><a href="high-level-graph.html#bar-plot"><i class="fa fa-check"></i><b>5.2.6</b> 막대 그래프</a></li>
<li class="chapter" data-level="5.2.7" data-path="high-level-graph.html"><a href="high-level-graph.html#boxplot"><i class="fa fa-check"></i><b>5.2.7</b> 상자 그림</a></li>
<li class="chapter" data-level="5.2.8" data-path="high-level-graph.html"><a href="high-level-graph.html#violin-plot"><i class="fa fa-check"></i><b>5.2.8</b> 바이올린 도표</a></li>
<li class="chapter" data-level="5.2.9" data-path="high-level-graph.html"><a href="high-level-graph.html#mosaicplot"><i class="fa fa-check"></i><b>5.2.9</b> 모자이크 도표</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html"><i class="fa fa-check"></i><b>5.3</b> 저수준 그래프 함수</a><ul>
<li class="chapter" data-level="5.3.1" data-path="low-level-graphic.html"><a href="low-level-graphic.html#par"><i class="fa fa-check"></i><b>5.3.1</b> par()</a></li>
<li class="chapter" data-level="5.3.2" data-path="low-level-graphic.html"><a href="low-level-graphic.html#points"><i class="fa fa-check"></i><b>5.3.2</b> points()</a></li>
<li class="chapter" data-level="5.3.3" data-path="low-level-graphic.html"><a href="low-level-graphic.html#lines"><i class="fa fa-check"></i><b>5.3.3</b> lines()</a></li>
<li class="chapter" data-level="5.3.4" data-path="low-level-graphic.html"><a href="low-level-graphic.html#ablines"><i class="fa fa-check"></i><b>5.3.4</b> ablines()</a></li>
<li class="chapter" data-level="5.3.5" data-path="low-level-graphic.html"><a href="low-level-graphic.html#arrows"><i class="fa fa-check"></i><b>5.3.5</b> arrows()</a></li>
<li class="chapter" data-level="5.3.6" data-path="low-level-graphic.html"><a href="low-level-graphic.html#rect"><i class="fa fa-check"></i><b>5.3.6</b> rect()</a></li>
<li class="chapter" data-level="5.3.7" data-path="low-level-graphic.html"><a href="low-level-graphic.html#polygon"><i class="fa fa-check"></i><b>5.3.7</b> polygon()</a></li>
<li class="chapter" data-level="5.3.8" data-path="low-level-graphic.html"><a href="low-level-graphic.html#text"><i class="fa fa-check"></i><b>5.3.8</b> text(), mtext()</a></li>
<li class="chapter" data-level="5.3.9" data-path="low-level-graphic.html"><a href="low-level-graphic.html#legend"><i class="fa fa-check"></i><b>5.3.9</b> legend()</a></li>
<li class="chapter" data-level="5.3.10" data-path="low-level-graphic.html"><a href="low-level-graphic.html#math-expression"><i class="fa fa-check"></i><b>5.3.10</b> 수식 표현</a></li>
<li class="chapter" data-level="5.3.11" data-path="low-level-graphic.html"><a href="low-level-graphic.html#r-기본-그래프-이미지-파일로-저장"><i class="fa fa-check"></i><b>5.3.11</b> R 기본 그래프 이미지 파일로 저장</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html"><i class="fa fa-check"></i><b>5.4</b> ggplot2</a><ul>
<li class="chapter" data-level="5.4.1" data-path="ggplot2-package.html"><a href="ggplot2-package.html#basic-grammar"><i class="fa fa-check"></i><b>5.4.1</b> 기본 문법</a></li>
<li class="chapter" data-level="5.4.2" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-lines"><i class="fa fa-check"></i><b>5.4.2</b> Geoms: 선 관련 geometric</a></li>
<li class="chapter" data-level="5.4.3" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-points"><i class="fa fa-check"></i><b>5.4.3</b> Geoms: 점 geometrics</a></li>
<li class="chapter" data-level="5.4.4" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-bars"><i class="fa fa-check"></i><b>5.4.4</b> Geoms: 막대 geometrics</a></li>
<li class="chapter" data-level="5.4.5" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-intervals"><i class="fa fa-check"></i><b>5.4.5</b> Geom: 수직 범위선 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.6" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-texts"><i class="fa fa-check"></i><b>5.4.6</b> Geoms: 텍스트 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.7" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-areas"><i class="fa fa-check"></i><b>5.4.7</b> Geoms: 면적 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.8" data-path="ggplot2-package.html"><a href="ggplot2-package.html#geom-statistics"><i class="fa fa-check"></i><b>5.4.8</b> Geoms: 통계 그래프 관련 geometrics</a></li>
<li class="chapter" data-level="5.4.9" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-x-y"><i class="fa fa-check"></i><b>5.4.9</b> Scales: x-y 축 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.10" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-colors-fill"><i class="fa fa-check"></i><b>5.4.10</b> Scales: 색상 관련 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.11" data-path="ggplot2-package.html"><a href="ggplot2-package.html#scale-size-line-shape"><i class="fa fa-check"></i><b>5.4.11</b> Scales: 크기, 선 종류, 점 모양 aesthetic 조정</a></li>
<li class="chapter" data-level="5.4.12" data-path="ggplot2-package.html"><a href="ggplot2-package.html#coordinate-systems"><i class="fa fa-check"></i><b>5.4.12</b> Coordinate systems</a></li>
<li class="chapter" data-level="5.4.13" data-path="ggplot2-package.html"><a href="ggplot2-package.html#guides-x-y-축-및-그래프-제목-관련"><i class="fa fa-check"></i><b>5.4.13</b> Guides: x-y 축 및 그래프 제목 관련</a></li>
<li class="chapter" data-level="5.4.14" data-path="ggplot2-package.html"><a href="ggplot2-package.html#facets-국소-시각화-기법"><i class="fa fa-check"></i><b>5.4.14</b> Facets: 국소 시각화 기법</a></li>
<li class="chapter" data-level="5.4.15" data-path="ggplot2-package.html"><a href="ggplot2-package.html#themes"><i class="fa fa-check"></i><b>5.4.15</b> Themes</a></li>
<li class="chapter" data-level="5.4.16" data-path="ggplot2-package.html"><a href="ggplot2-package.html#ggplot-application"><i class="fa fa-check"></i><b>5.4.16</b> 확장 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">통계 프로그래밍 언어</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dplyr" class="section level2">
<h2><span class="header-section-number">4.4</span> <code>dplyr</code> 패키지</h2>


<div class="rmdnote">
<code>dplyr</code>에서 제공하는 “동사”(함수)로 데이터(데이터 프레임) 전처리 방법에 대해 익힌다.
</div>


<ul>
<li><p><code>dplyr</code>은 tidyverse 에서 데이터 전처리를 담당하는 패키지로 데이터 전처리 과정을 쉽고 빠르게 수행할 수 있는 함수로 구성된 패키지임.</p></li>
<li><p>데이터 핸들링을 위해 Hadley Wickham이 개발한 <code>plyr</code> 패키지를 최적화한 패키지로 C++ 로 코딩되어 성능이 <code>plyr</code>에 비해 월등히 우수함.</p></li>
<li><p>base R에 존재하는 함수만으로도 전처리는 충분히 가능하나, <code>dplyr</code>은 아래와 같은 장점을 가짐</p>
<ol style="list-style-type: lower-alpha">
<li><p>파이프 연산자(<code>%&gt;%</code>)로 코드의 가독성 극대화</p></li>
<li><p>코드 작성이 쉬움</p>
<ul>
<li>전통적인 R의 데이터 처리에서 사용되는 <code>[</code>, <code>[[</code>, <code>$</code>와 같은 색인 연산자 최소화</li>
<li><code>dplyr</code>은 몇 가지 “동사”를 조합하여 사용</li>
</ul></li>
<li><p>RStudio를 사용할 경우 코드 작성이 빨라짐</p></li>
<li><p>접근 방법이 SQL 문과 유사함</p></li>
</ol></li>
<li><p><code>dplyr</code>은 초기 데이터 프레임만을 다루지만, <code>purrr</code> 패키지를 통해 행렬, 배열, 리스트 등에도 적용 가능</p></li>
<li><p><code>dplyr</code>에서 제공하는 가장 기본 “동사”는 다음과 같음</p>
<ul>
<li><p><code>filter()</code>: 각 행(row)을 조건에 따라 선택</p></li>
<li><p><code>arrange()</code>: 선택한 변수(column)에 해당하는 행(row)을 기준으로 정렬</p></li>
<li><p><code>select()</code>: 변수(column) 선택</p></li>
<li><p><code>mutate()</code>: 새로운 변수를 추가하거나 이미 존재하는 변수를 변환</p></li>
<li><p><code>summarize()</code> 또는 <code>summarise()</code>: 변수 집계(평균, 표준편차, 최댓값, 최솟값, …)</p></li>
<li><p><code>group_by()</code> : 위 열거한 모든 동사들을 그룹별로 적용</p></li>
</ul></li>
<li><p>base R 제공 함수와 비교</p></li>
</ul>

<table class="table table-striped" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-11">Table 4.1: </span>dplyr 패키지 함수와 R base 패키지 함수 비교
</caption>
<thead>
<tr>
<th style="text-align:left;">
동사(함수)
</th>
<th style="text-align:left;">
내용
</th>
<th style="text-align:left;">
R base 패키지 함수
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
filter()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
행 추출
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
subset()
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
arrange()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
내림차순/오름차순 정렬
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
order(), sort()
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
select()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
열 선택
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
data[, c(‘var_name01’, ‘var_name03’)]
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
mutate()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
열 추가 및 변환
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
transform()
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
summarise()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
집계
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
aggregate()
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
group_by()
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
그룹별 집계 및 함수 적용
</td>
<td style="text-align:left;width: 4cm; font-family: monospace;">
</td>
</tr>
</tbody>
</table>

<ul>
<li><p><code>dplyr</code> 기본 동사와 연동해서 사용되는 주요 함수</p>
<ul>
<li><p><code>slice()</code>: 행 색인을 이용한 추출 <span class="math inline">\(\rightarrow\)</span> <code>data[n:m, ]</code>과 동일</p></li>
<li><p><code>distinct()</code>: 행 레코드 중 중복 항복 제거 <span class="math inline">\(\rightarrow\)</span> base R 패키지의 <code>unique()</code> 함수와 유사</p></li>
<li><p><code>sample_n()</code>, <code>sample_frac()</code>: 데이터 레코드를 랜덤하게 샘플링</p></li>
<li><p><code>rename()</code>: 변수명 변경</p></li>
<li><p><code>inner_join</code>, <code>right_join()</code>, <code>left_join()</code>, <code>full_join</code> : 두 데이터셋 병합 <span class="math inline">\(\rightarrow\)</span> <code>merge()</code> 함수와 유사</p></li>
<li><p><code>tally()</code>, <code>count()</code>, <code>n()</code>: 데이터셋의 행의 길이(개수)를 반환하는 함수로 (그룹별) 집계에 사용: <code>length()</code>, <code>nrow()/NROW()</code> 함수와 유사</p></li>
<li><p><code>*_all,</code>, <code>*_at</code>, <code>*_if</code>: <code>dplyr</code>에서 제공하는 기본 동사(<code>group_by()</code> 제외) 사용 시 적용 범위를 설정해 기본 동사와 동일한 기능을 수행하는 함수</p></li>
</ul></li>
</ul>


<div class="rmdtip">
R에서 데이터 전처리 및 분석을 수행할 때, 간혹 동일한 이름의 함수명들이 중복된 채 R 작업공간에 읽어오는 경우가 있는데, 이 경우 가장 마지막에 읽어온 패키지의 함수를 작업공간에서 사용한다. 예를 들어 R base 패키지의 <code>filter()</code> 함수는 시계열 데이터의 노이즈를 제거하는 함수이지만, tidyverse 패키지를 읽어온 경우, dplyr 패키지의 <code>filter()</code> 함수와 이름이 중복되기 때문에 R 작업공간 상에서는 dplyr 패키지의 <code>filter()</code>가 작동을 함. 만약 stats 패키지의 <code>filter()</code> 함수를 사용하고자 하면 <code>stats::filter()</code>를 사용. 이를 더 일반화 하면 현재 컴퓨터 상에 설치되어 있는 R 패키지의 특정 함수는 <code>::</code> 연산자를 통해 접근할 수 있으며, <code>package_name::function_name()</code> 형태로 접근 가능함.
</div>


<div id="pipe-op" class="section level3">
<h3><span class="header-section-number">4.4.1</span> 파이프 연산자: <code>%&gt;%</code></h3>
<ul>
<li><p>Tidyverse 세계에서 tidy를 담당하는 핵심적인 함수</p></li>
<li><p>여러 함수를 연결(chain)하는 역할을 하며, 이를 통해 불필요한 임시변수를 정의할 필요가 없어짐</p></li>
<li><p><code>function_1(x) %&gt;% function_2(y) = function_2(function_1(x), y)</code>: <code>function_1(x)</code>에서 반환한 값을 <code>function_2()</code>의 첫 번째 인자로 사용</p></li>
<li><p><code>x %&gt;% f(y) %&gt;% g(z)</code>= ?</p></li>
<li><p>기존 R 문법과 차이점</p>
<ul>
<li>기존 R: 동사(목적어, 주변수, 나머지 변수)</li>
<li>Pipe 연결 방식: 목적어 <code>%&gt;%</code> 동사(주변수, 나머지 변수)</li>
</ul></li>
<li><p>예시</p></li>
</ul>

<div class="sourceCode" id="cb1254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1254-1" title="1"><span class="co"># base R 문법 적용</span></a>
<a class="sourceLine" id="cb1254-2" title="2"><span class="kw">print</span>(<span class="kw">head</span>(iris, <span class="dv">4</span>))</a></code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa</code></pre>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1256-1" title="1"><span class="co"># %&gt;% 연산자 이용</span></a>
<a class="sourceLine" id="cb1256-2" title="2">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa</code></pre>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1258-1" title="1"><span class="co"># setosa 종에 해당하는 변수들의 평균 계산</span></a>
<a class="sourceLine" id="cb1258-2" title="2"><span class="kw">apply</span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>, <span class="dv">-5</span>], <span class="dv">2</span>, mean)</a></code></pre></div>
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
       5.006        3.428        1.462        0.246 </code></pre>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1260-1" title="1"><span class="co"># tidyverse의 pipe 연산자 이용</span></a>
<a class="sourceLine" id="cb1260-2" title="2"><span class="co"># require(tidyverse)</span></a>
<a class="sourceLine" id="cb1260-3" title="3"></a>
<a class="sourceLine" id="cb1260-4" title="4">iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1260-5" title="5"><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1260-6" title="6"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1260-7" title="7"><span class="st">  </span><span class="kw">summarise_all</span>(mean)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.006","2":"3.428","3":"1.462","4":"0.246"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1261-1" title="1"><span class="co"># Homework #3 b-c 풀이를 위한 pipe 연산 적용</span></a>
<a class="sourceLine" id="cb1261-2" title="2"><span class="co"># df &lt;- within(df, {</span></a>
<a class="sourceLine" id="cb1261-3" title="3"><span class="co">#   am &lt;- factor(am, levels = 0:1, </span></a>
<a class="sourceLine" id="cb1261-4" title="4"><span class="co">#                labels = c(&quot;automatic&quot;, &quot;manual&quot;))</span></a>
<a class="sourceLine" id="cb1261-5" title="5"><span class="co"># })</span></a>
<a class="sourceLine" id="cb1261-6" title="6"><span class="co"># ggregate(cbind(mpg, disp, hp, drat, wt, qsec) ~ am, </span></a>
<a class="sourceLine" id="cb1261-7" title="7"><span class="co">#           data = df, </span></a>
<a class="sourceLine" id="cb1261-8" title="8"><span class="co">#           mean)</span></a>
<a class="sourceLine" id="cb1261-9" title="9"><span class="co"># aggregate(cbind(mpg, disp, hp, drat, wt, qsec) ~ am, </span></a>
<a class="sourceLine" id="cb1261-10" title="10"><span class="co">#           data = df, </span></a>
<a class="sourceLine" id="cb1261-11" title="11"><span class="co">#           sd)</span></a>
<a class="sourceLine" id="cb1261-12" title="12"></a>
<a class="sourceLine" id="cb1261-13" title="13">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1261-14" title="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">am =</span> <span class="kw">factor</span>(vs, </a>
<a class="sourceLine" id="cb1261-15" title="15">                     <span class="dt">levels =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb1261-16" title="16">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;automatic&quot;</span>, <span class="st">&quot;manual&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1261-17" title="17"><span class="st">  </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1261-18" title="18"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(mpg, disp<span class="op">:</span>qsec), </a>
<a class="sourceLine" id="cb1261-19" title="19">               <span class="kw">list</span>(<span class="dt">mean =</span> mean, </a>
<a class="sourceLine" id="cb1261-20" title="20">                    <span class="dt">sd =</span> sd))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["am"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["mpg_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat_mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt_mean"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["mpg_sd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["disp_sd"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["hp_sd"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["drat_sd"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["wt_sd"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["qsec_sd"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"automatic","2":"16.61667","3":"307.1500","4":"189.72222","5":"3.392222","6":"3.688556","7":"16.69389","8":"3.860699","9":"106.76522","10":"60.28150","11":"0.4739515","12":"0.9040308","13":"1.091896"},{"1":"manual","2":"24.55714","3":"132.4571","4":"91.35714","5":"3.859286","6":"2.611286","7":"19.33357","8":"5.378978","9":"56.89324","10":"24.42447","11":"0.5057890","12":"0.7150100","13":"1.354415"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
<div id="dplyr-filter" class="section level3">
<h3><span class="header-section-number">4.4.2</span> <code>filter()</code></h3>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사</strong></p>
</blockquote>
<ul>
<li>데이터 프레임(또는 tibble)에서 특정 조건을 만족하는 레코드(row) 추출</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="figures/dplyr-filter.png" alt="filter() 함수 다이어그램" width="60%" />
<p class="caption">
Figure 4.2: filter() 함수 다이어그램
</p>
</div>

<ul>
<li><p>R base 패키지의 <code>subset()</code> 함수와 유사하게 작동하지만 성능이 더 좋음(속도가 더 빠르다).</p></li>
<li><p>추출을 위한 조건은 <a href="scalar.html#logical">2.1.4</a> 절 논리형 스칼라에서 설명한 비교 연산자를 준용함. 단 <code>filter()</code> 함수 내에서 and (<code>&amp;</code>) 조건은 <code>,</code>(콤마, comma)로 표현 가능</p></li>
<li><p><code>filter()</code>에서 가능한 불린(boolean) 연산</p></li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="figures/venn-diagram.png" alt="가능한 모든 boolean 연산 종류: x는 좌변, y는 우변을 의미하고 음영은 연산 이후 선택된 부분을 나타냄." width="90%" />
<p class="caption">
Figure 4.3: 가능한 모든 boolean 연산 종류: x는 좌변, y는 우변을 의미하고 음영은 연산 이후 선택된 부분을 나타냄.
</p>
</div>


<div class="sourceCode" id="cb1262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1262-1" title="1"><span class="co"># filter() 동사 prototype</span></a>
<a class="sourceLine" id="cb1262-2" title="2">dplyr<span class="op">::</span><span class="kw">filter</span>(x, <span class="co"># 데이터 프레임 또는 티블 객체</span></a>
<a class="sourceLine" id="cb1262-3" title="3">              condition_<span class="dv">01</span>, <span class="co"># 첫 번째 조건</span></a>
<a class="sourceLine" id="cb1262-4" title="4">              condition_<span class="dv">02</span>, <span class="co"># 두 번째 조건</span></a>
<a class="sourceLine" id="cb1262-5" title="5">                            <span class="co"># 두 번째 인수 이후 조건들은 </span></a>
<a class="sourceLine" id="cb1262-6" title="6">                            <span class="co"># condition_1 &amp; condition 2 &amp; ... &amp; condition_n 임</span></a>
<a class="sourceLine" id="cb1262-7" title="7">              ...)</a></code></pre></div>

<ul>
<li><p>예시 1: <code>mpg</code> 데이터(<code>ggplot2</code> 패키지 내장 데이터)</p>
<ul>
<li><code>mpg</code> 데이터 코드북</li>
<li>데이터 구조 확인을 위해 dplyr 패키지에서 제공하는 <code>glimpse()</code> 함수(<code>str()</code> 유사) 사용</li>
</ul></li>
</ul>

<table class="table table-striped" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-15">Table 4.2: </span>mpg 데이터셋 설명(코드북)
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수명
</th>
<th style="text-align:left;">
변수설명(영문)
</th>
<th style="text-align:left;">
변수설명(국문)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
manufacturer
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
manufacturer name
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
제조사
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
model
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
model name
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
모델명
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
displ
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
engine displacement, in litres
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
배기량 (리터)
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
year
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
year of manufacture
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
제조년도
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
cyl
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
number of cylinders
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
엔진 기통 수
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
trans
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
type of transmission
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
트렌스미션
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
drv
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
the type of drive train, where f = front-wheel drive, r = rear wheel drive, 4 = 4wd
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
구동 유형: f = 전륜구동, r = 후륜구동, 4 = 4륜 구동
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
cty
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
city miles per gallon
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
시내 연비
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
hwy
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
highway miles per gallon
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
고속 연비
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
fl
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
fuel type: e = E85, d = diesel, r = regular, p = premium, c = CNG
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
연료: e = 에탄올 85, r = 가솔린, p = 프리미엄, d = 디젤, c = CNP
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; font-family: monospace;">
class
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
‘type’ of car
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
자동차 타입
</td>
</tr>
</tbody>
</table>


<div class="sourceCode" id="cb1263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1263-1" title="1"><span class="kw">glimpse</span>(mpg)</a></code></pre></div>
<pre><code>Rows: 234
Columns: 11
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, ...
$ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;a...
$ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;,...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...
$ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;,...
$ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;,...</code></pre>
<div class="sourceCode" id="cb1265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1265-1" title="1"><span class="co"># 현대 차만 추출</span></a>
<a class="sourceLine" id="cb1265-2" title="2"><span class="co">## 기본 문법 사용</span></a>
<a class="sourceLine" id="cb1265-3" title="3"><span class="co"># mpg[mpg$manufacturer == &quot;hyundai&quot;, ]</span></a>
<a class="sourceLine" id="cb1265-4" title="4"><span class="co"># subset(mpg, manufacturer == &quot;hyundai&quot;)</span></a>
<a class="sourceLine" id="cb1265-5" title="5"></a>
<a class="sourceLine" id="cb1265-6" title="6"><span class="co">## filter() 함수 사용</span></a>
<a class="sourceLine" id="cb1265-7" title="7"><span class="co"># filter(mpg, manufacturer == &quot;hyundai&quot;)</span></a>
<a class="sourceLine" id="cb1265-8" title="8"></a>
<a class="sourceLine" id="cb1265-9" title="9"><span class="co">## pipe 연산자 사용</span></a>
<a class="sourceLine" id="cb1265-10" title="10">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1265-11" title="11"><span class="st">  </span><span class="kw">filter</span>(manufacturer <span class="op">==</span><span class="st"> &quot;hyundai&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"hyundai","2":"sonata","3":"2.4","4":"1999","5":"4","6":"auto(l4)","7":"f","8":"18","9":"26","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"2.4","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"18","9":"27","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"2.4","4":"2008","5":"4","6":"auto(l4)","7":"f","8":"21","9":"30","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"2.4","4":"2008","5":"4","6":"manual(m5)","7":"f","8":"21","9":"31","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"2.5","4":"1999","5":"6","6":"auto(l4)","7":"f","8":"18","9":"26","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"2.5","4":"1999","5":"6","6":"manual(m5)","7":"f","8":"18","9":"26","10":"r","11":"midsize"},{"1":"hyundai","2":"sonata","3":"3.3","4":"2008","5":"6","6":"auto(l5)","7":"f","8":"19","9":"28","10":"r","11":"midsize"},{"1":"hyundai","2":"tiburon","3":"2.0","4":"1999","5":"4","6":"auto(l4)","7":"f","8":"19","9":"26","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.0","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"19","9":"29","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.0","4":"2008","5":"4","6":"manual(m5)","7":"f","8":"20","9":"28","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.0","4":"2008","5":"4","6":"auto(l4)","7":"f","8":"20","9":"27","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.7","4":"2008","5":"6","6":"auto(l4)","7":"f","8":"17","9":"24","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.7","4":"2008","5":"6","6":"manual(m6)","7":"f","8":"16","9":"24","10":"r","11":"subcompact"},{"1":"hyundai","2":"tiburon","3":"2.7","4":"2008","5":"6","6":"manual(m5)","7":"f","8":"17","9":"24","10":"r","11":"subcompact"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1266-1" title="1"><span class="co"># 시내 연비가 20 mile/gallon 이상이고 타입이 suv 차량 추출</span></a>
<a class="sourceLine" id="cb1266-2" title="2"><span class="co">## 기본 문법 사용</span></a>
<a class="sourceLine" id="cb1266-3" title="3"><span class="co"># mpg[mpg$cty &gt;= 20 &amp; mpg$class == &quot;suv&quot;, ]</span></a>
<a class="sourceLine" id="cb1266-4" title="4"><span class="co"># subset(mpg, cty &gt;= 20 &amp; class == &quot;suv&quot;)</span></a>
<a class="sourceLine" id="cb1266-5" title="5"></a>
<a class="sourceLine" id="cb1266-6" title="6"><span class="co">## filter() 함수 사용</span></a>
<a class="sourceLine" id="cb1266-7" title="7"><span class="co"># filter(mpg, cty &gt;= 20, class == &quot;suv&quot;)</span></a>
<a class="sourceLine" id="cb1266-8" title="8"></a>
<a class="sourceLine" id="cb1266-9" title="9"><span class="co">## pipe 연산자 사용</span></a>
<a class="sourceLine" id="cb1266-10" title="10">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1266-11" title="11"><span class="st">  </span><span class="kw">filter</span>(cty <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span>, </a>
<a class="sourceLine" id="cb1266-12" title="12">         class <span class="op">==</span><span class="st"> &quot;suv&quot;</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"subaru","2":"forester awd","3":"2.5","4":"2008","5":"4","6":"manual(m5)","7":"4","8":"20","9":"27","10":"r","11":"suv"},{"1":"subaru","2":"forester awd","3":"2.5","4":"2008","5":"4","6":"auto(l4)","7":"4","8":"20","9":"26","10":"r","11":"suv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1267-1" title="1"><span class="co"># 제조사가 audi 또는 volkswagen 이고 고속 연비가 30 miles/gallon 인 차량만 추출</span></a>
<a class="sourceLine" id="cb1267-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1267-3" title="3"><span class="st">  </span><span class="kw">filter</span>(manufacturer <span class="op">==</span><span class="st"> &quot;audi&quot;</span> <span class="op">|</span><span class="st"> </span>manufacturer <span class="op">==</span><span class="st"> &quot;volkswagen&quot;</span>, </a>
<a class="sourceLine" id="cb1267-4" title="4">         hwy <span class="op">&gt;=</span><span class="st"> </span><span class="dv">30</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"audi","2":"a4","3":"2.0","4":"2008","5":"4","6":"manual(m6)","7":"f","8":"20","9":"31","10":"p","11":"compact"},{"1":"audi","2":"a4","3":"2.0","4":"2008","5":"4","6":"auto(av)","7":"f","8":"21","9":"30","10":"p","11":"compact"},{"1":"volkswagen","2":"jetta","3":"1.9","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"33","9":"44","10":"d","11":"compact"},{"1":"volkswagen","2":"new beetle","3":"1.9","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"35","9":"44","10":"d","11":"subcompact"},{"1":"volkswagen","2":"new beetle","3":"1.9","4":"1999","5":"4","6":"auto(l4)","7":"f","8":"29","9":"41","10":"d","11":"subcompact"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

<p><br/></p>
<!-- - 예시 2: gapminder 데이터 -->
<!-- ```{r filter-ex} -->
<!-- # country_pop 데이터 필터링 -->
<!-- # 데이터 체크 -->
<!-- glimpse(country_pop) -->
<!-- ## 1950 ~ 2020년 까지 데이터 추출 -->
<!-- country_pop %>%  -->
<!--   filter(year >= 1950, year <= 2020) %>%  -->
<!--   summary -->
<!-- ## 1950 ~ 2020년까지 데이터와 인구가 100만 이상인 데이터만 추출 -->
<!-- country_pop %>%  -->
<!--   filter(year >= 1950 & year <= 2020,  -->
<!--          population >= 10^6) %>%  -->
<!--   summary -->
<!-- ## 국가가 한국 또는 일본이고, 2015년도 데이터만 추출 -->
<!-- country_pop %>%  -->
<!--   filter(iso %in% c("kor", "jpn"),  -->
<!--          year == 2015) -->
<!-- ``` -->
</div>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">4.4.3</span> <code id="dplyr-arrange">arrange()</code></h3>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사</strong></p>
</blockquote>
<ul>
<li><p>지정한 열을 기준으로 데이터의 레코드(row)를 오름차순(작은 값부터 큰 값)으로 정렬</p></li>
<li><p>내림차순(큰 값부터 작은 값) 정렬 시 <code>desc()</code> 함수 이용</p></li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="figures/dplyr-arrange.png" alt="arrange() 함수 다이어그램" width="40%" />
<p class="caption">
Figure 4.4: arrange() 함수 다이어그램
</p>
</div>


<div class="sourceCode" id="cb1268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1268-1" title="1"><span class="kw">arrange</span>(data, <span class="co"># 데이터 프레임 또는 티블 객체</span></a>
<a class="sourceLine" id="cb1268-2" title="2">        var1, <span class="co"># 기준 변수 1</span></a>
<a class="sourceLine" id="cb1268-3" title="3">        var2, <span class="co"># 기준 변수 2</span></a>
<a class="sourceLine" id="cb1268-4" title="4">        ...)</a></code></pre></div>

<ul>
<li>예시 1: <code>mpg</code> 데이터셋</li>
</ul>

<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1269-1" title="1"><span class="co"># 시내 연비를 기준으로 오름차순 정렬</span></a>
<a class="sourceLine" id="cb1269-2" title="2"><span class="co">## R 기본 문법 사용</span></a>
<a class="sourceLine" id="cb1269-3" title="3"><span class="co"># mpg[order(mpg$cty), ]</span></a>
<a class="sourceLine" id="cb1269-4" title="4"></a>
<a class="sourceLine" id="cb1269-5" title="5"><span class="co">## arrange 함수 사용</span></a>
<a class="sourceLine" id="cb1269-6" title="6"><span class="co"># arrange(mpg, cty)</span></a>
<a class="sourceLine" id="cb1269-7" title="7"></a>
<a class="sourceLine" id="cb1269-8" title="8"><span class="co">## pipe 사용</span></a>
<a class="sourceLine" id="cb1269-9" title="9">mpg_asc &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(cty)</a>
<a class="sourceLine" id="cb1269-10" title="10">mpg_asc <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 11
   manufacturer model     displ  year   cyl trans  drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 dodge        dakota p~   4.7  2008     8 auto(~ 4         9    12 e     pick~
 2 dodge        durango ~   4.7  2008     8 auto(~ 4         9    12 e     suv  
 3 dodge        ram 1500~   4.7  2008     8 auto(~ 4         9    12 e     pick~
 4 dodge        ram 1500~   4.7  2008     8 manua~ 4         9    12 e     pick~
 5 jeep         grand ch~   4.7  2008     8 auto(~ 4         9    12 e     suv  
 6 chevrolet    c1500 su~   5.3  2008     8 auto(~ r        11    15 e     suv  
 7 chevrolet    k1500 ta~   5.3  2008     8 auto(~ 4        11    14 e     suv  
 8 chevrolet    k1500 ta~   5.7  1999     8 auto(~ 4        11    15 r     suv  
 9 dodge        caravan ~   3.3  2008     6 auto(~ f        11    17 e     mini~
10 dodge        dakota p~   5.2  1999     8 manua~ 4        11    17 r     pick~
# ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb1271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1271-1" title="1"><span class="co"># 시내 연비는 오름차순, 차량 타입은 내림차순(알파벳 역순) 정렬</span></a>
<a class="sourceLine" id="cb1271-2" title="2"><span class="co">## R 기본 문법 사용</span></a>
<a class="sourceLine" id="cb1271-3" title="3"><span class="co">### 문자형 벡터의 순위 계산을 위해 rank() 함수 사용</span></a>
<a class="sourceLine" id="cb1271-4" title="4">mpg_sortb &lt;-<span class="st"> </span>mpg[<span class="kw">order</span>(mpg<span class="op">$</span>cty, <span class="op">-</span><span class="kw">rank</span>(mpg<span class="op">$</span>class)), ]</a>
<a class="sourceLine" id="cb1271-5" title="5"></a>
<a class="sourceLine" id="cb1271-6" title="6"><span class="co">## arrange 함수 사용</span></a>
<a class="sourceLine" id="cb1271-7" title="7">mpg_sortt &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(cty, <span class="kw">desc</span>(class))</a>
<a class="sourceLine" id="cb1271-8" title="8">mpg_sortt <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 11
   manufacturer model     displ  year   cyl trans  drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 dodge        durango ~   4.7  2008     8 auto(~ 4         9    12 e     suv  
 2 jeep         grand ch~   4.7  2008     8 auto(~ 4         9    12 e     suv  
 3 dodge        dakota p~   4.7  2008     8 auto(~ 4         9    12 e     pick~
 4 dodge        ram 1500~   4.7  2008     8 auto(~ 4         9    12 e     pick~
 5 dodge        ram 1500~   4.7  2008     8 manua~ 4         9    12 e     pick~
 6 chevrolet    c1500 su~   5.3  2008     8 auto(~ r        11    15 e     suv  
 7 chevrolet    k1500 ta~   5.3  2008     8 auto(~ 4        11    14 e     suv  
 8 chevrolet    k1500 ta~   5.7  1999     8 auto(~ 4        11    15 r     suv  
 9 dodge        durango ~   5.2  1999     8 auto(~ 4        11    16 r     suv  
10 dodge        durango ~   5.9  1999     8 auto(~ 4        11    15 r     suv  
# ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb1273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1273-1" title="1"><span class="co"># 두 데이터 셋 동일성 여부</span></a>
<a class="sourceLine" id="cb1273-2" title="2"><span class="kw">identical</span>(mpg_sortb, mpg_sortt)</a></code></pre></div>
<pre><code>[1] TRUE</code></pre>

</div>
<div id="dplyr-select" class="section level3">
<h3><span class="header-section-number">4.4.4</span> <code>select()</code></h3>
<blockquote>
<p><strong>열(변수) 조작 동사</strong></p>
</blockquote>
<ul>
<li>데이터셋을 구성하는 <strong>열(column, variable)</strong>을 선택하는 함수</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<img src="figures/dplyr-select.png" alt="select() 함수 다이어그램" width="50%" />
<p class="caption">
Figure 4.5: select() 함수 다이어그램
</p>
</div>


<div class="sourceCode" id="cb1275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1275-1" title="1"><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb1275-2" title="2">  data, <span class="co"># 데이터 프레임 또는 티블 객체</span></a>
<a class="sourceLine" id="cb1275-3" title="3">  var_name1, <span class="co"># 변수 이름 (따옴표 없이도 가능)</span></a>
<a class="sourceLine" id="cb1275-4" title="4">  var_name2, </a>
<a class="sourceLine" id="cb1275-5" title="5">  ...</a>
<a class="sourceLine" id="cb1275-6" title="6">)</a></code></pre></div>


<div class="sourceCode" id="cb1276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1276-1" title="1"><span class="co"># 제조사(manufacturer), 모델명(model), 배기량(displ)</span></a>
<a class="sourceLine" id="cb1276-2" title="2"><span class="co"># 제조년도(year), 시내연비 (cty)만 추출</span></a>
<a class="sourceLine" id="cb1276-3" title="3"></a>
<a class="sourceLine" id="cb1276-4" title="4"><span class="co">## 기본 R 문법 이용한 변수 추출</span></a>
<a class="sourceLine" id="cb1276-5" title="5"><span class="kw">glimpse</span>(mpg[, <span class="kw">c</span>(<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;model&quot;</span>, <span class="st">&quot;displ&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cty&quot;</span>)])</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1278-1" title="1"><span class="co"># glimpse(mpg[, c(1:4, 8)])</span></a>
<a class="sourceLine" id="cb1278-2" title="2"><span class="co"># glimpse(mpg[, names(mpg) %in% c(&quot;manufacturer&quot;, &quot;displ&quot;, &quot;model&quot;,</span></a>
<a class="sourceLine" id="cb1278-3" title="3"><span class="co">#                         &quot;year&quot;, &quot;cty&quot;)])</span></a>
<a class="sourceLine" id="cb1278-4" title="4"></a>
<a class="sourceLine" id="cb1278-5" title="5"><span class="co">## select() 함수 이용</span></a>
<a class="sourceLine" id="cb1278-6" title="6"><span class="co">### 아래 스크립트는 모두 동일한 결과를 반환</span></a>
<a class="sourceLine" id="cb1278-7" title="7"><span class="co"># mpg %&gt;% select(1:4, 8)</span></a>
<a class="sourceLine" id="cb1278-8" title="8"><span class="co"># </span></a>
<a class="sourceLine" id="cb1278-9" title="9"><span class="co"># mpg %&gt;% </span></a>
<a class="sourceLine" id="cb1278-10" title="10"><span class="co">#   select(c(&quot;manufacturer&quot;, &quot;model&quot;, &quot;displ&quot;, &quot;year&quot;, &quot;cty&quot;))</span></a>
<a class="sourceLine" id="cb1278-11" title="11"></a>
<a class="sourceLine" id="cb1278-12" title="12">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1278-13" title="13"><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;manufacturer&quot;</span>, <span class="st">&quot;model&quot;</span>, <span class="st">&quot;displ&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cty&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1278-14" title="14"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>

<ul>
<li><p>R 기본 문법과 차이점</p>
<ul>
<li>선택하고자 하는 변수 입력 시 따옴표가 필요 없음</li>
<li><code>:</code> 연산자를 이용해 선택 변수의 범위 지정 가능</li>
<li><code>-</code> 연산자를 이용해 선택 변수 제거</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1280-1" title="1"><span class="co"># 제조사(manufacturer), 모델명(model), 배기량(displ)</span></a>
<a class="sourceLine" id="cb1280-2" title="2"><span class="co"># 제조년도(year), 시내연비 (cty)만 추출</span></a>
<a class="sourceLine" id="cb1280-3" title="3"><span class="co">## select() 따옴표 없이 변수명 입력</span></a>
<a class="sourceLine" id="cb1280-4" title="4">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1280-5" title="5"><span class="st">  </span><span class="kw">select</span>(manufacturer, model, displ, year, cty) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1280-6" title="6"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1282-1" title="1"><span class="co">## : 연산자로 변수 범위 지정</span></a>
<a class="sourceLine" id="cb1282-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1282-3" title="3"><span class="st">  </span><span class="kw">select</span>(manufacturer<span class="op">:</span>year, cty) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1282-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1284-1" title="1"><span class="co">## 관심 없는 열을 -로 제외 가능</span></a>
<a class="sourceLine" id="cb1284-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1284-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>cyl, <span class="op">-</span>trans, <span class="op">-</span>drv, <span class="op">-</span>hwy, <span class="op">-</span>fl, <span class="op">-</span>class) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1284-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1286-1" title="1"><span class="co">## 조금 더 간결하게 (`:`와 `-` 연산 조합)</span></a>
<a class="sourceLine" id="cb1286-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1286-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>cyl<span class="op">:-</span>drv, <span class="op">-</span>hwy<span class="op">:-</span>class) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1286-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1288-1" title="1"><span class="co">### 동일한 기능: -는 괄호로 묶을 수 있음</span></a>
<a class="sourceLine" id="cb1288-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1288-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(cyl<span class="op">:</span>drv), <span class="op">-</span>(hwy<span class="op">:</span>class)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1288-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 5
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...</code></pre>
<div class="sourceCode" id="cb1290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1290-1" title="1"><span class="co"># select() 함수를 이용해 변수명 변경 가능</span></a>
<a class="sourceLine" id="cb1290-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1290-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="dt">city_mpg =</span> cty) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1290-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 1
$ city_mpg &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 15...</code></pre>

<ul>
<li><p><code>select()</code>와 조합 시 유용한 선택 함수</p>
<ul>
<li><code>starts_with("abc")</code>: “abc”로 시작하는 변수 선택</li>
<li><code>ends_with("xyz")</code>: “xyz”로 끝나는 변수 선택</li>
<li><code>contains("def")</code>: “def”를 포함하는 변수 선택</li>
<li><code>matches("^F[0-9]")</code>: 정규표현식과 일치하는 변수 선택. “F”와 한 자리 숫자로 시작하는 변수 선택</li>
<li><code>everything()</code>: <code>select()</code> 함수 내에서 미리 선택한 변수를 제외한 모든 변수 선택</li>
</ul></li>
</ul>

<div class="sourceCode" id="cb1292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1292-1" title="1"><span class="co"># &quot;m&quot;으로 시작하는 변수 제거</span></a>
<a class="sourceLine" id="cb1292-2" title="2"><span class="co">## 기존 select() 함수 사용</span></a>
<a class="sourceLine" id="cb1292-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1292-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>manufacturer, <span class="op">-</span>model) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1292-5" title="5"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 9
$ displ &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.8, 2...
$ year  &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, 2008, 2...
$ cyl   &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8...
$ trans &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;auto(l5)...
$ drv   &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;...
$ cty   &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 15, 1...
$ hwy   &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25, 25, 2...
$ fl    &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;...
$ class &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compa...</code></pre>
<div class="sourceCode" id="cb1294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1294-1" title="1"><span class="co">## select() + starts_with() 함수 사용</span></a>
<a class="sourceLine" id="cb1294-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1294-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">starts_with</span>(<span class="st">&quot;m&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1294-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 9
$ displ &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.8, 2...
$ year  &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, 2008, 2...
$ cyl   &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8...
$ trans &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;auto(l5)...
$ drv   &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;...
$ cty   &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 15, 1...
$ hwy   &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25, 25, 2...
$ fl    &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;...
$ class &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compa...</code></pre>
<div class="sourceCode" id="cb1296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1296-1" title="1"><span class="co"># &quot;l&quot;로 끝나는 변수 선택: ends_with() 함수 사용</span></a>
<a class="sourceLine" id="cb1296-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1296-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;l&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1296-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 4
$ model &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;, &quot;a4 q...
$ displ &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.8, 2...
$ cyl   &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8...
$ fl    &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;...</code></pre>
<div class="sourceCode" id="cb1298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1298-1" title="1"><span class="co"># dplyr 내장 데이터: starwars에서 이름, 성별, &quot;color&quot;를 포함하는 변수 선택</span></a>
<a class="sourceLine" id="cb1298-2" title="2"><span class="co">## contains() 함수 사용</span></a>
<a class="sourceLine" id="cb1298-3" title="3">starwars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-4" title="4"><span class="st">  </span><span class="kw">select</span>(name, gender, <span class="kw">contains</span>(<span class="st">&quot;color&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-5" title="5"><span class="st">  </span>head</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["gender"],"name":[2],"type":["chr"],"align":["left"]},{"label":["hair_color"],"name":[3],"type":["chr"],"align":["left"]},{"label":["skin_color"],"name":[4],"type":["chr"],"align":["left"]},{"label":["eye_color"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Luke Skywalker","2":"masculine","3":"blond","4":"fair","5":"blue"},{"1":"C-3PO","2":"masculine","3":"NA","4":"gold","5":"yellow"},{"1":"R2-D2","2":"masculine","3":"NA","4":"white, blue","5":"red"},{"1":"Darth Vader","2":"masculine","3":"none","4":"white","5":"yellow"},{"1":"Leia Organa","2":"feminine","3":"brown","4":"light","5":"brown"},{"1":"Owen Lars","2":"masculine","3":"brown, grey","4":"light","5":"blue"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1299-1" title="1"><span class="co"># 다시 mpg 데이터... </span></a>
<a class="sourceLine" id="cb1299-2" title="2"><span class="co">## 맨 마지막 문자가 &quot;y&quot;로 끝나는 변수 선택(제조사, 모델 포함)</span></a>
<a class="sourceLine" id="cb1299-3" title="3"><span class="co">## matches() 사용</span></a>
<a class="sourceLine" id="cb1299-4" title="4">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1299-5" title="5"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;m&quot;</span>), <span class="kw">matches</span>(<span class="st">&quot;y$&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1299-6" title="6"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 4
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...</code></pre>
<div class="sourceCode" id="cb1301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1301-1" title="1"><span class="co"># cty, hwy 변수를 각각 1-2 번째 열에 위치</span></a>
<a class="sourceLine" id="cb1301-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1301-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">&quot;y$&quot;</span>), <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1301-4" title="4"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 11
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, ...
$ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;a...
$ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;,...
$ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;,...
$ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;,...</code></pre>

</div>
<div id="dplyr-mutate" class="section level3">
<h3><span class="header-section-number">4.4.5</span> <code>mutate()</code></h3>
<blockquote>
<p><strong>열(변수) 조작 동사: 새로운 열을 추가하는 함수로 기본 R 문법의 <code>data$new_variable &lt;- value</code> 와 유사한 기능을 함</strong></p>
</blockquote>
<ul>
<li>주어진 데이터 셋(데이터 프레임)에 이미 존재하고 있는 변수를 이용해 새로운 값 변환 시 유용</li>
<li>새로 만든 열을 <code>mutate()</code> 함수 내에서 사용 가능 <span class="math inline">\(\rightarrow\)</span> R base 패키지에서 재공하는 <code>transform()</code> 함수는 <code>mutate()</code> 함수와 거의 동일한 기능을 하지만, <code>transform()</code> 함수 내에서 생성한 변수의 재사용이 불가능</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-21"></span>
<img src="figures/dplyr-mutate.png" alt="mutate() 함수 다이어그램" width="60%" />
<p class="caption">
Figure 4.6: mutate() 함수 다이어그램
</p>
</div>


<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1303-1" title="1"><span class="co"># mpg 데이터 셋의 연비 단위는 miles/gallon으로 입력 -&gt; kmh/l 로 변환</span></a>
<a class="sourceLine" id="cb1303-2" title="2">mile &lt;-<span class="st"> </span><span class="fl">1.61</span> <span class="co">#km</span></a>
<a class="sourceLine" id="cb1303-3" title="3">gallon &lt;-<span class="st"> </span><span class="fl">3.79</span> <span class="co">#litres</span></a>
<a class="sourceLine" id="cb1303-4" title="4">kpl &lt;-<span class="st"> </span>mile<span class="op">/</span>gallon</a>
<a class="sourceLine" id="cb1303-5" title="5"></a>
<a class="sourceLine" id="cb1303-6" title="6"><span class="co">## 기본 R 문법</span></a>
<a class="sourceLine" id="cb1303-7" title="7"><span class="kw">glimpse</span>(<span class="kw">transform</span>(mpg, </a>
<a class="sourceLine" id="cb1303-8" title="8">                  <span class="dt">cty_kpl =</span> cty <span class="op">*</span><span class="st"> </span>kpl, </a>
<a class="sourceLine" id="cb1303-9" title="9">                  <span class="dt">hwy_kpl =</span> hwy <span class="op">*</span><span class="st"> </span>kpl))</a></code></pre></div>
<pre><code>Rows: 234
Columns: 13
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, ...
$ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;a...
$ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;,...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...
$ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;,...
$ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;,...
$ cty_kpl      &lt;dbl&gt; 7.646438, 8.920844, 8.496042, 8.920844, 6.796834, 7.64...
$ hwy_kpl      &lt;dbl&gt; 12.319261, 12.319261, 13.168865, 12.744063, 11.044855,...</code></pre>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1305-1" title="1"><span class="co">## tidyverse 문법</span></a>
<a class="sourceLine" id="cb1305-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1305-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cty_kpl =</span> cty<span class="op">*</span>kpl, </a>
<a class="sourceLine" id="cb1305-4" title="4">         <span class="dt">hwy_kpl =</span> hwy<span class="op">*</span>kpl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1305-5" title="5"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 13
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, ...
$ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;a...
$ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;,...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...
$ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;,...
$ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;,...
$ cty_kpl      &lt;dbl&gt; 7.646438, 8.920844, 8.496042, 8.920844, 6.796834, 7.64...
$ hwy_kpl      &lt;dbl&gt; 12.319261, 12.319261, 13.168865, 12.744063, 11.044855,...</code></pre>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1307-1" title="1"><span class="co"># 새로 생성한 변수를 이용해 변환 변수를 원래 단위로 바꿔보기</span></a>
<a class="sourceLine" id="cb1307-2" title="2"><span class="co">## R 기본 문법: transform() 사용</span></a>
<a class="sourceLine" id="cb1307-3" title="3"><span class="kw">glimpse</span>(<span class="kw">transform</span>(mpg, </a>
<a class="sourceLine" id="cb1307-4" title="4">                  <span class="dt">cty_kpl =</span> cty <span class="op">*</span><span class="st"> </span>kpl, </a>
<a class="sourceLine" id="cb1307-5" title="5">                  <span class="dt">hwy_kpl =</span> hwy <span class="op">*</span><span class="st"> </span>kpl,</a>
<a class="sourceLine" id="cb1307-6" title="6">                  <span class="dt">cty_raw =</span> cty_kpl<span class="op">/</span>kpl,</a>
<a class="sourceLine" id="cb1307-7" title="7">                  <span class="dt">hwy_raw =</span> hwy_kpl<span class="op">/</span>kpl,</a>
<a class="sourceLine" id="cb1307-8" title="8">                  )) </a></code></pre></div>
<pre><code>Error in eval(substitute(list(...)), `_data`, parent.frame()): 객체 &#39;cty_kpl&#39;를 찾을 수 없습니다</code></pre>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1309-1" title="1"><span class="co">## Tidyverse 문법</span></a>
<a class="sourceLine" id="cb1309-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1309-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cty_kpl =</span> cty<span class="op">*</span>kpl, </a>
<a class="sourceLine" id="cb1309-4" title="4">         <span class="dt">hwy_kpl =</span> hwy<span class="op">*</span>kpl, </a>
<a class="sourceLine" id="cb1309-5" title="5">         <span class="dt">cty_raw =</span> cty_kpl<span class="op">/</span>kpl,</a>
<a class="sourceLine" id="cb1309-6" title="6">         <span class="dt">hwy_raw =</span> hwy_kpl<span class="op">/</span>kpl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1309-7" title="7"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 234
Columns: 15
$ manufacturer &lt;chr&gt; &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;, &quot;audi&quot;...
$ model        &lt;chr&gt; &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4&quot;, &quot;a4 quattro&quot;...
$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0,...
$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, ...
$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, ...
$ trans        &lt;chr&gt; &quot;auto(l5)&quot;, &quot;manual(m5)&quot;, &quot;manual(m6)&quot;, &quot;auto(av)&quot;, &quot;a...
$ drv          &lt;chr&gt; &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;f&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;, &quot;4&quot;,...
$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...
$ fl           &lt;chr&gt; &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;, &quot;p&quot;,...
$ class        &lt;chr&gt; &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;, &quot;compact&quot;,...
$ cty_kpl      &lt;dbl&gt; 7.646438, 8.920844, 8.496042, 8.920844, 6.796834, 7.64...
$ hwy_kpl      &lt;dbl&gt; 12.319261, 12.319261, 13.168865, 12.744063, 11.044855,...
$ cty_raw      &lt;dbl&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17...
$ hwy_raw      &lt;dbl&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25...</code></pre>

</div>
<div id="dplyr-transmute" class="section level3">
<h3><span class="header-section-number">4.4.6</span> <code>transmute()</code></h3>
<blockquote>
<p><strong>열(변수) 조작 동사: mutate()와 유사한 기능을 하지만 추가 또는 변환된 변수만 반환</strong></p>
</blockquote>

<div class="sourceCode" id="cb1311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1311-1" title="1"><span class="st">`</span><span class="dt">연비</span><span class="st">`</span> &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1311-2" title="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">cty_kpl =</span> cty<span class="op">*</span>kpl, </a>
<a class="sourceLine" id="cb1311-3" title="3">            <span class="dt">hwy_kpl =</span> hwy<span class="op">*</span>kpl, </a>
<a class="sourceLine" id="cb1311-4" title="4">            <span class="dt">cty_raw =</span> cty_kpl<span class="op">/</span>kpl,</a>
<a class="sourceLine" id="cb1311-5" title="5">            <span class="dt">hwy_raw =</span> hwy_kpl<span class="op">/</span>kpl)</a>
<a class="sourceLine" id="cb1311-6" title="6"><span class="st">`</span><span class="dt">연비</span><span class="st">`</span> <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 4
   cty_kpl hwy_kpl cty_raw hwy_raw
     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1    7.65    12.3      18     29 
 2    8.92    12.3      21     29 
 3    8.50    13.2      20     31.
 4    8.92    12.7      21     30 
 5    6.80    11.0      16     26 
 6    7.65    11.0      18     26 
 7    7.65    11.5      18     27 
 8    7.65    11.0      18     26 
 9    6.80    10.6      16     25 
10    8.50    11.9      20     28 
# ... with 224 more rows</code></pre>

</div>
<div id="dplyr-summarise" class="section level3">
<h3><span class="header-section-number">4.4.7</span> <code>summarise()</code></h3>
<blockquote>
<p><strong>변수 요약 및 집계: 변수를 집계하는 함수로 R stat 패키지(R 처음 실행 시 기본으로 불러오는 패키지 중 하나)의 <code>aggregate()</code> 함수와 유사한 기능을 함</strong></p>
</blockquote>
<ul>
<li>보통 <code>mean()</code>, <code>sd()</code>, <code>var()</code>, <code>median()</code>, <code>min()</code>, <code>max()</code> 등 요약 통계량을 반환하는 함수와 같이 사용</li>
<li>데이터 프레임(티블) 객체 반환</li>
<li>변수의 모든 레코드에 집계 함수를 적용하므로 <code>summarise()</code>만 단일로 사용하면 1개의 행만 반환</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="figures/dplyr-summarise.png" alt="summarise() 함수 다이어그램" width="60%" />
<p class="caption">
Figure 4.7: summarise() 함수 다이어그램
</p>
</div>


<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1313-1" title="1"><span class="co"># cty, hwy의 평균과 표준편차 계산</span></a>
<a class="sourceLine" id="cb1313-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1313-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_cty =</span> <span class="kw">mean</span>(cty),</a>
<a class="sourceLine" id="cb1313-4" title="4">            <span class="dt">sd_cty =</span> <span class="kw">sd</span>(cty), </a>
<a class="sourceLine" id="cb1313-5" title="5">            <span class="dt">mean_hwy =</span> <span class="kw">mean</span>(hwy), </a>
<a class="sourceLine" id="cb1313-6" title="6">            <span class="dt">sd_hwy =</span> <span class="kw">sd</span>(hwy))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean_cty"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd_cty"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_hwy"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd_hwy"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"16.85897","2":"4.255946","3":"23.44017","4":"5.954643"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
<div id="dplyr-group_by" class="section level3">
<h3><span class="header-section-number">4.4.8</span> <code>group_by()</code></h3>
<blockquote>
<p><strong>행(row, case, observation) 그룹화</strong></p>
</blockquote>
<ul>
<li>보통 <code>summarise()</code> 함수는 <code>aggregate()</code>함수와 유사하게 그룹 별 요약 통계량을 계산할 때 주로 사용됨</li>
<li><code>group_by()</code>는 “주어진 그룹에 따라(by group)”, 즉 지정한 그룹(변수) 별 연산을 지정</li>
</ul>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-26"></span>
<img src="figures/dply-group-by.png" alt="group_by() 함수 다이어그램" width="80%" />
<p class="caption">
Figure 4.8: group_by() 함수 다이어그램
</p>
</div>


<div class="sourceCode" id="cb1314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1314-1" title="1"><span class="co"># 모델, 년도에 따른 cty, hwy 평균 계산</span></a>
<a class="sourceLine" id="cb1314-2" title="2">by_mpg &lt;-<span class="st"> </span><span class="kw">group_by</span>(mpg, model, year)</a>
<a class="sourceLine" id="cb1314-3" title="3"><span class="co">## 그룹 지정 check</span></a>
<a class="sourceLine" id="cb1314-4" title="4">by_mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1314-5" title="5"><span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1314-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 11
# Groups:   model, year [2]
  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa~
2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa~
3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa~
4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa~
5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compa~
6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compa~</code></pre>
<div class="sourceCode" id="cb1316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1316-1" title="1"><span class="co">## 통계량 계산</span></a>
<a class="sourceLine" id="cb1316-2" title="2">by_mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1316-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_cty =</span> <span class="kw">mean</span>(cty), </a>
<a class="sourceLine" id="cb1316-4" title="4">            <span class="dt">mean_hwy =</span> <span class="kw">mean</span>(hwy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1316-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;model&#39; (override with `.groups` argument)</code></pre>
<pre><code># A tibble: 76 x 4
# Groups:   model [38]
   model        year mean_cty mean_hwy
   &lt;chr&gt;       &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 4runner 4wd  1999     15.2     19  
 2 4runner 4wd  2008     15       18.5
 3 a4           1999     18.2     27.5
 4 a4           2008     19.7     29.3
 5 a4 quattro   1999     16.5     25.2
 6 a4 quattro   2008     17.8     26.2
 7 a6 quattro   1999     15       24  
 8 a6 quattro   2008     16.5     24  
 9 altima       1999     20       28  
10 altima       2008     21       29  
# ... with 66 more rows</code></pre>


<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1319-1" title="1"><span class="co">## by_group() chain 연결</span></a>
<a class="sourceLine" id="cb1319-2" title="2">mean_mpg &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1319-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(model, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1319-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_cty =</span> <span class="kw">mean</span>(cty), </a>
<a class="sourceLine" id="cb1319-5" title="5">            <span class="dt">mean_hwy =</span> <span class="kw">mean</span>(hwy)) </a></code></pre></div>

<ul>
<li><code>group_by()</code> 이후 적용되는 동사는 모두 그룹 별 연산 수행</li>
</ul>

<div class="sourceCode" id="cb1320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1320-1" title="1"><span class="co"># 제조사 별 시내연비가 낮은 순으로 정렬</span></a>
<a class="sourceLine" id="cb1320-2" title="2">audi &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(manufacturer) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(cty) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-5" title="5"><span class="st">  </span><span class="kw">filter</span>(manufacturer <span class="op">==</span><span class="st"> &quot;audi&quot;</span>)</a>
<a class="sourceLine" id="cb1320-6" title="6"></a>
<a class="sourceLine" id="cb1320-7" title="7">audi <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 18 x 11
# Groups:   manufacturer [1]
   manufacturer model    displ  year   cyl trans   drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4 quat~   2.8  1999     6 auto(l~ 4        15    25 p     comp~
 2 audi         a4 quat~   3.1  2008     6 manual~ 4        15    25 p     comp~
 3 audi         a6 quat~   2.8  1999     6 auto(l~ 4        15    24 p     mids~
 4 audi         a4         2.8  1999     6 auto(l~ f        16    26 p     comp~
 5 audi         a4 quat~   1.8  1999     4 auto(l~ 4        16    25 p     comp~
 6 audi         a6 quat~   4.2  2008     8 auto(s~ 4        16    23 p     mids~
 7 audi         a4 quat~   2.8  1999     6 manual~ 4        17    25 p     comp~
 8 audi         a4 quat~   3.1  2008     6 auto(s~ 4        17    25 p     comp~
 9 audi         a6 quat~   3.1  2008     6 auto(s~ 4        17    25 p     mids~
10 audi         a4         1.8  1999     4 auto(l~ f        18    29 p     comp~
11 audi         a4         2.8  1999     6 manual~ f        18    26 p     comp~
12 audi         a4         3.1  2008     6 auto(a~ f        18    27 p     comp~
13 audi         a4 quat~   1.8  1999     4 manual~ 4        18    26 p     comp~
14 audi         a4 quat~   2    2008     4 auto(s~ 4        19    27 p     comp~
15 audi         a4         2    2008     4 manual~ f        20    31 p     comp~
16 audi         a4 quat~   2    2008     4 manual~ 4        20    28 p     comp~
17 audi         a4         1.8  1999     4 manual~ f        21    29 p     comp~
18 audi         a4         2    2008     4 auto(a~ f        21    30 p     comp~</code></pre>



<div class="rmdtip">
그룹화된 데이터셋을 다시 그룹화 하지 않은 원래 데이터셋으로 변경할 때 <code>ungroup()</code> 함수를 사용
</div>


</div>
<div id="dplyr-application" class="section level3">
<h3><span class="header-section-number">4.4.9</span> dplyr 관련 유용한 함수</h3>
<ul>
<li>데이터 핸들링 시 dplyr 기본 함수와 같이 사용되는 함수 모음</li>
</ul>
<div id="dplyr-slice" class="section level4 unnumbered">
<h4><code>slice()</code></h4>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사: <code>filter()</code>의 특별한 케이스로 데이터의 색인을 직접 설정하여 원하는 row 추출</strong></p>
</blockquote>

<div class="sourceCode" id="cb1322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1322-1" title="1"><span class="co"># 1 ~ 8행에 해당하는 데이터 추출</span></a>
<a class="sourceLine" id="cb1322-2" title="2">slice_mpg &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb1322-3" title="3">slice_mpg <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 8 x 11
  manufacturer model    displ  year   cyl trans   drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4         1.8  1999     4 auto(l~ f        18    29 p     compa~
2 audi         a4         1.8  1999     4 manual~ f        21    29 p     compa~
3 audi         a4         2    2008     4 manual~ f        20    31 p     compa~
4 audi         a4         2    2008     4 auto(a~ f        21    30 p     compa~
5 audi         a4         2.8  1999     6 auto(l~ f        16    26 p     compa~
6 audi         a4         2.8  1999     6 manual~ f        18    26 p     compa~
7 audi         a4         3.1  2008     6 auto(a~ f        18    27 p     compa~
8 audi         a4 quat~   1.8  1999     4 manual~ 4        18    26 p     compa~</code></pre>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1324-1" title="1"><span class="co"># 각 모델 별 첫 번째 데이터만 추출</span></a>
<a class="sourceLine" id="cb1324-2" title="2">slice_mpg_grp &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(model) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-4" title="4"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(model)</a>
<a class="sourceLine" id="cb1324-6" title="6"></a>
<a class="sourceLine" id="cb1324-7" title="7">slice_mpg_grp <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 38 x 11
# Groups:   model [38]
   manufacturer model    displ  year   cyl trans  drv     cty   hwy fl    class 
   &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
 1 toyota       4runner~   2.7  1999     4 manua~ 4        15    20 r     suv   
 2 audi         a4         1.8  1999     4 auto(~ f        18    29 p     compa~
 3 audi         a4 quat~   1.8  1999     4 manua~ 4        18    26 p     compa~
 4 audi         a6 quat~   2.8  1999     6 auto(~ 4        15    24 p     midsi~
 5 nissan       altima     2.4  1999     4 manua~ f        21    29 r     compa~
 6 chevrolet    c1500 s~   5.3  2008     8 auto(~ r        14    20 r     suv   
 7 toyota       camry      2.2  1999     4 manua~ f        21    29 r     midsi~
 8 toyota       camry s~   2.2  1999     4 auto(~ f        21    27 r     compa~
 9 dodge        caravan~   2.4  1999     4 auto(~ f        18    24 r     miniv~
10 honda        civic      1.6  1999     4 manua~ f        28    33 r     subco~
# ... with 28 more rows</code></pre>

</div>
<div id="dplyr-topn" class="section level4 unnumbered">
<h4><code>top_n()</code></h4>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사: 선택한 변수를 기준으로 상위 <code>n</code> 개의 데이터(행)만 추출</strong></p>
</blockquote>

<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1326-1" title="1"><span class="co"># mpg 데이터에서 시내 연비가 높은 데이터 5개 추출</span></a>
<a class="sourceLine" id="cb1326-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1326-3" title="3"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>, cty) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1326-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cty))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"volkswagen","2":"new beetle","3":"1.9","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"35","9":"44","10":"d","11":"subcompact"},{"1":"volkswagen","2":"jetta","3":"1.9","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"33","9":"44","10":"d","11":"compact"},{"1":"volkswagen","2":"new beetle","3":"1.9","4":"1999","5":"4","6":"auto(l4)","7":"f","8":"29","9":"41","10":"d","11":"subcompact"},{"1":"honda","2":"civic","3":"1.6","4":"1999","5":"4","6":"manual(m5)","7":"f","8":"28","9":"33","10":"r","11":"subcompact"},{"1":"toyota","2":"corolla","3":"1.8","4":"2008","5":"4","6":"manual(m5)","7":"f","8":"28","9":"37","10":"r","11":"compact"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
<div id="dplyr-distinct" class="section level4 unnumbered">
<h4><code>distinct()</code></h4>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사: 선택한 변수를 기준으로 중복 없는 유일한(unique)한 행 추출 시 사용</strong></p>
</blockquote>
<ul>
<li>R base 패키지의 <code>unique()</code> 또는 <code>unqiue.data.frame()</code>과 유사하게 작동하지만 처리 속도 면에서 뛰어남</li>
</ul>

<div class="sourceCode" id="cb1327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1327-1" title="1"><span class="co"># mpg 데이터에서 중복데이터 제거 (모든 열 기준)</span></a>
<a class="sourceLine" id="cb1327-2" title="2">mpg_uniq &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>()</a>
<a class="sourceLine" id="cb1327-3" title="3">mpg_uniq <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 225 x 11
   manufacturer model    displ  year   cyl trans   drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4         1.8  1999     4 auto(l~ f        18    29 p     comp~
 2 audi         a4         1.8  1999     4 manual~ f        21    29 p     comp~
 3 audi         a4         2    2008     4 manual~ f        20    31 p     comp~
 4 audi         a4         2    2008     4 auto(a~ f        21    30 p     comp~
 5 audi         a4         2.8  1999     6 auto(l~ f        16    26 p     comp~
 6 audi         a4         2.8  1999     6 manual~ f        18    26 p     comp~
 7 audi         a4         3.1  2008     6 auto(a~ f        18    27 p     comp~
 8 audi         a4 quat~   1.8  1999     4 manual~ 4        18    26 p     comp~
 9 audi         a4 quat~   1.8  1999     4 auto(l~ 4        16    25 p     comp~
10 audi         a4 quat~   2    2008     4 manual~ 4        20    28 p     comp~
# ... with 215 more rows</code></pre>
<div class="sourceCode" id="cb1329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1329-1" title="1"><span class="co"># model을 기준으로 중복 데이터 제거</span></a>
<a class="sourceLine" id="cb1329-2" title="2">mpg_uniq2 &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1329-3" title="3"><span class="st">  </span><span class="kw">distinct</span>(model, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1329-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(model)</a>
<a class="sourceLine" id="cb1329-5" title="5"></a>
<a class="sourceLine" id="cb1329-6" title="6">mpg_uniq2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 11
  manufacturer model     displ  year   cyl trans   drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 toyota       4runner ~   2.7  1999     4 manual~ 4        15    20 r     suv  
2 audi         a4          1.8  1999     4 auto(l~ f        18    29 p     comp~
3 audi         a4 quatt~   1.8  1999     4 manual~ 4        18    26 p     comp~
4 audi         a6 quatt~   2.8  1999     6 auto(l~ 4        15    24 p     mids~
5 nissan       altima      2.4  1999     4 manual~ f        21    29 r     comp~
6 chevrolet    c1500 su~   5.3  2008     8 auto(l~ r        14    20 r     suv  </code></pre>
<div class="sourceCode" id="cb1331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1331-1" title="1"><span class="co"># 위 그룹별 slice(1) 예제와 비교</span></a>
<a class="sourceLine" id="cb1331-2" title="2"><span class="kw">identical</span>(slice_mpg_grp <span class="op">%&gt;%</span><span class="st"> </span>ungroup, mpg_uniq2)</a></code></pre></div>
<pre><code>[1] TRUE</code></pre>

</div>
<div id="dplyr-sample" class="section level4 unnumbered">
<h4><code>sample_n()/sample_frac()</code></h4>
<blockquote>
<p><strong>행(row, case, observation) 조작 동사: 데이터의 행을 랜덤하게 추출하는 함수</strong></p>
</blockquote>
<ul>
<li><code>sample_(n)</code>: 전체 <span class="math inline">\(N\)</span> 행에서 <span class="math inline">\(n\)</span> 행을 랜덤하게 추출</li>
<li><code>sample_frac(p)</code>: 전체 <span class="math inline">\(N\)</span> 행에서 비율 <span class="math inline">\(p\)</span> (<span class="math inline">\(0\leq p \leq1\)</span>) 만큼 추출</li>
</ul>

<div class="sourceCode" id="cb1333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1333-1" title="1"><span class="co"># 전체 234개 행에서 3개 행을 랜덤하게 추출</span></a>
<a class="sourceLine" id="cb1333-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">3</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"honda","2":"civic","3":"1.8","4":"2008","5":"4","6":"manual(m5)","7":"f","8":"26","9":"34","10":"r","11":"subcompact"},{"1":"chevrolet","2":"c1500 suburban 2wd","3":"5.3","4":"2008","5":"8","6":"auto(l4)","7":"r","8":"14","9":"20","10":"r","11":"suv"},{"1":"chevrolet","2":"corvette","3":"6.2","4":"2008","5":"8","6":"auto(s6)","7":"r","8":"15","9":"25","10":"p","11":"2seater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb1334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1334-1" title="1"><span class="co"># 전체 234개 행의 5%에 해당하는 행을 랜덤하게 추출</span></a>
<a class="sourceLine" id="cb1334-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_frac</span>(<span class="fl">0.05</span>)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["manufacturer"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["displ"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["int"],"align":["right"]},{"label":["cyl"],"name":[5],"type":["int"],"align":["right"]},{"label":["trans"],"name":[6],"type":["chr"],"align":["left"]},{"label":["drv"],"name":[7],"type":["chr"],"align":["left"]},{"label":["cty"],"name":[8],"type":["int"],"align":["right"]},{"label":["hwy"],"name":[9],"type":["int"],"align":["right"]},{"label":["fl"],"name":[10],"type":["chr"],"align":["left"]},{"label":["class"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"dodge","2":"durango 4wd","3":"3.9","4":"1999","5":"6","6":"auto(l4)","7":"4","8":"13","9":"17","10":"r","11":"suv"},{"1":"toyota","2":"4runner 4wd","3":"3.4","4":"1999","5":"6","6":"manual(m5)","7":"4","8":"15","9":"17","10":"r","11":"suv"},{"1":"lincoln","2":"navigator 2wd","3":"5.4","4":"1999","5":"8","6":"auto(l4)","7":"r","8":"11","9":"16","10":"p","11":"suv"},{"1":"subaru","2":"impreza awd","3":"2.5","4":"1999","5":"4","6":"manual(m5)","7":"4","8":"19","9":"26","10":"r","11":"subcompact"},{"1":"dodge","2":"ram 1500 pickup 4wd","3":"4.7","4":"2008","5":"8","6":"auto(l5)","7":"4","8":"9","9":"12","10":"e","11":"pickup"},{"1":"dodge","2":"caravan 2wd","3":"3.8","4":"1999","5":"6","6":"auto(l4)","7":"f","8":"15","9":"22","10":"r","11":"minivan"},{"1":"honda","2":"civic","3":"1.8","4":"2008","5":"4","6":"auto(l5)","7":"f","8":"25","9":"36","10":"r","11":"subcompact"},{"1":"land rover","2":"range rover","3":"4.0","4":"1999","5":"8","6":"auto(l4)","7":"4","8":"11","9":"15","10":"p","11":"suv"},{"1":"dodge","2":"dakota pickup 4wd","3":"3.7","4":"2008","5":"6","6":"manual(m6)","7":"4","8":"15","9":"19","10":"r","11":"pickup"},{"1":"dodge","2":"dakota pickup 4wd","3":"4.7","4":"2008","5":"8","6":"auto(l5)","7":"4","8":"14","9":"19","10":"r","11":"pickup"},{"1":"ford","2":"mustang","3":"4.6","4":"1999","5":"8","6":"manual(m5)","7":"r","8":"15","9":"22","10":"r","11":"subcompact"},{"1":"subaru","2":"forester awd","3":"2.5","4":"2008","5":"4","6":"manual(m5)","7":"4","8":"20","9":"27","10":"r","11":"suv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
<div id="dplyr-rename" class="section level4 unnumbered">
<h4><code>rename()</code></h4>
<blockquote>
<p><strong>열(변수) 조작 동사: 변수의 이름을 변경하는 함수</strong></p>
</blockquote>
<ul>
<li><code>rename(new_variable_name = old_variable_name)</code> 형태로 변경</li>
</ul>

<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1335-1" title="1"><span class="co"># 변수명 변셩 </span></a>
<a class="sourceLine" id="cb1335-2" title="2"><span class="co">## R 기본 문법으로 변수명 변경</span></a>
<a class="sourceLine" id="cb1335-3" title="3">varn_mpg &lt;-<span class="st"> </span><span class="kw">names</span>(mpg) <span class="co"># 원 변수명 저장</span></a>
<a class="sourceLine" id="cb1335-4" title="4"><span class="kw">names</span>(mpg)[<span class="dv">5</span>] &lt;-<span class="st"> &quot;cylinder&quot;</span> <span class="co"># cyl을 cylinder로 변셩</span></a>
<a class="sourceLine" id="cb1335-5" title="5"><span class="kw">names</span>(mpg) &lt;-<span class="st"> </span>varn_mpg <span class="co">#</span></a>
<a class="sourceLine" id="cb1335-6" title="6"></a>
<a class="sourceLine" id="cb1335-7" title="7"><span class="co">## Tidyverse 문법: rename() 사용</span></a>
<a class="sourceLine" id="cb1335-8" title="8">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1335-9" title="9"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">cylinder =</span> cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1335-10" title="10"><span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1335-11" title="11"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 11
  manufacturer model displ  year cylinder trans    drv     cty   hwy fl    class
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt;    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
1 audi         a4      1.8  1999        4 auto(l5) f        18    29 p     comp~
2 audi         a4      1.8  1999        4 manual(~ f        21    29 p     comp~
3 audi         a4      2    2008        4 manual(~ f        20    31 p     comp~
4 audi         a4      2    2008        4 auto(av) f        21    30 p     comp~
5 audi         a4      2.8  1999        6 auto(l5) f        16    26 p     comp~
6 audi         a4      2.8  1999        6 manual(~ f        18    26 p     comp~</code></pre>
<div class="sourceCode" id="cb1337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1337-1" title="1"><span class="co">## cty를 city_mpg, hwy를 hw_mpg로 변경</span></a>
<a class="sourceLine" id="cb1337-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1337-3" title="3"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">city_mpg =</span> cty, </a>
<a class="sourceLine" id="cb1337-4" title="4">         <span class="dt">hw_mpg =</span> hwy) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1337-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 11
   manufacturer model  displ  year   cyl trans drv   city_mpg hw_mpg fl    class
   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4       1.8  1999     4 auto~ f           18     29 p     comp~
 2 audi         a4       1.8  1999     4 manu~ f           21     29 p     comp~
 3 audi         a4       2    2008     4 manu~ f           20     31 p     comp~
 4 audi         a4       2    2008     4 auto~ f           21     30 p     comp~
 5 audi         a4       2.8  1999     6 auto~ f           16     26 p     comp~
 6 audi         a4       2.8  1999     6 manu~ f           18     26 p     comp~
 7 audi         a4       3.1  2008     6 auto~ f           18     27 p     comp~
 8 audi         a4 qu~   1.8  1999     4 manu~ 4           18     26 p     comp~
 9 audi         a4 qu~   1.8  1999     4 auto~ 4           16     25 p     comp~
10 audi         a4 qu~   2    2008     4 manu~ 4           20     28 p     comp~
# ... with 224 more rows</code></pre>

<p><br/></p>
</div>
<div id="dplyr-count" class="section level4 unnumbered">
<h4><strong>Count 관련 동사(함수)</strong></h4>
<blockquote>
<p>데이터셋의 행 개수를 집계하는 함수들로 데이터 요약 시 유용하게 사용</p>
</blockquote>
</div>
<div id="tally" class="section level4 unnumbered">
<h4><code>tally()</code></h4>
<ul>
<li>총계, 행의 개수를 반환하는 함수<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></li>
<li>데이터 프레임(티블) 객체 반환</li>
</ul>

<div class="sourceCode" id="cb1339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1339-1" title="1"><span class="co"># 전체 행 개수 (nrow(data))와 유사</span></a>
<a class="sourceLine" id="cb1339-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1339-3" title="3"><span class="st">  </span>tally <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1339-4" title="4"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1   234</code></pre>
<div class="sourceCode" id="cb1341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1341-1" title="1"><span class="co"># 제조사, 년도별 데이터 개수 </span></a>
<a class="sourceLine" id="cb1341-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1341-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(manufacturer, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1341-4" title="4"><span class="st">  </span>tally <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1341-5" title="5"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1341-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 30 x 3
   manufacturer  year     n
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt;
 1 audi          1999     9
 2 audi          2008     9
 3 chevrolet     1999     7
 4 chevrolet     2008    12
 5 dodge         1999    16
 6 dodge         2008    21
 7 ford          1999    15
 8 ford          2008    10
 9 honda         1999     5
10 honda         2008     4
# ... with 20 more rows</code></pre>

</div>
<div id="count" class="section level4 unnumbered">
<h4><code>count()</code></h4>
<ul>
<li><code>tally()</code> 함수와 유사하나 개수 집계 전 <code>group_by()</code>와 집계 후 <code>ungroup()</code>을 실행</li>
</ul>

<div class="sourceCode" id="cb1343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1343-1" title="1"><span class="co"># 제조사, 년도별 데이터 개수: tally() 예시와 비교</span></a>
<a class="sourceLine" id="cb1343-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1343-3" title="3"><span class="st">  </span><span class="kw">count</span>(manufacturer, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1343-4" title="4"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 30 x 3
   manufacturer  year     n
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt;
 1 audi          1999     9
 2 audi          2008     9
 3 chevrolet     1999     7
 4 chevrolet     2008    12
 5 dodge         1999    16
 6 dodge         2008    21
 7 ford          1999    15
 8 ford          2008    10
 9 honda         1999     5
10 honda         2008     4
# ... with 20 more rows</code></pre>

</div>
<div id="n-dplyr" class="section level4 unnumbered">
<h4><code>n()</code></h4>
<ul>
<li>위에서 소개한 함수와 유사하게 행 개수를 반환하지만, 기본 동사(<code>summarise()</code>, <code>mutate()</code>, <code>filter()</code>) 내에서만 사용</li>
</ul>

<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1345-1" title="1"><span class="co"># 제조사, 년도에 따른 배기량, 시내연비의 평균 계산(그룹 별 n 포함)</span></a>
<a class="sourceLine" id="cb1345-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1345-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(manufacturer, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1345-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb1345-5" title="5">    <span class="dt">N =</span> <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb1345-6" title="6">    <span class="dt">mean_displ =</span> <span class="kw">mean</span>(displ), </a>
<a class="sourceLine" id="cb1345-7" title="7">    <span class="dt">mean_hwy =</span> <span class="kw">mean</span>(cty)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1345-8" title="8"><span class="st">  </span>print</a></code></pre></div>
<pre><code>`summarise()` regrouping output by &#39;manufacturer&#39; (override with `.groups` argument)</code></pre>
<pre><code># A tibble: 30 x 5
# Groups:   manufacturer [15]
   manufacturer  year     N mean_displ mean_hwy
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;
 1 audi          1999     9       2.36     17.1
 2 audi          2008     9       2.73     18.1
 3 chevrolet     1999     7       4.97     15.1
 4 chevrolet     2008    12       5.12     14.9
 5 dodge         1999    16       4.32     13.4
 6 dodge         2008    21       4.42     13.0
 7 ford          1999    15       4.45     13.9
 8 ford          2008    10       4.66     14.1
 9 honda         1999     5       1.6      24.8
10 honda         2008     4       1.85     24  
# ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb1348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1348-1" title="1"><span class="co"># mutate, filter에서 사용하는 경우</span></a>
<a class="sourceLine" id="cb1348-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1348-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(manufacturer, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1348-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">N =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1348-5" title="5"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">n</span>() <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1348-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 18 x 12
# Groups:   manufacturer, year [9]
   manufacturer model displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 jeep         gran~   4    1999     6 auto~ 4        15    20 r     suv  
 2 jeep         gran~   4.7  1999     8 auto~ 4        14    17 r     suv  
 3 land rover   rang~   4    1999     8 auto~ 4        11    15 p     suv  
 4 land rover   rang~   4.2  2008     8 auto~ 4        12    18 r     suv  
 5 land rover   rang~   4.4  2008     8 auto~ 4        12    18 r     suv  
 6 land rover   rang~   4.6  1999     8 auto~ 4        11    15 p     suv  
 7 lincoln      navi~   5.4  1999     8 auto~ r        11    17 r     suv  
 8 lincoln      navi~   5.4  1999     8 auto~ r        11    16 p     suv  
 9 lincoln      navi~   5.4  2008     8 auto~ r        12    18 r     suv  
10 mercury      moun~   4    1999     6 auto~ 4        14    17 r     suv  
11 mercury      moun~   4    2008     6 auto~ 4        13    19 r     suv  
12 mercury      moun~   4.6  2008     8 auto~ 4        13    19 r     suv  
13 mercury      moun~   5    1999     8 auto~ 4        13    17 r     suv  
14 pontiac      gran~   3.1  1999     6 auto~ f        18    26 r     mids~
15 pontiac      gran~   3.8  1999     6 auto~ f        16    26 p     mids~
16 pontiac      gran~   3.8  1999     6 auto~ f        17    27 r     mids~
17 pontiac      gran~   3.8  2008     6 auto~ f        18    28 r     mids~
18 pontiac      gran~   5.3  2008     8 auto~ f        16    25 p     mids~
# ... with 1 more variable: N &lt;int&gt;</code></pre>

</div>
</div>
<div id="dplyr-verb-variant-adverb" class="section level3">
<h3><span class="header-section-number">4.4.10</span> 부가 기능</h3>
<ul>
<li><p>위에서 소개한 dplyr 패키지의 기본 동사 함수를 조금 더 효율적으로 사용(예: 특정 조건을 만족하는 두 개 이상의 변수에 함수 적용)하기 위한 범위 지정 함수로서 아래와 같은 부사(adverb), 접속사 또는 전치사가 본 동사 뒤에 붙음</p>
<ol style="list-style-type: lower-alpha">
<li><code>*_all</code>: 모든 변수에 적용</li>
<li><code>*_at</code>: <code>vars()</code> 함수를 이용해 선택한 변수에 적용</li>
<li><code>*_if</code>: 조건식 또는 조건 함수로 선택한 변수에 적용</li>
</ol></li>
<li><p>여기서 <code>*</code> = {<code>filter</code>, <code>arrange</code>, <code>select</code>, <code>rename</code>, <strong><code>mutate</code></strong>, <code>transmute</code>, <strong><code>summarise</code></strong>, <code>group_by</code>}</p></li>
<li><p>적용할 변수들은 대명사(pronoun)로 지칭되며, <code>.</code>로 나타냄</p></li>
<li><p><code>vars()</code>는 <code>*_at</code> 계열 함수 내에서 변수를 선택해주는 함수로 <code>select()</code> 함수와 동일한 문법으로 사용 가능(단독으로는 사용하지 않음)</p></li>
</ul>
<div id="filter-variant" class="section level4 unnumbered">
<h4><code>filter_all()</code>, <code>filter_at()</code>, <code>filter_if()</code></h4>
<blockquote>
<ul>
<li><code>filter_all()</code>:<code>all_vars()</code> 또는 <code>any_vars()</code> 라는 조건 함수와 같이 사용되며, 해당 함수 내에 변수는 대명사 <code>.</code>로 나타냄</li>
<li><code>filter_at()</code>: 변수 선택 지시자 <code>vars()</code>와 <code>vars()</code>에서 선택한 변수에 적용할 조건식 또는 조건 함수를 인수로 받음. 조건식 설정 시 <code>vars()</code> 에 포함된 변수들은 대명사 <code>.</code> 으로 표시</li>
<li><code>filter_if()</code>: 조건을 만족하는 변수들을 선택한 후, 선택한 변수들 중 모두 또는 하나라도 입력한 조건을 만족하는 행 추출</li>
</ul>
</blockquote>

<div class="sourceCode" id="cb1350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1350-1" title="1"><span class="co"># mtcars 데이터셋 사용</span></a>
<a class="sourceLine" id="cb1350-2" title="2"><span class="co">## filter_all()</span></a>
<a class="sourceLine" id="cb1350-3" title="3"><span class="co">### 모든 변수들이 100 보다 큰 케이스 추출</span></a>
<a class="sourceLine" id="cb1350-4" title="4">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1350-5" title="5"><span class="st">  </span><span class="kw">filter_all</span>(<span class="kw">all_vars</span>(. <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1350-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code> [1] mpg  cyl  disp hp   drat wt   qsec vs   am   gear carb
&lt;0 행&gt; &lt;또는 row.names의 길이가 0입니다&gt;</code></pre>
<div class="sourceCode" id="cb1352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1352-1" title="1"><span class="co">### 모든 변수들 중 하나라도 300 보다 큰 케이스 추출</span></a>
<a class="sourceLine" id="cb1352-2" title="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1352-3" title="3"><span class="st">  </span><span class="kw">filter_all</span>(<span class="kw">any_vars</span>(. <span class="op">&gt;</span><span class="st"> </span><span class="dv">300</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1352-4" title="4"><span class="st">  </span>print</a></code></pre></div>
<pre><code>                     mpg cyl disp  hp drat    wt  qsec vs am gear carb
Hornet Sportabout   18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Duster 360          14.3   8  360 245 3.21 3.570 15.84  0  0    3    4
Cadillac Fleetwood  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8  440 230 3.23 5.345 17.42  0  0    3    4
Dodge Challenger    15.5   8  318 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8  304 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8  350 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8  400 175 3.08 3.845 17.05  0  0    3    2
Ford Pantera L      15.8   8  351 264 4.22 3.170 14.50  0  1    5    4
Maserati Bora       15.0   8  301 335 3.54 3.570 14.60  0  1    5    8</code></pre>
<div class="sourceCode" id="cb1354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1354-1" title="1"><span class="co">## filter_at()</span></a>
<a class="sourceLine" id="cb1354-2" title="2"><span class="co">### 기어 개수(gear)와 기화기 개수(carb)가 짝수인 케이스만 추출</span></a>
<a class="sourceLine" id="cb1354-3" title="3">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1354-4" title="4"><span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(gear, carb),</a>
<a class="sourceLine" id="cb1354-5" title="5">            <span class="op">~</span><span class="st"> </span>. <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 대명사 앞에 ~ 표시를 꼭 사용해야 함</span></a>
<a class="sourceLine" id="cb1354-6" title="6"><span class="st">  </span>print</a></code></pre></div>
<pre><code>               mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4     21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Merc 240D     24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230      22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280      19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C     17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Honda Civic   30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Volvo 142E    21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<div class="sourceCode" id="cb1356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1356-1" title="1"><span class="co">## filter_if()</span></a>
<a class="sourceLine" id="cb1356-2" title="2"><span class="co">### 내림한 값이 원래 값과 같은 변수들 모두 0이 아닌 케이스 추출</span></a>
<a class="sourceLine" id="cb1356-3" title="3">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1356-4" title="4"><span class="st">  </span><span class="kw">filter_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">all</span>(<span class="kw">floor</span>(.) <span class="op">==</span><span class="st"> </span>.), </a>
<a class="sourceLine" id="cb1356-5" title="5">            <span class="kw">all_vars</span>(. <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1356-6" title="6"><span class="st">  </span><span class="co"># filter_if(~ all(floor(.) == .),</span></a>
<a class="sourceLine" id="cb1356-7" title="7"><span class="st">  </span><span class="co">#           ~ . != 0) %&gt;%</span></a>
<a class="sourceLine" id="cb1356-8" title="8"><span class="st">  </span>print</a></code></pre></div>
<pre><code>                mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Lotus Europa   30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>

</div>
<div id="select-variant" class="section level4 unnumbered">
<h4><code>select_all()</code>, <code>select_at()</code>, <code>select_if()</code></h4>
<blockquote>
<p>변수 선택과 변수명 변경을 동시에 수행</p>
</blockquote>

<div class="sourceCode" id="cb1358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1358-1" title="1"><span class="co"># select_all() 예시</span></a>
<a class="sourceLine" id="cb1358-2" title="2"><span class="co">## mpg 데이터셋의 모든 변수명을 대문자로 변경</span></a>
<a class="sourceLine" id="cb1358-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1358-4" title="4"><span class="st">  </span><span class="kw">select_all</span>(<span class="op">~</span><span class="kw">toupper</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1358-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 11
   MANUFACTURER MODEL    DISPL  YEAR   CYL TRANS   DRV     CTY   HWY FL    CLASS
   &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4         1.8  1999     4 auto(l~ f        18    29 p     comp~
 2 audi         a4         1.8  1999     4 manual~ f        21    29 p     comp~
 3 audi         a4         2    2008     4 manual~ f        20    31 p     comp~
 4 audi         a4         2    2008     4 auto(a~ f        21    30 p     comp~
 5 audi         a4         2.8  1999     6 auto(l~ f        16    26 p     comp~
 6 audi         a4         2.8  1999     6 manual~ f        18    26 p     comp~
 7 audi         a4         3.1  2008     6 auto(a~ f        18    27 p     comp~
 8 audi         a4 quat~   1.8  1999     4 manual~ 4        18    26 p     comp~
 9 audi         a4 quat~   1.8  1999     4 auto(l~ 4        16    25 p     comp~
10 audi         a4 quat~   2    2008     4 manual~ 4        20    28 p     comp~
# ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb1360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1360-1" title="1"><span class="co"># select_if() 예시</span></a>
<a class="sourceLine" id="cb1360-2" title="2"><span class="co">## 문자형 변수를 선택하고 선택한 변수의 이름을 대문자로 변경</span></a>
<a class="sourceLine" id="cb1360-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1360-4" title="4"><span class="st">  </span><span class="kw">select_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.character</span>(.), <span class="op">~</span><span class="st"> </span><span class="kw">toupper</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1360-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 6
   MANUFACTURER MODEL      TRANS      DRV   FL    CLASS  
   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  
 1 audi         a4         auto(l5)   f     p     compact
 2 audi         a4         manual(m5) f     p     compact
 3 audi         a4         manual(m6) f     p     compact
 4 audi         a4         auto(av)   f     p     compact
 5 audi         a4         auto(l5)   f     p     compact
 6 audi         a4         manual(m5) f     p     compact
 7 audi         a4         auto(av)   f     p     compact
 8 audi         a4 quattro manual(m5) 4     p     compact
 9 audi         a4 quattro auto(l5)   4     p     compact
10 audi         a4 quattro manual(m6) 4     p     compact
# ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb1362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1362-1" title="1"><span class="co"># select_at() 예시</span></a>
<a class="sourceLine" id="cb1362-2" title="2"><span class="co">## model에서 cty 까지 변수를 선택하고 선택한 변수명을 대문자로 변경</span></a>
<a class="sourceLine" id="cb1362-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1362-4" title="4"><span class="st">  </span><span class="kw">select_at</span>(<span class="kw">vars</span>(model<span class="op">:</span>cty), <span class="op">~</span><span class="st"> </span><span class="kw">toupper</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1362-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 7
   MODEL      DISPL  YEAR   CYL TRANS      DRV     CTY
   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt;
 1 a4           1.8  1999     4 auto(l5)   f        18
 2 a4           1.8  1999     4 manual(m5) f        21
 3 a4           2    2008     4 manual(m6) f        20
 4 a4           2    2008     4 auto(av)   f        21
 5 a4           2.8  1999     6 auto(l5)   f        16
 6 a4           2.8  1999     6 manual(m5) f        18
 7 a4           3.1  2008     6 auto(av)   f        18
 8 a4 quattro   1.8  1999     4 manual(m5) 4        18
 9 a4 quattro   1.8  1999     4 auto(l5)   4        16
10 a4 quattro   2    2008     4 manual(m6) 4        20
# ... with 224 more rows</code></pre>

</div>
<div id="mutate-variant" class="section level4 unnumbered">
<h4><code>mutate_all()</code>, <code>mutate_at()</code>, <code>mutate_if()</code></h4>
<blockquote>
<p><strong>실제 데이터 전처리 시 가장 많이 사용</strong></p>
<ul>
<li><code>mutate_all()</code>: 모든 변수에 적용(모든 데이터가 동일한 데이터 타입인 경우 유용)</li>
<li><code>mutate_at()</code>: 선택한 변수에 적용. <code>vars()</code> 함수로 선택</li>
<li><code>mutate_if()</code>: 특정 조건을 만족하는 변수에 적용</li>
</ul>
</blockquote>

<div class="sourceCode" id="cb1364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1364-1" title="1"><span class="co"># mutate_all() 예시</span></a>
<a class="sourceLine" id="cb1364-2" title="2"><span class="co">## 문자형 변수를 선택 후 모든 변수를 요인형으로 변환</span></a>
<a class="sourceLine" id="cb1364-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1364-4" title="4"><span class="st">  </span><span class="kw">select_if</span>(<span class="op">~</span><span class="kw">is.character</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1364-5" title="5"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="op">~</span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1364-6" title="6"><span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1364-7" title="7"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 6
  manufacturer model trans      drv   fl    class  
  &lt;fct&gt;        &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  
1 audi         a4    auto(l5)   f     p     compact
2 audi         a4    manual(m5) f     p     compact
3 audi         a4    manual(m6) f     p     compact
4 audi         a4    auto(av)   f     p     compact
5 audi         a4    auto(l5)   f     p     compact
6 audi         a4    manual(m5) f     p     compact</code></pre>
<div class="sourceCode" id="cb1366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1366-1" title="1"><span class="co"># mutate_at() 예시</span></a>
<a class="sourceLine" id="cb1366-2" title="2"><span class="co">## cty, hwy 단위를 km/l로 변경</span></a>
<a class="sourceLine" id="cb1366-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1366-4" title="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(cty, hwy), </a>
<a class="sourceLine" id="cb1366-5" title="5">            <span class="op">~</span><span class="st"> </span>. <span class="op">*</span><span class="st"> </span>kpl) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># 원래 변수를 변경</span></a>
<a class="sourceLine" id="cb1366-6" title="6"><span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1366-7" title="7"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 6 x 11
  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4      1.8  1999     4 auto(l5)   f      7.65  12.3 p     compa~
2 audi         a4      1.8  1999     4 manual(m5) f      8.92  12.3 p     compa~
3 audi         a4      2    2008     4 manual(m6) f      8.50  13.2 p     compa~
4 audi         a4      2    2008     4 auto(av)   f      8.92  12.7 p     compa~
5 audi         a4      2.8  1999     6 auto(l5)   f      6.80  11.0 p     compa~
6 audi         a4      2.8  1999     6 manual(m5) f      7.65  11.0 p     compa~</code></pre>
<div class="sourceCode" id="cb1368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1368-1" title="1"><span class="co">## &quot;m&quot;으로 시작하거나 &quot;s&quot;로 끝나는 변수 선택 후 요인형으로 변환</span></a>
<a class="sourceLine" id="cb1368-2" title="2">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1368-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">starts_with</span>(<span class="st">&quot;m&quot;</span>), </a>
<a class="sourceLine" id="cb1368-4" title="4">                 <span class="kw">ends_with</span>(<span class="st">&quot;s&quot;</span>)), </a>
<a class="sourceLine" id="cb1368-5" title="5">            <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1368-6" title="6"><span class="st">  </span>summary</a></code></pre></div>
<pre><code>     manufacturer                 model         displ            year     
 dodge     :37    caravan 2wd        : 11   Min.   :1.600   Min.   :1999  
 toyota    :34    ram 1500 pickup 4wd: 10   1st Qu.:2.400   1st Qu.:1999  
 volkswagen:27    civic              :  9   Median :3.300   Median :2004  
 ford      :25    dakota pickup 4wd  :  9   Mean   :3.472   Mean   :2004  
 chevrolet :19    jetta              :  9   3rd Qu.:4.600   3rd Qu.:2008  
 audi      :18    mustang            :  9   Max.   :7.000   Max.   :2008  
 (Other)   :74    (Other)            :177                                 
      cyl               trans        drv                 cty       
 Min.   :4.000   auto(l4)  :83   Length:234         Min.   : 9.00  
 1st Qu.:4.000   manual(m5):58   Class :character   1st Qu.:14.00  
 Median :6.000   auto(l5)  :39   Mode  :character   Median :17.00  
 Mean   :5.889   manual(m6):19                      Mean   :16.86  
 3rd Qu.:8.000   auto(s6)  :16                      3rd Qu.:19.00  
 Max.   :8.000   auto(l6)  : 6                      Max.   :35.00  
                 (Other)   :13                                     
      hwy             fl                   class   
 Min.   :12.00   Length:234         2seater   : 5  
 1st Qu.:18.00   Class :character   compact   :47  
 Median :24.00   Mode  :character   midsize   :41  
 Mean   :23.44                      minivan   :11  
 3rd Qu.:27.00                      pickup    :33  
 Max.   :44.00                      subcompact:35  
                                    suv       :62  </code></pre>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1370-1" title="1"><span class="co"># mutate_if() 예시 </span></a>
<a class="sourceLine" id="cb1370-2" title="2"><span class="co">## 문자형 변수를 요인형으로 변환</span></a>
<a class="sourceLine" id="cb1370-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1370-4" title="4"><span class="st">  </span><span class="kw">mutate_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.character</span>(.), <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1370-5" title="5"><span class="st">  </span>summary</a></code></pre></div>
<pre><code>     manufacturer                 model         displ            year     
 dodge     :37    caravan 2wd        : 11   Min.   :1.600   Min.   :1999  
 toyota    :34    ram 1500 pickup 4wd: 10   1st Qu.:2.400   1st Qu.:1999  
 volkswagen:27    civic              :  9   Median :3.300   Median :2004  
 ford      :25    dakota pickup 4wd  :  9   Mean   :3.472   Mean   :2004  
 chevrolet :19    jetta              :  9   3rd Qu.:4.600   3rd Qu.:2008  
 audi      :18    mustang            :  9   Max.   :7.000   Max.   :2008  
 (Other)   :74    (Other)            :177                                 
      cyl               trans    drv          cty             hwy       
 Min.   :4.000   auto(l4)  :83   4:103   Min.   : 9.00   Min.   :12.00  
 1st Qu.:4.000   manual(m5):58   f:106   1st Qu.:14.00   1st Qu.:18.00  
 Median :6.000   auto(l5)  :39   r: 25   Median :17.00   Median :24.00  
 Mean   :5.889   manual(m6):19           Mean   :16.86   Mean   :23.44  
 3rd Qu.:8.000   auto(s6)  :16           3rd Qu.:19.00   3rd Qu.:27.00  
 Max.   :8.000   auto(l6)  : 6           Max.   :35.00   Max.   :44.00  
                 (Other)   :13                                          
 fl             class   
 c:  1   2seater   : 5  
 d:  5   compact   :47  
 e:  8   midsize   :41  
 p: 52   minivan   :11  
 r:168   pickup    :33  
         subcompact:35  
         suv       :62  </code></pre>

</div>
<div id="summarise-variant" class="section level4 unnumbered">
<h4><code>summarise_all()</code>, <code>summarise_at()</code>, <code>summarise_if()</code></h4>
<blockquote>
<ul>
<li>사용 방법은 <code>mutate_all</code>, <code>mutate_at</code>, <code>mutate_all</code> 과 동일</li>
<li>다중 변수 요약 시 코드를 효율적으로 작성할 수 있음.</li>
</ul>
</blockquote>

<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1372-1" title="1"><span class="co"># summary_all() 예시</span></a>
<a class="sourceLine" id="cb1372-2" title="2"><span class="co">## 모든 변수의 최솟값과 최댓값 요약</span></a>
<a class="sourceLine" id="cb1372-3" title="3"><span class="co">## 문자형 변수는 알파벳 순으로 최솟값과 최댓값 반환</span></a>
<a class="sourceLine" id="cb1372-4" title="4"><span class="co">## 복수의 함수를 적용 시 list()함수 사용</span></a>
<a class="sourceLine" id="cb1372-5" title="5">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1372-6" title="6"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">list</span>(<span class="dt">min =</span> <span class="op">~</span><span class="st"> </span><span class="kw">min</span>(.), </a>
<a class="sourceLine" id="cb1372-7" title="7">                     <span class="dt">max =</span> <span class="op">~</span><span class="st"> </span><span class="kw">max</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1372-8" title="8"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 1
Columns: 22
$ manufacturer_min &lt;chr&gt; &quot;audi&quot;
$ model_min        &lt;chr&gt; &quot;4runner 4wd&quot;
$ displ_min        &lt;dbl&gt; 1.6
$ year_min         &lt;int&gt; 1999
$ cyl_min          &lt;int&gt; 4
$ trans_min        &lt;chr&gt; &quot;auto(av)&quot;
$ drv_min          &lt;chr&gt; &quot;4&quot;
$ cty_min          &lt;int&gt; 9
$ hwy_min          &lt;int&gt; 12
$ fl_min           &lt;chr&gt; &quot;c&quot;
$ class_min        &lt;chr&gt; &quot;2seater&quot;
$ manufacturer_max &lt;chr&gt; &quot;volkswagen&quot;
$ model_max        &lt;chr&gt; &quot;toyota tacoma 4wd&quot;
$ displ_max        &lt;dbl&gt; 7
$ year_max         &lt;int&gt; 2008
$ cyl_max          &lt;int&gt; 8
$ trans_max        &lt;chr&gt; &quot;manual(m6)&quot;
$ drv_max          &lt;chr&gt; &quot;r&quot;
$ cty_max          &lt;int&gt; 35
$ hwy_max          &lt;int&gt; 44
$ fl_max           &lt;chr&gt; &quot;r&quot;
$ class_max        &lt;chr&gt; &quot;suv&quot;</code></pre>
<div class="sourceCode" id="cb1374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1374-1" title="1"><span class="co"># summary_at() 예시</span></a>
<a class="sourceLine" id="cb1374-2" title="2"><span class="co">## dipl, cyl, cty, hwy에 대해 제조사 별 n수와 평균과 표준편차 계산</span></a>
<a class="sourceLine" id="cb1374-3" title="3">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1374-4" title="4"><span class="st">  </span><span class="kw">add_count</span>(manufacturer) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 행 집계 결과를 열 변수로 추가하는 함수</span></a>
<a class="sourceLine" id="cb1374-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(manufacturer, n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1374-6" title="6"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(displ, cyl, cty<span class="op">:</span>hwy), </a>
<a class="sourceLine" id="cb1374-7" title="7">               <span class="kw">list</span>(<span class="dt">mean =</span> <span class="op">~</span><span class="st"> </span><span class="kw">mean</span>(.), </a>
<a class="sourceLine" id="cb1374-8" title="8">                    <span class="dt">sd =</span> <span class="op">~</span><span class="st"> </span><span class="kw">sd</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1374-9" title="9"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 15 x 10
# Groups:   manufacturer [15]
   manufacturer     n displ_mean cyl_mean cty_mean hwy_mean displ_sd cyl_sd
   &lt;chr&gt;        &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 audi            18       2.54     5.22     17.6     26.4    0.673  1.22 
 2 chevrolet       19       5.06     7.26     15       21.9    1.37   1.37 
 3 dodge           37       4.38     7.08     13.1     17.9    0.868  1.12 
 4 ford            25       4.54     7.2      14       19.4    0.541  1    
 5 honda            9       1.71     4        24.4     32.6    0.145  0    
 6 hyundai         14       2.43     4.86     18.6     26.9    0.365  1.03 
 7 jeep             8       4.58     7.25     13.5     17.6    1.02   1.04 
 8 land rover       4       4.3      8        11.5     16.5    0.258  0    
 9 lincoln          3       5.4      8        11.3     17      0      0    
10 mercury          4       4.4      7        13.2     18      0.490  1.15 
11 nissan          13       3.27     5.54     18.1     24.6    0.864  1.20 
12 pontiac          5       3.96     6.4      17       26.4    0.808  0.894
13 subaru          14       2.46     4        19.3     25.6    0.109  0    
14 toyota          34       2.95     5.12     18.5     24.9    0.931  1.32 
15 volkswagen      27       2.26     4.59     20.9     29.2    0.443  0.844
# ... with 2 more variables: cty_sd &lt;dbl&gt;, hwy_sd &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1376-1" title="1"><span class="co"># summary_if() 예시</span></a>
<a class="sourceLine" id="cb1376-2" title="2"><span class="co">## 1) 문자형 변수이거나 모든 값이 1999보다 크거나 같은 변수이거나 </span></a>
<a class="sourceLine" id="cb1376-3" title="3"><span class="co">##     8보다 작거나 같고 정수인 변수를 factor 변환</span></a>
<a class="sourceLine" id="cb1376-4" title="4"><span class="co">## 2) 수치형 변수에 대한 제조사 별 n, 평균, 표준편차를 구한 후</span></a>
<a class="sourceLine" id="cb1376-5" title="5"><span class="co">## 3) 평균 cty (cty_mean) 기준 내림차순으로 정렬</span></a>
<a class="sourceLine" id="cb1376-6" title="6">mpg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-7" title="7"><span class="st">  </span><span class="kw">mutate_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.character</span>(.) <span class="op">|</span><span class="st"> </span><span class="kw">all</span>(. <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1999</span>) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-8" title="8"><span class="st">              </span>(<span class="kw">all</span>(. <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.integer</span>(.)), </a>
<a class="sourceLine" id="cb1376-9" title="9">            <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-10" title="10"><span class="st">  </span><span class="kw">add_count</span>(manufacturer) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-11" title="11"><span class="st">  </span><span class="kw">group_by</span>(manufacturer, n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-12" title="12"><span class="st">  </span><span class="kw">summarise_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.numeric</span>(.), </a>
<a class="sourceLine" id="cb1376-13" title="13">               <span class="kw">list</span>(<span class="dt">mean =</span> <span class="op">~</span><span class="st"> </span><span class="kw">mean</span>(.), </a>
<a class="sourceLine" id="cb1376-14" title="14">                    <span class="dt">sd =</span> <span class="op">~</span><span class="st"> </span><span class="kw">sd</span>(.))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-15" title="15"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(cty_mean)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1376-16" title="16"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 15 x 8
# Groups:   manufacturer [15]
   manufacturer     n displ_mean cty_mean hwy_mean displ_sd cty_sd hwy_sd
   &lt;fct&gt;        &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 honda            9       1.71     24.4     32.6    0.145  1.94    2.55
 2 volkswagen      27       2.26     20.9     29.2    0.443  4.56    5.32
 3 subaru          14       2.46     19.3     25.6    0.109  0.914   1.16
 4 hyundai         14       2.43     18.6     26.9    0.365  1.50    2.18
 5 toyota          34       2.95     18.5     24.9    0.931  4.05    6.17
 6 nissan          13       3.27     18.1     24.6    0.864  3.43    5.09
 7 audi            18       2.54     17.6     26.4    0.673  1.97    2.18
 8 pontiac          5       3.96     17       26.4    0.808  1       1.14
 9 chevrolet       19       5.06     15       21.9    1.37   2.92    5.11
10 ford            25       4.54     14       19.4    0.541  1.91    3.33
11 jeep             8       4.58     13.5     17.6    1.02   2.51    3.25
12 mercury          4       4.4      13.2     18      0.490  0.5     1.15
13 dodge           37       4.38     13.1     17.9    0.868  2.49    3.57
14 land rover       4       4.3      11.5     16.5    0.258  0.577   1.73
15 lincoln          3       5.4      11.3     17      0      0.577   1   </code></pre>

</div>
</div>
<div id="dplyr-join" class="section level3">
<h3><span class="header-section-number">4.4.11</span> 데이터 연결</h3>
<ul>
<li><p>분석용 데이터를 만들기 위해 <strong>연관</strong>된 복수의 데이터 테이블을 결합하는 작업이 필수임</p></li>
<li><p>서로 연결 또는 연관된 데이터를 관계형 데이터(relational data)라고 칭함</p></li>
<li><p>관계는 항상 한 쌍의 데이터 테이블 간의 관계로 정의</p></li>
<li><p>관계형 데이터 작업을 위해 설계된 3 가지 “동사” 유형</p>
<ol style="list-style-type: lower-alpha">
<li><strong>Mutating join</strong>: 두 데이터 프레임 결합 시 두 테이블 간 행이 일치하는 경우 첫 번째 테이블에 새로운 변수 추가</li>
<li><strong>Filtering join</strong>: 다른 테이블의 관측치와 일치 여부에 따라 데이터 테이블의 행을 필터링</li>
<li><strong>Set operation</strong>: 데이터 셋의 관측치를 집합 연산으로 조합</li>
</ol></li>
</ul>


<div class="rmdnote">
본 강의에서는 <strong>mutating join</strong> 에 대해서만 다룸
</div>


<ul>
<li>R base 패키지에서 제공하는 <code>merge()</code> 함수로 <strong>mutating join</strong>에 해당하는 두 데이터 간 병합이 가능하지만 앞으로 배울 <code>*_join()</code>로도 동일한 기능을 수행할 수 있고, 다음과 같은 장점을 가짐</li>
</ul>
<blockquote>
<ul>
<li>행 순서를 보존</li>
<li><code>merge()</code>에 비해 코드가 직관적이고 빠름</li>
</ul>
</blockquote>
<p><strong>예제</strong></p>
<ul>
<li>데이터: <code>nycflights13</code> (2013년 미국 New York에서 출발하는 항공기 이착륙 기록 데이터)</li>
<li><code>flights</code>, <code>airlines</code>, <code>airports</code>, <code>planes</code>, <code>weather</code> 총 5 개의 데이터 프레임으로 구성되어 있으며, 데이터 구조와 코드북은 다음과 같음</li>
</ul>

<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1378-1" title="1"><span class="co"># install.packages(&quot;nycflights13&quot;)</span></a>
<a class="sourceLine" id="cb1378-2" title="2"><span class="kw">require</span>(nycflights13)</a></code></pre></div>
<pre><code>필요한 패키지를 로딩중입니다: nycflights13</code></pre>

<ul>
<li><code>flights</code>: 336,776 건의 비행에 대한 기록과 19개의 변수로 구성되어 있는 데이터셋</li>
</ul>

<pre><code># A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>


<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-46">Table 4.3: </span>flights 데이터셋 코드북
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수
</th>
<th style="text-align:left;">
설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
year, month, day
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
출발년도, 월, 일
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
dep_time, arr_time
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
실제 출발-도착 시간(현지시각)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
sched_dep_time, sched_arr_time
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
예정 출발-도착 시간(현지시각)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
dep_delay, arr_delay
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
출발 및 도착 지연 시간(분, min)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
carrier
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
항공코드 약어(두개 문자)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
tailnum
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
비행기 일련 번호
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
flight
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
항공편 번호
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
origin, dest
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
최초 출발지, 목적지
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
air_time
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
비행 시간(분, min)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
distance
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
비행 거리(마일, mile)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
hour, minutes
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
예정 출발 시각(시, 분)으로 분리
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
time_hour
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
POSIXct 포맷으로로 기록된 예정 항공편 날짜 및 시간
</td>
</tr>
</tbody>
</table>

<ul>
<li><code>airlines</code>: 항공사 이름 및 약어 정보로 구성</li>
</ul>

<pre><code># A tibble: 16 x 2
   carrier name                       
   &lt;chr&gt;   &lt;chr&gt;                      
 1 9E      Endeavor Air Inc.          
 2 AA      American Airlines Inc.     
 3 AS      Alaska Airlines Inc.       
 4 B6      JetBlue Airways            
 5 DL      Delta Air Lines Inc.       
 6 EV      ExpressJet Airlines Inc.   
 7 F9      Frontier Airlines Inc.     
 8 FL      AirTran Airways Corporation
 9 HA      Hawaiian Airlines Inc.     
10 MQ      Envoy Air                  
11 OO      SkyWest Airlines Inc.      
12 UA      United Air Lines Inc.      
13 US      US Airways Inc.            
14 VX      Virgin America             
15 WN      Southwest Airlines Co.     
16 YV      Mesa Airlines Inc.         </code></pre>

<ul>
<li><code>airports</code>: 각 공항에 대한 정보를 포함한 데이터셋이고 <code>faa</code>는 공항 코드</li>
</ul>

<pre><code># A tibble: 1,458 x 8
   faa   name                       lat    lon   alt    tz dst   tzone          
   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          
 1 04G   Lansdowne Airport         41.1  -80.6  1044    -5 A     America/New_Yo~
 2 06A   Moton Field Municipal A~  32.5  -85.7   264    -6 A     America/Chicago
 3 06C   Schaumburg Regional       42.0  -88.1   801    -6 A     America/Chicago
 4 06N   Randall Airport           41.4  -74.4   523    -5 A     America/New_Yo~
 5 09J   Jekyll Island Airport     31.1  -81.4    11    -5 A     America/New_Yo~
 6 0A9   Elizabethton Municipal ~  36.4  -82.2  1593    -5 A     America/New_Yo~
 7 0G6   Williams County Airport   41.5  -84.5   730    -5 A     America/New_Yo~
 8 0G7   Finger Lakes Regional A~  42.9  -76.8   492    -5 A     America/New_Yo~
 9 0P2   Shoestring Aviation Air~  39.8  -76.6  1000    -5 U     America/New_Yo~
10 0S9   Jefferson County Intl     48.1 -123.    108    -8 A     America/Los_An~
# ... with 1,448 more rows</code></pre>


<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-49">Table 4.4: </span>airports 데이터셋 코드북
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수
</th>
<th style="text-align:left;">
설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
faa
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
FAA 공항 코드
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
name
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
공항 명칭
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
lat
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
위도
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
lon
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
경도
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
alt
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
고도
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
tz
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
타임존 차이(GMT로부터)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
dst
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
일광 절약 시간제(섬머타임): A=미국 표준 DST, U=unknown, N=no DST
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
tzone
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
IANA 타임존
</td>
</tr>
</tbody>
</table>

<ul>
<li><code>planes</code>: 항공기 정보(제조사, 일련번호, 유형 등)에 대한 정보를 포함한 데이터셋</li>
</ul>

<pre><code># A tibble: 3,322 x 9
   tailnum  year type          manufacturer   model  engines seats speed engine 
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  
 1 N10156   2004 Fixed wing m~ EMBRAER        EMB-1~       2    55    NA Turbo-~
 2 N102UW   1998 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 3 N103US   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 4 N104UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 5 N10575   2002 Fixed wing m~ EMBRAER        EMB-1~       2    55    NA Turbo-~
 6 N105UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 7 N107US   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 8 N108UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
 9 N109UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
10 N110UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~
# ... with 3,312 more rows</code></pre>


<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-51">Table 4.5: </span>planes 데이터셋 코드북
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수
</th>
<th style="text-align:left;">
설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
tailnum
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
항공기 일련번호
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
year
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
제조년도
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
type
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
항공기 유형
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
manufacturer
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
제조사
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
model
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
모델명
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
engines
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
엔진 개수
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
seats
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
좌석 수
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
speed
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
속력
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
engine
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
엔진 유형
</td>
</tr>
</tbody>
</table>

<ul>
<li><code>weather</code>: 뉴욕시 각 공항 별 날씨 정보</li>
</ul>

<pre><code># A tibble: 26,115 x 15
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
# ... with 26,105 more rows, and 5 more variables: wind_gust &lt;dbl&gt;,
#   precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>


<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-53">Table 2.5: </span>weather 데이터셋 코드북
</caption>
<thead>
<tr>
<th style="text-align:left;">
변수
</th>
<th style="text-align:left;">
설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
origin
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
기상관측소
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
year, month, day, hour
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
년도, 월, 일, 시간
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
temp, dewp
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
기온, 이슬점 (F)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
humid
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
습도
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
wind_dir, wind_speed, wind_gust
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
바람방향(degree), 풍속 및 돌풍속도(mph)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
precip
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
강수량(inch)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
pressure
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
기압(mbar)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
visib
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
가시거리(mile)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
time_hour
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
POSIXct 포맷 일자 및 시간
</td>
</tr>
</tbody>
</table>

<blockquote>
<p>열거한 각 테이블은 한 개 또는 복수의 변수로 연결 가능</p>
<ul>
<li><code>flights</code> <span class="math inline">\(\longleftrightarrow\)</span> <code>planes</code> (by <code>tailnum</code>)</li>
<li><code>flights</code> <span class="math inline">\(\longleftrightarrow\)</span> <code>airlines</code> (by <code>carrier</code>)</li>
<li><code>flights</code> <span class="math inline">\(\longleftrightarrow\)</span> <code>airports</code> (by <code>origin</code>, <code>dest</code>)</li>
<li><code>flights</code> <span class="math inline">\(\longleftrightarrow\)</span> <code>weather</code> (by <code>origin</code>, <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>)</li>
</ul>
</blockquote>

<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-54"></span>
<img src="figures/dplyr-flights-db-scheme.png" alt="NYC flight 2013 데이터 관계도(https://r4ds.had.co.nz/ 에서 발췌)" width="80%" />
<p class="caption">
Figure 4.9: NYC flight 2013 데이터 관계도(<a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a> 에서 발췌)
</p>
</div>

<ul>
<li>각 쌍의 데이터를 연결하는데 사용한 변수를 키(key)라고 지칭
<ol style="list-style-type: lower-alpha">
<li>기준 테이블(여기서는 <code>flights</code> 데이터셋)의 키 <span class="math inline">\(\rightarrow\)</span> 기본키(primary key)</li>
<li>병합할 테이블의 키 <span class="math inline">\(\rightarrow\)</span> 외래키(foreign key)</li>
<li>다수의 변수를 이용한 기본키 및 외래키 생성 가능</li>
</ol></li>
</ul>
<div id="inner-join" class="section level4 unnumbered">
<h4><code>inner_join</code></h4>
<blockquote>
<p>두 데이터셋 모두에 존재하는 키 변수가 일치하는 행을 기준으로 병합</p>
</blockquote>

<div class="sourceCode" id="cb1385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1385-1" title="1">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb1385-2" title="2">  <span class="op">~</span>key, <span class="op">~</span>val_x,</a>
<a class="sourceLine" id="cb1385-3" title="3">     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</a>
<a class="sourceLine" id="cb1385-4" title="4">     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</a>
<a class="sourceLine" id="cb1385-5" title="5">     <span class="dv">3</span>, <span class="st">&quot;x3&quot;</span></a>
<a class="sourceLine" id="cb1385-6" title="6">)</a>
<a class="sourceLine" id="cb1385-7" title="7">y &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb1385-8" title="8">  <span class="op">~</span>key, <span class="op">~</span>val_y,</a>
<a class="sourceLine" id="cb1385-9" title="9">     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</a>
<a class="sourceLine" id="cb1385-10" title="10">     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span>,</a>
<a class="sourceLine" id="cb1385-11" title="11">     <span class="dv">4</span>, <span class="st">&quot;y3&quot;</span></a>
<a class="sourceLine" id="cb1385-12" title="12">)</a>
<a class="sourceLine" id="cb1385-13" title="13"></a>
<a class="sourceLine" id="cb1385-14" title="14"><span class="kw">inner_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 2 x 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   </code></pre>

<!-- ```{r fig.align='center', echo=FALSE, fig.show='hold', out.width='60%', fig.cap="inner join 개념(https://statkclee.github.io/data-science/ds-dplyr-join.html 에서 발췌)"}  -->
<!-- knitr::include_graphics('figures/dplyr-inner-join.gif', dpi = NA) -->
<!-- ``` -->
</div>
<div id="left-join" class="section level4 unnumbered">
<h4><code>left_join()</code></h4>
<blockquote>
<p>두 데이터셋 관계 중 왼쪽(<code>x</code>) 데이터셋의 행은 모두 보존</p>
</blockquote>

<div class="sourceCode" id="cb1387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1387-1" title="1"><span class="kw">left_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; </code></pre>

<!-- ```{r fig.align='center', echo=FALSE, fig.show='hold', out.width='60%', fig.cap="left join 개념(https://statkclee.github.io/data-science/ds-dplyr-join.html 에서 발췌)"}  -->
<!-- knitr::include_graphics('figures/dplyr-left-join.gif', dpi = NA) -->
<!-- ``` -->
</div>
<div id="right-join" class="section level4 unnumbered">
<h4><code>right_join()</code></h4>
<blockquote>
<p>두 데이터셋 관계 중 오른쪽(<code>y</code>) 데이터셋의 행은 모두 보존</p>
</blockquote>

<div class="sourceCode" id="cb1389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1389-1" title="1"><span class="kw">right_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 3 x 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     4 &lt;NA&gt;  y3   </code></pre>

<!-- ```{r fig.align='center', echo=FALSE, fig.show='hold', out.width='60%', fig.cap="right join 개념(https://statkclee.github.io/data-science/ds-dplyr-join.html 에서 발췌)"}  -->
<!-- knitr::include_graphics('figures/dplyr-right-join.gif', dpi = NA) -->
<!-- ``` -->
</div>
<div id="full-join" class="section level4 unnumbered">
<h4><code>full_join</code></h4>
<blockquote>
<p>두 데이터셋의 관측치 모두를 보존</p>
</blockquote>

<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1391-1" title="1"><span class="kw">full_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 4 x 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     3 x3    &lt;NA&gt; 
4     4 &lt;NA&gt;  y3   </code></pre>

<!-- ```{r fig.align='center', echo=FALSE, fig.show='hold', out.width='60%', fig.cap="full join 개념(https://statkclee.github.io/data-science/ds-dplyr-join.html 에서 발췌)"}  -->
<!-- knitr::include_graphics('figures/dplyr-full-join.gif', dpi = NA) -->
<!-- ``` -->
</div>
<div id="nyc-flights-2013-데이터-join-예시" class="section level4">
<h4><span class="header-section-number">4.4.11.1</span> NYC flights 2013 데이터 join 예시</h4>

<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1393-1" title="1"><span class="co"># flights 데이터 간소화(일부 열만 추출)</span></a>
<a class="sourceLine" id="cb1393-2" title="2">flights2 &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1393-3" title="3"><span class="st">  </span><span class="kw">select</span>(year<span class="op">:</span>day, hour, origin, dest, tailnum, carrier)</a>
<a class="sourceLine" id="cb1393-4" title="4"></a>
<a class="sourceLine" id="cb1393-5" title="5"><span class="co"># flights2 와 airlines 병합</span></a>
<a class="sourceLine" id="cb1393-6" title="6">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1393-7" title="7"><span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1393-8" title="8"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 336,776 x 9
    year month   day  hour origin dest  tailnum carrier name                    
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
 1  2013     1     1     5 EWR    IAH   N14228  UA      United Air Lines Inc.   
 2  2013     1     1     5 LGA    IAH   N24211  UA      United Air Lines Inc.   
 3  2013     1     1     5 JFK    MIA   N619AA  AA      American Airlines Inc.  
 4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue Airways         
 5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air Lines Inc.    
 6  2013     1     1     5 EWR    ORD   N39463  UA      United Air Lines Inc.   
 7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue Airways         
 8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJet Airlines Inc.
 9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue Airways         
10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American Airlines Inc.  
# ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1395-1" title="1"><span class="co"># flights2와 airline, airports 병합</span></a>
<a class="sourceLine" id="cb1395-2" title="2"><span class="co">## airports 데이터 간소화</span></a>
<a class="sourceLine" id="cb1395-3" title="3">airports2 &lt;-<span class="st"> </span>airports <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1395-4" title="4"><span class="st">  </span><span class="kw">select</span>(faa<span class="op">:</span>name, <span class="dt">airport_name =</span> name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1395-5" title="5"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 1,458 x 2
   faa   airport_name                  
   &lt;chr&gt; &lt;chr&gt;                         
 1 04G   Lansdowne Airport             
 2 06A   Moton Field Municipal Airport 
 3 06C   Schaumburg Regional           
 4 06N   Randall Airport               
 5 09J   Jekyll Island Airport         
 6 0A9   Elizabethton Municipal Airport
 7 0G6   Williams County Airport       
 8 0G7   Finger Lakes Regional Airport 
 9 0P2   Shoestring Aviation Airfield  
10 0S9   Jefferson County Intl         
# ... with 1,448 more rows</code></pre>
<div class="sourceCode" id="cb1397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1397-1" title="1">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1397-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1397-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(airports2, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1397-4" title="4"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 336,776 x 10
    year month   day  hour origin dest  tailnum carrier name       airport_name 
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        
 1  2013     1     1     5 EWR    IAH   N14228  UA      United Ai~ Newark Liber~
 2  2013     1     1     5 LGA    IAH   N24211  UA      United Ai~ La Guardia   
 3  2013     1     1     5 JFK    MIA   N619AA  AA      American ~ John F Kenne~
 4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue A~ John F Kenne~
 5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air~ La Guardia   
 6  2013     1     1     5 EWR    ORD   N39463  UA      United Ai~ Newark Liber~
 7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue A~ Newark Liber~
 8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJe~ La Guardia   
 9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue A~ John F Kenne~
10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American ~ La Guardia   
# ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb1399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1399-1" title="1"><span class="co"># flights2와 airline, airports, planes 병합</span></a>
<a class="sourceLine" id="cb1399-2" title="2">planes2 &lt;-<span class="st"> </span>planes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1399-3" title="3"><span class="st">  </span><span class="kw">select</span>(tailnum, model)</a>
<a class="sourceLine" id="cb1399-4" title="4"></a>
<a class="sourceLine" id="cb1399-5" title="5">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1399-6" title="6"><span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1399-7" title="7"><span class="st">  </span><span class="kw">left_join</span>(airports2, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1399-8" title="8"><span class="st">  </span><span class="kw">left_join</span>(planes2, <span class="dt">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1399-9" title="9"><span class="st">  </span>print</a></code></pre></div>
<pre><code># A tibble: 336,776 x 11
    year month   day  hour origin dest  tailnum carrier name  airport_name model
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;
 1  2013     1     1     5 EWR    IAH   N14228  UA      Unit~ Newark Libe~ 737-~
 2  2013     1     1     5 LGA    IAH   N24211  UA      Unit~ La Guardia   737-~
 3  2013     1     1     5 JFK    MIA   N619AA  AA      Amer~ John F Kenn~ 757-~
 4  2013     1     1     5 JFK    BQN   N804JB  B6      JetB~ John F Kenn~ A320~
 5  2013     1     1     6 LGA    ATL   N668DN  DL      Delt~ La Guardia   757-~
 6  2013     1     1     5 EWR    ORD   N39463  UA      Unit~ Newark Libe~ 737-~
 7  2013     1     1     6 EWR    FLL   N516JB  B6      JetB~ Newark Libe~ A320~
 8  2013     1     1     6 LGA    IAD   N829AS  EV      Expr~ La Guardia   CL-6~
 9  2013     1     1     6 JFK    MCO   N593JB  B6      JetB~ John F Kenn~ A320~
10  2013     1     1     6 LGA    ORD   N3ALAA  AA      Amer~ La Guardia   &lt;NA&gt; 
# ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb1401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1401-1" title="1"><span class="co"># flights2와 airline, airports2, planes2, weather2 병합</span></a>
<a class="sourceLine" id="cb1401-2" title="2"><span class="co">## weather 데이터 간소화</span></a>
<a class="sourceLine" id="cb1401-3" title="3">weather2 &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-4" title="4"><span class="st">  </span><span class="kw">select</span>(origin<span class="op">:</span>temp, wind_speed)</a>
<a class="sourceLine" id="cb1401-5" title="5"></a>
<a class="sourceLine" id="cb1401-6" title="6">flights2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-7" title="7"><span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-8" title="8"><span class="st">  </span><span class="kw">left_join</span>(airports2, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span> =<span class="st"> &quot;faa&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-9" title="9"><span class="st">  </span><span class="kw">left_join</span>(planes2, <span class="dt">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-10" title="10"><span class="st">  </span><span class="kw">left_join</span>(weather2, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origin&quot;</span>, <span class="st">&quot;year&quot;</span>, </a>
<a class="sourceLine" id="cb1401-11" title="11">                             <span class="st">&quot;month&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;hour&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1401-12" title="12"><span class="st">  </span>glimpse</a></code></pre></div>
<pre><code>Rows: 336,776
Columns: 13
$ year         &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, ...
$ month        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
$ day          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
$ hour         &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, ...
$ origin       &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;LGA&quot;...
$ dest         &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, &quot;IAD&quot;...
$ tailnum      &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;, &quot;N39...
$ carrier      &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;B6&quot;, ...
$ name         &lt;chr&gt; &quot;United Air Lines Inc.&quot;, &quot;United Air Lines Inc.&quot;, &quot;Ame...
$ airport_name &lt;chr&gt; &quot;Newark Liberty Intl&quot;, &quot;La Guardia&quot;, &quot;John F Kennedy I...
$ model        &lt;chr&gt; &quot;737-824&quot;, &quot;737-824&quot;, &quot;757-223&quot;, &quot;A320-232&quot;, &quot;757-232&quot;...
$ temp         &lt;dbl&gt; 39.02, 39.92, 39.02, 39.02, 39.92, 39.02, 37.94, 39.92...
$ wind_speed   &lt;dbl&gt; 12.65858, 14.96014, 14.96014, 14.96014, 16.11092, 12.6...</code></pre>

</div>
<div id="comp-dplyr-merge" class="section level4 unnumbered">
<h4>dplyr <code>*_join()</code> 과 base 패키지의 <code>merge()</code> 비교</h4>

<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-60">Table 4.6: </span>dplyr join 함수와 merge() 함수 비교
</caption>
<thead>
<tr>
<th style="text-align:left;">
dplyr::*_join()
</th>
<th style="text-align:left;">
base::merge()
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
inner_join(x, y)
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
merge(x, y)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
left_join(x, y)
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
merge(x, y, all.x = TRUE)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
right_join(x, y)
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
merge(x, y, all.y = TRUE)
</td>
</tr>
<tr>
<td style="text-align:left;width: 5cm; font-family: monospace;">
full_join(x, y)
</td>
<td style="text-align:left;width: 5cm; font-family: monospace;">
merge(x, y, all.x = TRUE, all.y = TRUE)
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div id="ex-gapminder" class="section level3">
<h3><span class="header-section-number">4.4.12</span> 확장 예제: Gapminder</h3>


<div class="rmdnote">
<strong>연습 데이터</strong>: Gapminder 데이터 활용. 각 대륙에 속한 국가의 인구, 경제, 보건, 교육, 환경, 노동에 대한 년도 별 국가 통계를 제공함. <a href="https://gapminder.org">Gapminder</a>는 스웨덴의 비영리 통계 분석 서비스를 제공하는 웹사이트로, UN이 제공하는 데이터를 기반으로 인구 예측, 부의 이동 등에 관한 연구 논문 및 통계정보, 데이터를 공유함 <span class="citation">(“Gapminder,” <a href="#ref-gapminder" role="doc-biblioref">n.d.</a>)</span>. R 패키지 중 <code>gapminder</code> <span class="citation">(Bryan <a href="#ref-gapminder-package" role="doc-biblioref">2017</a>)</span>는 1950 ~ 2007 년 까지 5년 단위의 국가별 인구(population), 기대수명(year), 일인당 국민 총소득(gross domestic product per captia, 달러)에 대한 데이터를 제공 하지만, 본 강의에서는 현재 Gapminder 사이트에서 직접 다운로드 받은 가장 최근 데이터를 가지고 dplyr 패키지의 기본 동사를 학습함과 동시에 최종적으로 gapminder 패키지에서 제공하는 데이터와 동일한 형태의 구조를 갖는 데이터를 생성하는 것이 목직임. 해당 데이터는 <a href="https://github.com/zorba78/cnu-r-programming-lecture-note/blob/master/dataset/gapminder/gapminder-exercise.xlsx">github 계정</a>에서 다운로드가 가능함.
<code>gapminder-exercise.xlsx</code>는 총 4개의 시트로 구성되어 있으며, 각 시트에 대한 설명은 아래와 같음.
</div>



<table class="table table-striped" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-62">Table 4.7: </span>gapminder-exercise.xlsx 설명
</caption>
<thead>
<tr>
<th style="text-align:left;">
시트 이름
</th>
<th style="text-align:left;">
설명
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
region
</td>
<td style="text-align:left;width: 7cm; font-family: monospace;">
국가별 지역 정보 포함
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
country_pop
</td>
<td style="text-align:left;width: 7cm; font-family: monospace;">
국가별 1800 ~ 2100년 까지 추계 인구수(명)
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
gdpcap
</td>
<td style="text-align:left;width: 7cm; font-family: monospace;">
국가별 1800 ~ 2100년 까지 국민 총소득(달러)
</td>
</tr>
<tr>
<td style="text-align:left;width: 3cm; font-family: monospace;">
lifeexp
</td>
<td style="text-align:left;width: 7cm; font-family: monospace;">
국가별 1800 ~ 2100년 까지 기대수명(세)
</td>
</tr>
</tbody>
</table>

<p><br/></p>
<div id="ex-pre" class="section level4 unnumbered">
<h4>Prerequisites</h4>
<blockquote>
<p><code>gapminder</code> 패키지 설치하기</p>
</blockquote>

<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1403-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;gapminder&quot;</span>)</a></code></pre></div>



<div class="rmdimportant">
<strong>Gapminder 데이터 핸들링 실습</strong>
</div>


<ol style="list-style-type: decimal">
<li><code>readxl</code> 패키지 + <code>%&gt;%</code>를 이용해 Gapminder 데이터(<code>gapminder-exercise.xlsx</code>) 불러오기</li>
</ol>

<div class="sourceCode" id="cb1404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1404-1" title="1"><span class="kw">require</span>(readxl)</a>
<a class="sourceLine" id="cb1404-2" title="2"><span class="kw">require</span>(gapminder)</a></code></pre></div>
<pre><code>필요한 패키지를 로딩중입니다: gapminder</code></pre>
<div class="sourceCode" id="cb1406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1406-1" title="1">path &lt;-<span class="st"> &quot;dataset/gapminder/gapminder-exercise.xlsx&quot;</span></a>
<a class="sourceLine" id="cb1406-2" title="2"><span class="co"># base R 문법 적용</span></a>
<a class="sourceLine" id="cb1406-3" title="3"><span class="co"># sheet_name &lt;- excel_sheets(path)</span></a>
<a class="sourceLine" id="cb1406-4" title="4"><span class="co"># gapmL &lt;- lapply(sheet_name, function(x) read_excel(path = path, sheet = x))</span></a>
<a class="sourceLine" id="cb1406-5" title="5"><span class="co"># names(gapmL) &lt;- sheet_name</span></a>
<a class="sourceLine" id="cb1406-6" title="6"></a>
<a class="sourceLine" id="cb1406-7" title="7"><span class="co"># pipe 연산자 이용</span></a>
<a class="sourceLine" id="cb1406-8" title="8">path <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1406-9" title="9"><span class="st">  </span>excel_sheets <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1406-10" title="10"><span class="st">  </span>set_names <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1406-11" title="11"><span class="st">  </span><span class="kw">map</span>(read_excel, <span class="dt">path =</span> path) -&gt;<span class="st"> </span>gapmL</a>
<a class="sourceLine" id="cb1406-12" title="12"></a>
<a class="sourceLine" id="cb1406-13" title="13"><span class="co"># 개별 객체에 데이터 저장</span></a>
<a class="sourceLine" id="cb1406-14" title="14">command &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">names</span>(gapmL), <span class="st">&quot;&lt;-&quot;</span>, </a>
<a class="sourceLine" id="cb1406-15" title="15">                 <span class="kw">paste0</span>(<span class="st">&quot;gapmL$&quot;</span>, <span class="kw">names</span>(gapmL)))</a>
<a class="sourceLine" id="cb1406-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(command)) <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> command[i]))</a>
<a class="sourceLine" id="cb1406-17" title="17"></a>
<a class="sourceLine" id="cb1406-18" title="18"><span class="co"># check</span></a>
<a class="sourceLine" id="cb1406-19" title="19"><span class="kw">ls</span>()</a></code></pre></div>
<pre><code> [1] &quot;airports2&quot;          &quot;audi&quot;               &quot;base::merge()&quot;     
 [4] &quot;by_mpg&quot;             &quot;codebook&quot;           &quot;command&quot;           
 [7] &quot;country_pop&quot;        &quot;covid19&quot;            &quot;dbp&quot;               
[10] &quot;dbp2&quot;               &quot;dd&quot;                 &quot;def.chunk.hook&quot;    
[13] &quot;diab&quot;               &quot;dL&quot;                 &quot;dL2&quot;               
[16] &quot;dplyr::*_join()&quot;    &quot;flights2&quot;           &quot;gallon&quot;            
[19] &quot;gapmL&quot;              &quot;gdpcap&quot;             &quot;herb&quot;              
[22] &quot;hook_output&quot;        &quot;i&quot;                  &quot;input1&quot;            
[25] &quot;input2&quot;             &quot;kpl&quot;                &quot;lifeexp&quot;           
[28] &quot;mile&quot;               &quot;mpg&quot;                &quot;mpg_asc&quot;           
[31] &quot;mpg_sortb&quot;          &quot;mpg_sortt&quot;          &quot;mpg_uniq&quot;          
[34] &quot;mpg_uniq2&quot;          &quot;path&quot;               &quot;planes2&quot;           
[37] &quot;plasma&quot;             &quot;pulse&quot;              &quot;R base 패키지 함수&quot;
[40] &quot;region&quot;             &quot;sheet_name&quot;         &quot;slice_mpg&quot;         
[43] &quot;slice_mpg_grp&quot;      &quot;tab4_01&quot;            &quot;tab4_03&quot;           
[46] &quot;tab4_04&quot;            &quot;tab4_05&quot;            &quot;tab4_06&quot;           
[49] &quot;tab4_07&quot;            &quot;tab4_08&quot;            &quot;titanic&quot;           
[52] &quot;titanic2&quot;           &quot;titanic3&quot;           &quot;varn_mpg&quot;          
[55] &quot;varname&quot;            &quot;weather2&quot;           &quot;x&quot;                 
[58] &quot;y&quot;                  &quot;내용&quot;               &quot;동사(함수)&quot;        
[61] &quot;변수&quot;               &quot;변수명&quot;             &quot;변수설명(국문)&quot;    
[64] &quot;변수설명(영문)&quot;     &quot;설명&quot;               &quot;시트 이름&quot;         
[67] &quot;연비&quot;              </code></pre>
<div class="sourceCode" id="cb1408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1408-1" title="1">region <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 234 x 3
   iso   country             region           
   &lt;chr&gt; &lt;chr&gt;               &lt;chr&gt;            
 1 AFG   Afghanistan         Southern Asia    
 2 ALB   Albania             Southern Europe  
 3 DZA   Algeria             Northern Africa  
 4 ASM   American Samoa      Polynesia Oceania
 5 AND   Andorra             Southern Europe  
 6 AGO   Angola              Middle Africa    
 7 AIA   Anguilla            Caribbean America
 8 ATG   Antigua and Barbuda Caribbean America
 9 ARG   Argentina           South America    
10 ARM   Armenia             Western Asia     
# ... with 224 more rows</code></pre>
<div class="sourceCode" id="cb1410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1410-1" title="1">country_pop <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 59,297 x 4
   iso   country      year population
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 afg   Afghanistan  1800    3280000
 2 afg   Afghanistan  1801    3280000
 3 afg   Afghanistan  1802    3280000
 4 afg   Afghanistan  1803    3280000
 5 afg   Afghanistan  1804    3280000
 6 afg   Afghanistan  1805    3280000
 7 afg   Afghanistan  1806    3280000
 8 afg   Afghanistan  1807    3280000
 9 afg   Afghanistan  1808    3280000
10 afg   Afghanistan  1809    3280000
# ... with 59,287 more rows</code></pre>
<div class="sourceCode" id="cb1412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1412-1" title="1">gdpcap <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 46,995 x 4
   iso_code country      year  gdp_total
   &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1 afg      Afghanistan  1800 1977840000
 2 afg      Afghanistan  1801 1977840000
 3 afg      Afghanistan  1802 1977840000
 4 afg      Afghanistan  1803 1977840000
 5 afg      Afghanistan  1804 1977840000
 6 afg      Afghanistan  1805 1977840000
 7 afg      Afghanistan  1806 1977840000
 8 afg      Afghanistan  1807 1977840000
 9 afg      Afghanistan  1808 1977840000
10 afg      Afghanistan  1809 1977840000
# ... with 46,985 more rows</code></pre>
<div class="sourceCode" id="cb1414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1414-1" title="1">lifeexp <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 56,130 x 4
   country     iso_code  year life_expectancy
   &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt;           &lt;dbl&gt;
 1 Afghanistan afg       1800            28.2
 2 Afghanistan afg       1801            28.2
 3 Afghanistan afg       1802            28.2
 4 Afghanistan afg       1803            28.2
 5 Afghanistan afg       1804            28.2
 6 Afghanistan afg       1805            28.2
 7 Afghanistan afg       1806            28.2
 8 Afghanistan afg       1807            28.1
 9 Afghanistan afg       1808            28.1
10 Afghanistan afg       1809            28.1
# ... with 56,120 more rows</code></pre>

<ol start="2" style="list-style-type: decimal">
<li><code>country_pop</code>, <code>gdpcap</code>, <code>lifeexp</code> 데이터 셋 결합</li>
</ol>

<div class="sourceCode" id="cb1416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1416-1" title="1">gap_unfilter &lt;-<span class="st"> </span>country_pop <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1416-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(gdpcap, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span> =<span class="st"> &quot;iso_code&quot;</span>, </a>
<a class="sourceLine" id="cb1416-3" title="3">                           <span class="st">&quot;country&quot;</span>, </a>
<a class="sourceLine" id="cb1416-4" title="4">                           <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1416-5" title="5"><span class="st">  </span><span class="kw">left_join</span>(lifeexp, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span> =<span class="st"> &quot;iso_code&quot;</span>, </a>
<a class="sourceLine" id="cb1416-6" title="6">                            <span class="st">&quot;country&quot;</span>, </a>
<a class="sourceLine" id="cb1416-7" title="7">                            <span class="st">&quot;year&quot;</span>))</a>
<a class="sourceLine" id="cb1416-8" title="8">gap_unfilter <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 59,297 x 6
   iso   country      year population  gdp_total life_expectancy
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;
 1 afg   Afghanistan  1800    3280000 1977840000            28.2
 2 afg   Afghanistan  1801    3280000 1977840000            28.2
 3 afg   Afghanistan  1802    3280000 1977840000            28.2
 4 afg   Afghanistan  1803    3280000 1977840000            28.2
 5 afg   Afghanistan  1804    3280000 1977840000            28.2
 6 afg   Afghanistan  1805    3280000 1977840000            28.2
 7 afg   Afghanistan  1806    3280000 1977840000            28.2
 8 afg   Afghanistan  1807    3280000 1977840000            28.1
 9 afg   Afghanistan  1808    3280000 1977840000            28.1
10 afg   Afghanistan  1809    3280000 1977840000            28.1
# ... with 59,287 more rows</code></pre>

<ol start="3" style="list-style-type: decimal">
<li>인구 수 6만 이상, 1950 ~ 2020년 년도 추출</li>
</ol>

<div class="sourceCode" id="cb1418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1418-1" title="1">gap_filter &lt;-<span class="st"> </span>gap_unfilter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1418-2" title="2"><span class="st">  </span><span class="kw">filter</span>(population <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60000</span>, </a>
<a class="sourceLine" id="cb1418-3" title="3">         <span class="kw">between</span>(year, <span class="dv">1950</span>, <span class="dv">2020</span>))</a>
<a class="sourceLine" id="cb1418-4" title="4">gap_filter <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 13,159 x 6
   iso   country      year population   gdp_total life_expectancy
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
 1 afg   Afghanistan  1950    7752117 18543063864            32.5
 2 afg   Afghanistan  1951    7840151 18988845722            32.9
 3 afg   Afghanistan  1952    7935996 19538422152            33.6
 4 afg   Afghanistan  1953    8039684 20645908512            34.3
 5 afg   Afghanistan  1954    8151316 20997790016            35.0
 6 afg   Afghanistan  1955    8270992 21330888368            35.7
 7 afg   Afghanistan  1956    8398873 22206620212            36.4
 8 afg   Afghanistan  1957    8535157 22131662101            37.1
 9 afg   Afghanistan  1958    8680097 23297380348            37.9
10 afg   Afghanistan  1959    8833947 23895826635            38.6
# ... with 13,149 more rows</code></pre>

<ol start="4" style="list-style-type: decimal">
<li><code>iso</code> 변수 값을 대문자로 변환하고, 1인당 국민소득(<code>gdp_total/population</code>) 변수 <code>gdp_cap</code> 생성 후 <code>gdp_total</code> 제거</li>
</ol>

<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1420-1" title="1">gap_filter &lt;-<span class="st"> </span>gap_filter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1420-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iso =</span> <span class="kw">toupper</span>(iso), </a>
<a class="sourceLine" id="cb1420-3" title="3">         <span class="dt">gdp_cap =</span> gdp_total<span class="op">/</span>population) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1420-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>gdp_total) </a>
<a class="sourceLine" id="cb1420-5" title="5">gap_filter <span class="op">%&gt;%</span><span class="st"> </span>print  </a></code></pre></div>
<pre><code># A tibble: 13,159 x 6
   iso   country      year population life_expectancy gdp_cap
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;
 1 AFG   Afghanistan  1950    7752117            32.5    2392
 2 AFG   Afghanistan  1951    7840151            32.9    2422
 3 AFG   Afghanistan  1952    7935996            33.6    2462
 4 AFG   Afghanistan  1953    8039684            34.3    2568
 5 AFG   Afghanistan  1954    8151316            35.0    2576
 6 AFG   Afghanistan  1955    8270992            35.7    2579
 7 AFG   Afghanistan  1956    8398873            36.4    2644
 8 AFG   Afghanistan  1957    8535157            37.1    2593
 9 AFG   Afghanistan  1958    8680097            37.9    2684
10 AFG   Afghanistan  1959    8833947            38.6    2705
# ... with 13,149 more rows</code></pre>

<ol start="5" style="list-style-type: decimal">
<li><code>region</code> 데이터셋에서 대륙(<code>region</code>) 변수 결합</li>
</ol>

<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1422-1" title="1">gap_filter &lt;-<span class="st"> </span>gap_filter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1422-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(region <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>country), </a>
<a class="sourceLine" id="cb1422-3" title="3">            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span>))</a>
<a class="sourceLine" id="cb1422-4" title="4">gap_filter <span class="op">%&gt;%</span><span class="st"> </span>print</a></code></pre></div>
<pre><code># A tibble: 13,159 x 7
   iso   country      year population life_expectancy gdp_cap region       
   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;        
 1 AFG   Afghanistan  1950    7752117            32.5    2392 Southern Asia
 2 AFG   Afghanistan  1951    7840151            32.9    2422 Southern Asia
 3 AFG   Afghanistan  1952    7935996            33.6    2462 Southern Asia
 4 AFG   Afghanistan  1953    8039684            34.3    2568 Southern Asia
 5 AFG   Afghanistan  1954    8151316            35.0    2576 Southern Asia
 6 AFG   Afghanistan  1955    8270992            35.7    2579 Southern Asia
 7 AFG   Afghanistan  1956    8398873            36.4    2644 Southern Asia
 8 AFG   Afghanistan  1957    8535157            37.1    2593 Southern Asia
 9 AFG   Afghanistan  1958    8680097            37.9    2684 Southern Asia
10 AFG   Afghanistan  1959    8833947            38.6    2705 Southern Asia
# ... with 13,149 more rows</code></pre>

<ol start="6" style="list-style-type: decimal">
<li>변수 정렬 (<code>iso</code>, <code>country</code>, <code>region</code>, <code>year:gdp_cap</code> 순서로)</li>
</ol>

<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1424-1" title="1">gap_filter &lt;-<span class="st"> </span>gap_filter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1424-2" title="2"><span class="st">  </span><span class="kw">select</span>(iso<span class="op">:</span>country, region, <span class="kw">everything</span>())</a></code></pre></div>

<ol start="7" style="list-style-type: decimal">
<li>문자형 변수를 요인형으로 변환하고, <code>population</code>을 정수형으로 변환</li>
</ol>

<div class="sourceCode" id="cb1425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1425-1" title="1">gap_filter &lt;-<span class="st"> </span>gap_filter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1425-2" title="2"><span class="st">  </span><span class="kw">mutate_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.character</span>(.), <span class="op">~</span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1425-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">population =</span> <span class="kw">as.integer</span>(population))</a></code></pre></div>

<ol start="8" style="list-style-type: decimal">
<li>2-7 절차를 pipe로 묶으면</li>
</ol>

<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1426-1" title="1">gap_filter &lt;-<span class="st"> </span>country_pop <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(gdpcap, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span> =<span class="st"> &quot;iso_code&quot;</span>, </a>
<a class="sourceLine" id="cb1426-3" title="3">                           <span class="st">&quot;country&quot;</span>, </a>
<a class="sourceLine" id="cb1426-4" title="4">                           <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-5" title="5"><span class="st">  </span><span class="kw">left_join</span>(lifeexp, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span> =<span class="st"> &quot;iso_code&quot;</span>, </a>
<a class="sourceLine" id="cb1426-6" title="6">                            <span class="st">&quot;country&quot;</span>, </a>
<a class="sourceLine" id="cb1426-7" title="7">                            <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-8" title="8"><span class="st">  </span><span class="kw">filter</span>(population <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60000</span>, </a>
<a class="sourceLine" id="cb1426-9" title="9">         <span class="kw">between</span>(year, <span class="dv">1950</span>, <span class="dv">2020</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iso =</span> <span class="kw">toupper</span>(iso), </a>
<a class="sourceLine" id="cb1426-11" title="11">         <span class="dt">gdp_cap =</span> gdp_total<span class="op">/</span>population) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-12" title="12"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>gdp_total) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-13" title="13"><span class="st">  </span><span class="kw">left_join</span>(region <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>country), </a>
<a class="sourceLine" id="cb1426-14" title="14">            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;iso&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-15" title="15"><span class="st">  </span><span class="kw">select</span>(iso<span class="op">:</span>country, region, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-16" title="16"><span class="st">  </span><span class="kw">mutate_if</span>(<span class="op">~</span><span class="st"> </span><span class="kw">is.character</span>(.), <span class="op">~</span><span class="kw">factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">population =</span> <span class="kw">as.integer</span>(population)) </a>
<a class="sourceLine" id="cb1426-18" title="18"></a>
<a class="sourceLine" id="cb1426-19" title="19"><span class="co"># write_csv(gap_filter, &quot;dataset/gapminder/gapminder_filter.csv&quot;)</span></a></code></pre></div>

<ol start="9" style="list-style-type: decimal">
<li>2020년 현재 지역별 인구수, 평균 일인당 국민소득, 평균 기대수명 계산 후 인구 수로 내림차순 정렬</li>
</ol>

<div class="sourceCode" id="cb1427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1427-1" title="1">gap_filter <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1427-2" title="2"><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2020</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1427-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1427-4" title="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Population =</span> <span class="kw">sum</span>(population), </a>
<a class="sourceLine" id="cb1427-5" title="5">            <span class="st">`</span><span class="dt">GDP/Captia</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(gdp_cap), </a>
<a class="sourceLine" id="cb1427-6" title="6">            <span class="st">`</span><span class="dt">Life expect</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(life_expectancy, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1427-7" title="7"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(Population))</a></code></pre></div>
<pre><code>`summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["region"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Population"],"name":[2],"type":["int"],"align":["right"]},{"label":["GDP/Captia"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Life expect"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Southern Asia","2":"1940369605","3":"8370.998","4":"73.39333"},{"1":"Eastern Asia","2":"1677440285","3":"30459.234","4":"78.94429"},{"1":"South-Eastern Asia","2":"668619854","3":"24279.406","4":"73.82545"},{"1":"Eastern Africa","2":"444237457","3":"4691.993","4":"66.12889"},{"1":"South America","2":"430457607","3":"13720.588","4":"76.42250"},{"1":"Western Africa","2":"401855184","3":"2882.280","4":"65.61812"},{"1":"Northen America","2":"368744804","3":"51031.640","4":"80.47500"},{"1":"Eastern Europe","2":"293013210","3":"23683.221","4":"75.55800"},{"1":"Western Asia","2":"279636774","3":"30616.466","4":"77.31333"},{"1":"Northern Africa","2":"245635178","3":"10702.228","4":"74.59000"},{"1":"Western Europe","2":"196068940","3":"54821.198","4":"82.38429"},{"1":"Central America","2":"179670186","3":"11340.196","4":"76.51375"},{"1":"Middle Africa","2":"179595125","3":"6080.158","4":"63.77778"},{"1":"Southern Europe","2":"152146805","3":"27723.358","4":"79.85083"},{"1":"Northern Europe","2":"105953515","3":"46376.315","4":"80.53500"},{"1":"Central Asia","2":"74338926","3":"11609.011","4":"71.68800"},{"1":"Southern Africa","2":"67503647","3":"10249.226","4":"64.75600"},{"1":"Caribbean America","2":"39195338","3":"15337.443","4":"74.52364"},{"1":"Oceania","2":"30322114","3":"41260.997","4":"82.46000"},{"1":"Melanesia Oceania","2":"10837499","3":"4814.621","4":"65.41500"},{"1":"Polynesia Oceania","2":"304107","3":"6292.408","4":"72.68500"},{"1":"Micronesia Oceania","2":"234467","3":"2660.223","4":"65.35000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>



<div class="rmdtip">
지금까지 배운 dplyr 패키지와 관련 명령어를 포함한 주요 동사 및 함수에 대한 개괄적 사용 방법은 RStudio 에서 제공하는 <a href="https://rstudio.com/resources/cheatsheets/">cheat sheet</a>을 통해 개념을 다질 수 있음.
</div>


</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-gapminder-package">
<p>Bryan, Jennifer. 2017. <em>Gapminder: Data from Gapminder</em>. <a href="https://CRAN.R-project.org/package=gapminder">https://CRAN.R-project.org/package=gapminder</a>.</p>
</div>
<div id="ref-gapminder">
<p>“Gapminder.” n.d. <a href="https://ko.wikipedia.org/wiki/갭마인더">https://ko.wikipedia.org/wiki/갭마인더</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>tally의 사전적 의미: calculate the total number of<a href="dplyr.html#fnref10" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="readr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-transformation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zorba78/cnu-r-programming-lecture-note/04-data-manupulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cnu-r-programming.pdf", "cnu-r-programming.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
